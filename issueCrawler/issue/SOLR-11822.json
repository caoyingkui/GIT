{
    "id": "SOLR-11822",
    "title": "Unable to create core in 7.2",
    "details": {
        "labels": "",
        "priority": "Major",
        "components": [],
        "type": "Bug",
        "fix_versions": [],
        "affect_versions": "7.2",
        "resolution": "Invalid",
        "status": "Closed"
    },
    "description": "2018-01-05 08:34:37.496 INFO  (qtp2009221452-22) [   ] o.a.s.s.HttpSolrCall [admin] webapp=null path=/admin/cores params=\n{schema=schema.xml&dataDir=data&name=profidx&action=CREATE&config=solrconfig.xml&instanceDir=profidx&wt=json&_=1515141248780} status=400 QTime=68\n2018-01-05 08:44:30.323 INFO  (qtp2009221452-13) [c:profidx   x:profidx] o.a.s.c.ZkController The core 'profidx' had failed to initialize before.\n2018-01-05 08:44:30.359 ERROR (OverseerStateUpdate-99296267947671552-127.0.1.1:8983_solr-n_0000000000) [   ] o.a.s.c.Overseer Overseer could not process the current clusterstate state update message, skipping the message: {\n  \"core\":\"profidx\",\n  \"roles\":null,\n  \"base_url\":\"http://127.0.1.1:8983/solr\",\n  \"node_name\":\"127.0.1.1:8983_solr\",\n  \"state\":\"down\",\n  \"shard\":null,\n  \"collection\":\"profidx\",\n  \"type\":\"NRT\",\n  \"operation\":\"state\"}\njava.lang.NullPointerException\n\tat org.apache.solr.cloud.Assign.defaultCounterValue(Assign.java:180)\n\tat org.apache.solr.cloud.Assign.assignNode(Assign.java:119)\n\tat org.apache.solr.cloud.overseer.ReplicaMutator.updateState(ReplicaMutator.java:248)\n\tat org.apache.solr.cloud.overseer.ReplicaMutator.updateState(ReplicaMutator.java:232)\n\tat org.apache.solr.cloud.overseer.ReplicaMutator.setState(ReplicaMutator.java:205)\n\tat org.apache.solr.cloud.Overseer$ClusterStateUpdater.processMessage(Overseer.java:376)\n\tat org.apache.solr.cloud.Overseer$ClusterStateUpdater.processQueueItem(Overseer.java:273)\n\tat org.apache.solr.cloud.Overseer$ClusterStateUpdater.run(Overseer.java:224)\n\tat java.base/java.lang.Thread.run(Thread.java:844)\n2018-01-05 08:44:30.364 ERROR (qtp2009221452-21) [c:profidx   x:profidx] o.a.s.h.RequestHandlerBase org.apache.solr.common.SolrException: Error CREATEing SolrCore 'profidx': Unable to create core [profidx] Caused by: Could not get shard id for core: profidx\n\tat org.apache.solr.core.CoreContainer.create(CoreContainer.java:987)\n\tat org.apache.solr.handler.admin.CoreAdminOperation.lambda$static$0(CoreAdminOperation.java:91)\n\tat org.apache.solr.handler.admin.CoreAdminOperation.execute(CoreAdminOperation.java:384)\n\tat org.apache.solr.handler.admin.CoreAdminHandler$CallInfo.call(CoreAdminHandler.java:389)\n\tat org.apache.solr.handler.admin.CoreAdminHandler.handleRequestBody(CoreAdminHandler.java:174)\n\tat org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:177)\n\tat org.apache.solr.servlet.HttpSolrCall.handleAdmin(HttpSolrCall.java:735)\n\tat org.apache.solr.servlet.HttpSolrCall.handleAdminRequest(HttpSolrCall.java:716)\n\tat org.apache.solr.servlet.HttpSolrCall.call(HttpSolrCall.java:497)\n\tat org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:382)\n\tat org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:326)\n\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1751)\n\tat org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:582)\n\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)\n\tat org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:548)\n\tat org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:226)\n\tat org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1180)\n\tat org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:512)\n\tat org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)\n\tat org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1112)\n\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)\n\tat org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:213)\n\tat org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:119)\n\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:134)\n\tat org.eclipse.jetty.rewrite.handler.RewriteHandler.handle(RewriteHandler.java:335)\n\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:134)\n\tat org.eclipse.jetty.server.Server.handle(Server.java:534)\n\tat org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:320)\n\tat org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:251)\n\tat org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:283)\n\tat org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:108)\n\tat org.eclipse.jetty.io.SelectChannelEndPoint$2.run(SelectChannelEndPoint.java:93)\n\tat org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.executeProduceConsume(ExecuteProduceConsume.java:303)\n\tat org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.produceConsume(ExecuteProduceConsume.java:148)\n\tat org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.run(ExecuteProduceConsume.java:136)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:671)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool$2.run(QueuedThreadPool.java:589)\n\tat java.base/java.lang.Thread.run(Thread.java:844)\nCaused by: org.apache.solr.common.SolrException: Unable to create core [profidx]\n\tat org.apache.solr.core.CoreContainer.createFromDescriptor(CoreContainer.java:1053)\n\tat org.apache.solr.core.CoreContainer.create(CoreContainer.java:948)\n\t... 37 more\nCaused by: org.apache.solr.common.SolrException: Could not get shard id for core: profidx\n\tat org.apache.solr.cloud.ZkController.waitForShardId(ZkController.java:1569)\n\tat org.apache.solr.cloud.ZkController.doGetShardIdAndNodeNameProcess(ZkController.java:1513)\n\tat org.apache.solr.cloud.ZkController.preRegister(ZkController.java:1622)\n\tat org.apache.solr.core.CoreContainer.createFromDescriptor(CoreContainer.java:1030)\n\t... 38 more\n\n2018-01-05 08:44:30.364 INFO  (qtp2009221452-21) [c:profidx   x:profidx] o.a.s.s.HttpSolrCall [admin] webapp=null path=/admin/cores params={schema=schema.xml&dataDir=data&name=profidx&action=CREATE&config=solrconfig.xml&instanceDir=profidx&wt=json&_=1515140817912} status=400 QTime=640884\n2018-01-05 08:55:11.143 ERROR (qtp2009221452-13) [c:profidx   x:profidx] o.a.s.h.RequestHandlerBase org.apache.solr.common.SolrException: Error CREATEing SolrCore 'profidx': Unable to create core [profidx] Caused by: Could not get shard id for core: profidx\n\tat org.apache.solr.core.CoreContainer.create(CoreContainer.java:987)\n\tat org.apache.solr.handler.admin.CoreAdminOperation.lambda$static$0(CoreAdminOperation.java:91)\n\tat org.apache.solr.handler.admin.CoreAdminOperation.execute(CoreAdminOperation.java:384)\n\tat org.apache.solr.handler.admin.CoreAdminHandler$CallInfo.call(CoreAdminHandler.java:389)\n\tat org.apache.solr.handler.admin.CoreAdminHandler.handleRequestBody(CoreAdminHandler.java:174)\n\tat org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:177)\n\tat org.apache.solr.servlet.HttpSolrCall.handleAdmin(HttpSolrCall.java:735)\n\tat org.apache.solr.servlet.HttpSolrCall.handleAdminRequest(HttpSolrCall.java:716)\n\tat org.apache.solr.servlet.HttpSolrCall.call(HttpSolrCall.java:497)\n\tat org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:382)\n\tat org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:326)\n\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1751)\n\tat org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:582)\n\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)\n\tat org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:548)\n\tat org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:226)\n\tat org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1180)\n\tat org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:512)\n\tat org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)\n\tat org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1112)\n\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)\n\tat org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:213)\n\tat org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:119)\n\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:134)\n\tat org.eclipse.jetty.rewrite.handler.RewriteHandler.handle(RewriteHandler.java:335)\n\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:134)\n\tat org.eclipse.jetty.server.Server.handle(Server.java:534)\n\tat org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:320)\n\tat org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:251)\n\tat org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:283)\n\tat org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:108)\n\tat org.eclipse.jetty.io.SelectChannelEndPoint$2.run(SelectChannelEndPoint.java:93)\n\tat org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.executeProduceConsume(ExecuteProduceConsume.java:303)\n\tat org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.produceConsume(ExecuteProduceConsume.java:148)\n\tat org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.run(ExecuteProduceConsume.java:136)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:671)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool$2.run(QueuedThreadPool.java:589)\n\tat java.base/java.lang.Thread.run(Thread.java:844)\nCaused by: org.apache.solr.common.SolrException: Unable to create core [profidx]\n\tat org.apache.solr.core.CoreContainer.createFromDescriptor(CoreContainer.java:1053)\n\tat org.apache.solr.core.CoreContainer.create(CoreContainer.java:948)\n\t... 37 more\nCaused by: org.apache.solr.common.SolrException: Could not get shard id for core: profidx\n\tat org.apache.solr.cloud.ZkController.waitForShardId(ZkController.java:1569)\n\tat org.apache.solr.cloud.ZkController.doGetShardIdAndNodeNameProcess(ZkController.java:1513)\n\tat org.apache.solr.cloud.ZkController.preRegister(ZkController.java:1622)\n\tat org.apache.solr.core.CoreContainer.createFromDescriptor(CoreContainer.java:1030)\n\t... 38 more\n\n2018-01-05 08:55:11.144 INFO  (qtp2009221452-13) [c:profidx   x:profidx] o.a.s.s.HttpSolrCall [admin] webapp=null path=/admin/cores params={schema=schema.xml&dataDir=data&name=profidx&action=CREATE&config=solrconfig.xml&instanceDir=profidx&wt=json&_=1515141248780}\n status=400 QTime=1243723",
    "attachments": {},
    "issue_links": {},
    "comments": [
        {
            "date": "2018-01-05T18:09:39+0000",
            "content": "Please raise questions like this on the user's list first to be sure it's really a bug and not a user error. \n\nAnd when you post over there, give us the exact command you used. Are you trying to use the core admin API to create a core in a SolrCloud setup? Or did you try some collections API action that failed? If the former that's totally not recommended, use the Collections API ADDREPLICA command instead.\n\nIf you're really trying this with stand-alone, then you need to pre-populate the core's directory with the configuration or use a configset, but if the Overseer is involved, it must be SolrCloud. ",
            "author": "Erick Erickson",
            "id": "comment-16313583"
        },
        {
            "date": "2018-01-12T01:44:13+0000",
            "content": "Since there's been no response, and since it appears to be mixing stand-alone and SolrCloud concepts I'll close. We can re-open if necessary. ",
            "author": "Erick Erickson",
            "id": "comment-16323393"
        }
    ]
}