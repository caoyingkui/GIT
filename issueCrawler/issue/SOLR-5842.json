{
    "id": "SOLR-5842",
    "title": "facet.pivot need provide the more information and additional function",
    "details": {
        "affect_versions": "4.6",
        "status": "Open",
        "fix_versions": [],
        "components": [
            "SolrCloud"
        ],
        "type": "Improvement",
        "priority": "Major",
        "labels": "",
        "resolution": "Unresolved"
    },
    "description": "Because facet can set the facet.limit and facet.offset, we can't get the next array size for facet.pivot. If you want to get the next pivot size, you have to set  the facet.limit to max integer then to count the array size. In that way you will get a lot of terms for pivot field that's impact the network and Client. \nUpdate some functions in the API\nFor example:\nfacet=true&facet.pivot=test,testb,id&\nfacet.pivot.min.field=id& \u2013 Get the <id> min value\nfacet.pivot.max.field=id& \u2013 Get the <id> max value \nfacet.pivot.sum.field=id    \u2013 Sum the <id> value\nfacet.pivot.count=true     \u2014 Open the get array size function\nfacet.pivot.count.field=id  --Get the <id> array size\nfacet.pivot.count.next=true \u2013 Get the next pivot field array size\n\nResponse:\n<lst name=\"facet_pivot\">\n<long name=\"idSUM\">572</long>\n<long name=\"idMAX\">333</long>\n<long name=\"idMIN\">1</long>\n<long name=\"idArrCount\">12</long>\n<arr name=\"test,testb,id\">\n<lst>\n<str name=\"field\">test</str>\n<str name=\"value\">change.me</str>\n<int name=\"count\">5</int>\n<long name=\"idSUM\">91</long>\n<long name=\"idMAX\">33</long>\n<long name=\"idMIN\">1</long>\n<long name=\"idArrCount\">5</long>\n<long name=\"testbArrCount\">2</long>\n<arr name=\"pivot\">\n<lst>\n<str name=\"field\">testb</str>\n<str name=\"value\">test</str>\n<int name=\"count\">1</int>\n<long name=\"idSUM\">3</long>\n<long name=\"idMAX\">3</long>\n<long name=\"idMIN\">3</long>\n<long name=\"idArrCount\">1</long>\n<arr name=\"pivot\">\n<lst>\n<str name=\"field\">id</str>\n<int name=\"value\">3</int>\n<int name=\"count\">1</int>\n</lst>\n</arr>\n</lst>\n<lst>\n<str name=\"field\">testb</str>\n<null name=\"value\"/>\n<int name=\"count\">4</int>\n<long name=\"idSUM\">88</long>\n<long name=\"idMAX\">33</long>\n<long name=\"idMIN\">1</long>\n<long name=\"idArrCount\">4</long>\n<arr name=\"pivot\">\n<lst>\n<str name=\"field\">id</str>\n<int name=\"value\">1</int>\n<int name=\"count\">1</int>\n</lst>\n<lst>\n<str name=\"field\">id</str>\n<int name=\"value\">22</int>\n<int name=\"count\">1</int>\n</lst>\n<lst>\n<str name=\"field\">id</str>\n<int name=\"value\">32</int>\n<int name=\"count\">1</int>\n</lst>\n<lst>\n<str name=\"field\">id</str>\n<int name=\"value\">33</int>\n<int name=\"count\">1</int>\n</lst>\n</arr>\n</lst>\n</arr>\n</lst>\n<lst>\n<str name=\"field\">test</str>\n<str name=\"value\">100</str>\n<int name=\"count\">1</int>\n<long name=\"idSUM\">66</long>\n<long name=\"idMAX\">66</long>\n<long name=\"idMIN\">66</long>\n<long name=\"idArrCount\">1</long>\n<long name=\"testbArrCount\">1</long>\n<arr name=\"pivot\">\n<lst>\n<str name=\"field\">testb</str>\n<null name=\"value\"/>\n<int name=\"count\">1</int>\n<long name=\"idSUM\">66</long>\n<long name=\"idMAX\">66</long>\n<long name=\"idMIN\">66</long>\n<long name=\"idArrCount\">1</long>\n<arr name=\"pivot\">\n<lst>\n<str name=\"field\">id</str>\n<int name=\"value\">66</int>\n<int name=\"count\">1</int>\n</lst>\n</arr>\n</lst>\n</arr>\n</lst>\n<lst>\n<str name=\"field\">test</str>\n<str name=\"value\">200</str>\n<int name=\"count\">1</int>\n<long name=\"idSUM\">34</long>\n<long name=\"idMAX\">34</long>\n<long name=\"idMIN\">34</long>\n<long name=\"idArrCount\">1</long>\n<long name=\"testbArrCount\">1</long>\n<arr name=\"pivot\">\n<lst>\n<str name=\"field\">testb</str>\n<null name=\"value\"/>\n<int name=\"count\">1</int>\n<long name=\"idSUM\">34</long>\n<long name=\"idMAX\">34</long>\n<long name=\"idMIN\">34</long>\n<long name=\"idArrCount\">1</long>\n<arr name=\"pivot\">\n<lst>\n<str name=\"field\">id</str>\n<int name=\"value\">34</int>\n<int name=\"count\">1</int>\n</lst>\n</arr>\n</lst>\n</arr>\n</lst>\n<lst>\n<str name=\"field\">test</str>\n<str name=\"value\">500</str>\n<int name=\"count\">1</int>\n<long name=\"idSUM\">23</long>\n<long name=\"idMAX\">23</long>\n<long name=\"idMIN\">23</long>\n<long name=\"idArrCount\">1</long>\n<long name=\"testbArrCount\">1</long>\n<arr name=\"pivot\">\n<lst>\n<str name=\"field\">testb</str>\n<null name=\"value\"/>\n<int name=\"count\">1</int>\n<long name=\"idSUM\">23</long>\n<long name=\"idMAX\">23</long>\n<long name=\"idMIN\">23</long>\n<long name=\"idArrCount\">1</long>\n<arr name=\"pivot\">\n<lst>\n<str name=\"field\">id</str>\n<int name=\"value\">23</int>\n<int name=\"count\">1</int>\n</lst>\n</arr>\n</lst>\n</arr>\n</lst>\n<lst>\n<str name=\"field\">test</str>\n<str name=\"value\">change.me1</str>\n<int name=\"count\">1</int>\n<long name=\"idSUM\">4</long>\n<long name=\"idMAX\">4</long>\n<long name=\"idMIN\">4</long>\n<long name=\"idArrCount\">1</long>\n<long name=\"testbArrCount\">1</long>\n<arr name=\"pivot\">\n<lst>\n<str name=\"field\">testb</str>\n<str name=\"value\">test1</str>\n<int name=\"count\">1</int>\n<long name=\"idSUM\">4</long>\n<long name=\"idMAX\">4</long>\n<long name=\"idMIN\">4</long>\n<long name=\"idArrCount\">1</long>\n<arr name=\"pivot\">\n<lst>\n<str name=\"field\">id</str>\n<int name=\"value\">4</int>\n<int name=\"count\">1</int>\n</lst>\n</arr>\n</lst>\n</arr>\n</lst>\n<lst>\n<str name=\"field\">test</str>\n<str name=\"value\">me</str>\n<int name=\"count\">1</int>\n<long name=\"idSUM\">11</long>\n<long name=\"idMAX\">11</long>\n<long name=\"idMIN\">11</long>\n<long name=\"idArrCount\">1</long>\n<long name=\"testbArrCount\">1</long>\n<arr name=\"pivot\">\n<lst>\n<str name=\"field\">testb</str>\n<str name=\"value\">change.me</str>\n<int name=\"count\">1</int>\n<long name=\"idSUM\">11</long>\n<long name=\"idMAX\">11</long>\n<long name=\"idMIN\">11</long>\n<long name=\"idArrCount\">1</long>\n<arr name=\"pivot\">\n<lst>\n<str name=\"field\">id</str>\n<int name=\"value\">11</int>\n<int name=\"count\">1</int>\n</lst>\n</arr>\n</lst>\n</arr>\n</lst>\n<lst>\n<str name=\"field\">test</str>\n<str name=\"value\">ok</str>\n<int name=\"count\">1</int>\n<long name=\"idSUM\">333</long>\n<long name=\"idMAX\">333</long>\n<long name=\"idMIN\">333</long>\n<long name=\"idArrCount\">1</long>\n<long name=\"testbArrCount\">1</long>\n<arr name=\"pivot\">\n<lst>\n<str name=\"field\">testb</str>\n<str name=\"value\">ok</str>\n<int name=\"count\">1</int>\n<long name=\"idSUM\">333</long>\n<long name=\"idMAX\">333</long>\n<long name=\"idMIN\">333</long>\n<long name=\"idArrCount\">1</long>\n<arr name=\"pivot\">\n<lst>\n<str name=\"field\">id</str>\n<int name=\"value\">333</int>\n<int name=\"count\">1</int>\n</lst>\n</arr>\n</lst>\n</arr>\n</lst>\n<lst>\n<str name=\"field\">test</str>\n<null name=\"value\"/>\n<int name=\"count\">1</int>\n<long name=\"idSUM\">10</long>\n<long name=\"idMAX\">10</long>\n<long name=\"idMIN\">10</long>\n<long name=\"idArrCount\">1</long>\n<long name=\"testbArrCount\">1</long>\n<arr name=\"pivot\">\n<lst>\n<str name=\"field\">testb</str>\n<str name=\"value\">testb</str>\n<int name=\"count\">1</int>\n<long name=\"idSUM\">10</long>\n<long name=\"idMAX\">10</long>\n<long name=\"idMIN\">10</long>\n<long name=\"idArrCount\">1</long>\n<arr name=\"pivot\">\n<lst>\n<str name=\"field\">id</str>\n<int name=\"value\">10</int>\n<int name=\"count\">1</int>\n</lst>\n</arr>\n</lst>\n</arr>\n</lst>\n</arr>\n</lst>",
    "attachments": {
        "patch-5842-2.txt": "https://issues.apache.org/jira/secure/attachment/12636886/patch-5842-2.txt",
        "patch-5842.txt": "https://issues.apache.org/jira/secure/attachment/12633622/patch-5842.txt"
    },
    "issue_links": {},
    "comments": [
        {
            "author": "Raintung Li",
            "id": "comment-13925422",
            "date": "2014-03-10T03:37:48+0000",
            "content": "update code for functions "
        },
        {
            "author": "Raintung Li",
            "id": "comment-13947691",
            "date": "2014-03-26T09:03:23+0000",
            "content": "Fix the bug "
        }
    ]
}