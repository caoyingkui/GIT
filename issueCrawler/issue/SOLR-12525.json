{
    "id": "SOLR-12525",
    "title": "UnsupportedOperationException when running Solr 5.3 with JDK10",
    "details": {
        "labels": "",
        "priority": "Major",
        "components": [
            "SolrJ"
        ],
        "type": "Improvement",
        "fix_versions": [],
        "affect_versions": "5.3.1",
        "resolution": "Not A Bug",
        "status": "Closed"
    },
    "description": "Although Solr 5.3.1 document says that it runs with JDK7 or above, but when we are trying to use JDK10 to run Solr 5.3.1 and we are facing some problems:\n\nWe removed the following JAVA options in solr.in.sh as what SOLR suggest because it wont start:\n\nUseConcMarkSweepGC\n UseParNewGC\n PrintHeapAtGC\n PrintGCDateStamps\n PrintGCTimeStamps\n PrintTenuringDistribution\n PrintGCApplicationStoppedTime\n\nAnd the options left in solr.in.sh:\n\n\tEnable verbose GC logging\n GC_LOG_OPTS=\"-verbose:gc -XX:+PrintGCDetails\"\n\n\n\n\n\tThese GC settings have shown to work well for a number of common Solr workloads\n GC_TUNE=\"-XX:NewRatio=3 \\\n -XX:SurvivorRatio=4 \\\n -XX:TargetSurvivorRatio=90 \\\n -XX:MaxTenuringThreshold=8 \\\n -XX:ConcGCThreads=4 -XX:ParallelGCThreads=4 \\\n -XX:+CMSScavengeBeforeRemark \\\n -XX:PretenureSizeThreshold=64m \\\n -XX:+UseCMSInitiatingOccupancyOnly \\\n -XX:CMSInitiatingOccupancyFraction=50 \\\n -XX:CMSMaxAbortablePrecleanTime=6000 \\\n -XX:+CMSParallelRemarkEnabled \\\n -XX:+ParallelRefProcEnabled\"\n\n\n\nAfter that SOLR runs but it got an error:\n\n[0.001s][warning][gc] -Xloggc is deprecated. Will use -Xlog:gc:/solr/logs/solr_gc.log instead.\n [0.001s][warning][gc] -XX:+PrintGCDetails is deprecated. Will use -Xlog:gc* instead.\n [0.003s][info ][gc] Using Serial\n WARNING: System properties and/or JVM args set. Consider using --dry-run or --exec\n 0 INFO (main) [ ] o.e.j.u.log Logging initialized @532ms\n 205 INFO (main) [ ] o.e.j.s.Server jetty-9.2.11.v20150529\n 218 WARN (main) [ ] o.e.j.s.h.RequestLogHandler !RequestLog\n 220 INFO (main) [ ] o.e.j.d.p.ScanningAppProvider Deployment monitor file:/home/solr/solr-5.3.1/server/contexts/ at interval 0\n 559 INFO (main) [ ] o.e.j.w.StandardDescriptorProcessor NO JSP Support for /solr, did not find org.apache.jasper.servlet.JspServlet\n 569 WARN (main) [ ] o.e.j.s.SecurityHandler ServletContext@o.e.j.w.WebAppContext@1a75e76a\n\n{/solr,file:/home/solr/solr-5.3.1/server/solr-webapp/webapp/,STARTING}\n\n{/home/solr/solr-5.3.1/server/solr-webapp/webapp} has uncovered http methods for path: /\n 577 INFO (main) [ ] o.a.s.s.SolrDispatchFilter SolrDispatchFilter.init(): WebAppClassLoader=1904783235@7188af83\n 625 INFO (main) [ ] o.a.s.c.SolrResourceLoader JNDI not configured for solr (NoInitialContextEx)\n 626 INFO (main) [ ] o.a.s.c.SolrResourceLoader using system property solr.solr.home: /solr/data\n 627 INFO (main) [ ] o.a.s.c.SolrResourceLoader new SolrResourceLoader for directory: '/solr/data/'\n 750 INFO (main) [ ] o.a.s.c.SolrXmlConfig Loading container configuration from /solr/data/solr.xml\n 817 INFO (main) [ ] o.a.s.c.CoresLocator Config-defined core root directory: /solr/data\n [1.402s][info ][gc] GC(0) Pause Full (Metadata GC Threshold) 85M->7M(490M) 37.281ms\n 875 INFO (main) [ ] o.a.s.c.CoreContainer New CoreContainer 1193398802\n 875 INFO (main) [ ] o.a.s.c.CoreContainer Loading cores into CoreContainer [instanceDir=/solr/data/]\n 875 INFO (main) [ ] o.a.s.c.CoreContainer loading shared library: /solr/data/lib\n 875 WARN (main) [ ] o.a.s.c.SolrResourceLoader Can't find (or read) directory to add to classloader: lib (resolved as: /solr/data/lib).\n 889 INFO (main) [ ] o.a.s.h.c.HttpShardHandlerFactory created with socketTimeout : 600000,connTimeout : 60000,maxConnectionsPerHost : 20,maxConnections : 10000,corePoolSize : 0,maximumPoolSize : 2147483647,maxThreadIdleTime : 5,sizeOfQueue : -1,fairnessPolicy : false,useRetries : false,\n 1036 INFO (main) [ ] o.a.s.u.UpdateShardHandler Creating UpdateShardHandler HTTP client with params: socketTimeout=600000&connTimeout=60000&retry=true\n 1038 INFO (main) [ ] o.a.s.l.LogWatcher SLF4J impl is org.slf4j.impl.Log4jLoggerFactory\n 1039 INFO (main) [ ] o.a.s.l.LogWatcher Registering Log Listener [Log4j (org.slf4j.impl.Log4jLoggerFactory)]\n 1040 INFO (main) [ ] o.a.s.c.CoreContainer Security conf doesn't exist. Skipping setup for authorization module.\n 1041 INFO (main) [ ] o.a.s.c.CoreContainer No authentication plugin used.\n 1179 INFO (main) [ ] o.a.s.c.CoresLocator Looking for core definitions underneath /solr/data\n 1180 INFO (main) [ ] o.a.s.c.CoresLocator Found 0 core definitions\n 1185 INFO (main) [ ] o.a.s.s.SolrDispatchFilter user.dir=/home/solr/solr-5.3.1/server\n 1186 INFO (main) [ ] o.a.s.s.SolrDispatchFilter SolrDispatchFilter.init() done\n 1216 INFO (main) [ ] o.e.j.s.h.ContextHandler Started o.e.j.w.WebAppContext@1a75e76a{/solr,[file:/home/solr/solr-5.3.1/server/solr-webapp/webapp/,AVAILABLE|file:///home/solr/solr-5.3.1/server/solr-webapp/webapp/,AVAILABLE]}\n{/home/solr/solr-5.3.1/server/solr-webapp/webapp}\n\n1224 INFO (main) [ ] o.e.j.s.ServerConnector Started ServerConnector@2102a4d5\n\n{HTTP/1.1}\n\n{0.0.0.0:8983}\n\n1228 INFO (main) [ ] o.e.j.s.Server Started @1762ms\n 14426 WARN (qtp1045997582-15) [ ] o.a.s.h.a.SystemInfoHandler Error getting JMX properties\n java.lang.UnsupportedOperationException: Boot class path mechanism is not supported\n at java.management/sun.management.RuntimeImpl.getBootClassPath(RuntimeImpl.java:99)\n at org.apache.solr.handler.admin.SystemInfoHandler.getJvmInfo(SystemInfoHandler.java:317)\n at org.apache.solr.handler.admin.SystemInfoHandler.handleRequestBody(SystemInfoHandler.java:103)\n at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:143)\n at org.apache.solr.handler.admin.InfoHandler.handleRequestBody(InfoHandler.java:90)\n at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:143)\n at org.apache.solr.servlet.HttpSolrCall.handleAdminRequest(HttpSolrCall.java:675)\n at org.apache.solr.servlet.HttpSolrCall.call(HttpSolrCall.java:443)\n at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:214)\n at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:179)\n at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)\n at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:585)\n at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)\n at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:577)\n at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:223)\n at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1127)\n at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:515)\n at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)\n at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1061)\n at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)\n at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:215)\n at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:110)\n at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:97)\n at org.eclipse.jetty.server.Server.handle(Server.java:499)\n at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:310)\n\n[root@centos6 logs]# service solr status\n\nFound 1 Solr nodes:\n\nSolr process 4630 running on port 8983\n\nERROR: Failed to get system information from http://localhost:8983/solr due to: java.lang.NullPointerException\n\n\u00a0\n\nThe exception behind from the log:\n 2018-06-27 20:00:55.411 INFO (main) [ ] o.e.j.s.Server Started @1849ms\n 2018-06-27 20:01:20.192 WARN (qtp1646371921-17) [ ] o.a.s.h.a.SystemInfoHandler Error getting JMX properties\n java.lang.UnsupportedOperationException: Boot class path mechanism is not supported\n at java.management/sun.management.RuntimeImpl.getBootClassPath(RuntimeImpl.java:99)\n at org.apache.solr.handler.admin.SystemInfoHandler.getJvmInfo(SystemInfoHandler.java:317)\n at org.apache.solr.handler.admin.SystemInfoHandler.handleRequestBody(SystemInfoHandler.java:103)\n at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:143)\n at org.apache.solr.handler.admin.InfoHandler.handleRequestBody(InfoHandler.java:90)\n at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:143)\n\nRemoving JMX related option (or disable) won't fix this.\n\nPlease advise.",
    "attachments": {},
    "issue_links": {},
    "comments": [
        {
            "date": "2018-06-28T22:46:38+0000",
            "content": "Closing as not a bug. Java 9 and later is only supported from Solr 7.x. Please upgrade or run with Java8 which is probably the best Java version for your Solr version. ",
            "author": "Jan H\u00f8ydahl",
            "id": "comment-16526872"
        }
    ]
}