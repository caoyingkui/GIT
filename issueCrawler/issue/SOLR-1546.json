{
    "id": "SOLR-1546",
    "title": "When querying solrj the SolrServerException's cause is null",
    "details": {
        "affect_versions": "1.4",
        "status": "Closed",
        "fix_versions": [],
        "components": [
            "clients - java"
        ],
        "type": "Improvement",
        "priority": "Minor",
        "labels": "",
        "resolution": "Incomplete"
    },
    "description": "Our application processes queries like so:\n\n\n        try {\n            final SolrServer server = getServer();\n            final QueryResponse resp = server.query(query);\n            return resp;\n        } catch (final SolrServerException e) {\n             /// bad things probably happened, invoke error processing and possibly switch to the backup\n        }\n\n\n\nGiven SOLR-874 with dismax queries sometimes causing ParseException from Lucene, I'd like to be able to interrogate the cause chain of the SolrServerException. For example if I found ParseException in the chain, I could provide a specific error message and know that it's not necessary to switch to the backup server.\n\nAs it is now, getCause is giving null. The undesirable fix right now is looking inside the toString/description for the \"ParseException\" phrase.\n\nThanks.",
    "attachments": {},
    "issue_links": {},
    "comments": [
        {
            "author": "Hoss Man",
            "id": "comment-12774836",
            "date": "2009-11-08T23:48:59+0000",
            "content": "\nIt would be helpful if you could post the stacktraces for the exception(s) you are seeing where there is no nested clause but you feel like there should be \u2013 that way we'd have methods and line numbers of where the Exception originalted in order to determine why the cause isn't being set properly.\n\nthe current bug description feels like a needle in a hay stack. "
        },
        {
            "author": "Jake Brownell",
            "id": "comment-12774838",
            "date": "2009-11-09T00:24:11+0000",
            "content": "Sure, I was using the third 1.4 release candidate at the time. Hopefully this stack trace is helpful. I guess the summary is slightly misleading, the cause on the original caught exception is populated, it's just not possible to find the ParseException if you climb the exception chain.\n\n\nCaused by: org.apache.solr.client.solrj.SolrServerException: Error executing query\nat org.apache.solr.client.solrj.request.QueryRequest.process(QueryRequest.java:95)\nat org.apache.solr.client.solrj.SolrServer.query(SolrServer.java:118)\nat org.bookshare.search.solr.SolrSearchServerWrapper.query(SolrSearchServerWrapper.java:98) ... 32 more Caused by: org.apache.solr.common.SolrException: org.apache.lucene.queryParser.ParseException: Cannot parse 'OR dad': Encountered \" <OR> \"OR \"\"\nat line 1, column 0. org.apache.lucene.queryParser.ParseException: Cannot parse 'OR dad': Encountered \" <OR> \"OR \"\"\nat line 1, column 0. request: http://localhost:8080/solr/select?q.alt=*:*&qt=dismax&qf=title^2.0&qf=title_phonetic^0.8&qf=author^2.0&qf=author_phonetic^0.8&qf=isbn^3.0&qf=content^1.0&pf=title^2.0&pf=title_phonetic^0.8&pf=author^2.0&pf=author_phonetic^0.8&pf=content^1.0&tie=0.1&q=OR dad&fl=author,title,id,brief_synopsis,copyright_date,publish_date,format,grade,publisher,state,adult,demo,freely_available,nimac&rows=25&start=0&fq=(quality:2 OR quality:3 OR quality:0) AND state:5&hl=true&hl.snippets=3&hl.fl=content_highlight&facet=true&facet.field=author_exact&f.author_exact.facet.method=fc&f.author_exact.facet.limit=20&f.author_exact.facet.offset=0&f.author_exact.facet.mincount=1&f.author_exact.facet.sort=true&debugQuery=false&wt=javabin&version=1\nat org.apache.solr.client.solrj.impl.CommonsHttpSolrServer.request(CommonsHttpSolrServer.java:424)\nat org.apache.solr.client.solrj.impl.CommonsHttpSolrServer.request(CommonsHttpSolrServer.java:243)\nat org.apache.solr.client.solrj.request.QueryRequest.process(QueryRequest.java:89) ... 34 more \n--------------------------------------------------------------------------------\norg.apache.solr.client.solrj.SolrServerException@3a498c[ org.apache.solr.client.solrj.SolrServerException: Error executing query\nat org.apache.solr.client.solrj.request.QueryRequest.process(QueryRequest.java:95)\nat org.apache.solr.client.solrj.SolrServer.query(SolrServer.java:118)\nat org.bookshare.search.solr.SolrSearchServerWrapper.query(SolrSearchServerWrapper.java:98)\nat org.bookshare.search.solr.SolrSearchEngine.search(SolrSearchEngine.java:256)\nat org.bookshare.web.servlet.mvc.BetaAwesomeSearchController.search(BetaAwesomeSearchController.java:425)\nat org.bookshare.web.servlet.mvc.BetaAwesomeSearchController.onSubmit(BetaAwesomeSearchController.java:168)\nat org.springframework.web.servlet.mvc.SimpleFormController.processFormSubmission(SimpleFormController.java:267)\nat org.springframework.web.servlet.mvc.AbstractFormController.handleRequestInternal(AbstractFormController.java:265)\nat org.springframework.web.servlet.mvc.AbstractController.handleRequest(AbstractController.java:153)\nat org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter.handle(SimpleControllerHandlerAdapter.java:48)\nat org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:875)\nat org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:809)\nat org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:571)\nat org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:501)\nat javax.servlet.http.HttpServlet.service(HttpServlet.java:114)\nat javax.servlet.http.HttpServlet.service(HttpServlet.java:91)\nat com.caucho.server.dispatch.ServletFilterChain.doFilter(ServletFilterChain.java:103)\nat org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:359)\nat org.springframework.web.filter.AbstractRequestLoggingFilter.doFilterInternal(AbstractRequestLoggingFilter.java:156)\nat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)\nat org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:371)\nat org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:96)\nat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)\nat org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:371)\nat org.springframework.security.util.FilterChainProxy.doFilter(FilterChainProxy.java:174)\nat org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:236)\nat org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:167)\nat com.caucho.server.dispatch.FilterFilterChain.doFilter(FilterFilterChain.java:76)\nat com.caucho.server.webapp.WebAppFilterChain.doFilter(WebAppFilterChain.java:178)\nat com.caucho.server.dispatch.ServletInvocation.service(ServletInvocation.java:241)\nat com.caucho.server.http.HttpRequest.handleRequest(HttpRequest.java:268)\nat com.caucho.server.port.TcpConnection.run(TcpConnection.java:586)\nat com.caucho.util.ThreadPool$Item.runTasks(ThreadPool.java:690)\nat com.caucho.util.ThreadPool$Item.run(ThreadPool.java:612)\nat java.lang.Thread.run(Thread.java:619) Caused by: org.apache.solr.common.SolrException: org.apache.lucene.queryParser.ParseException: Cannot parse 'OR dad': Encountered \" <OR> \"OR \"\"\nat line 1, column 0. org.apache.lucene.queryParser.ParseException: Cannot parse 'OR dad': Encountered \" <OR> \"OR \"\"\nat line 1, column 0. request: http://localhost:8080/solr/select?q.alt=*:*&qt=dismax&qf=title^2.0&qf=title_phonetic^0.8&qf=author^2.0&qf=author_phonetic^0.8&qf=isbn^3.0&qf=content^1.0&pf=title^2.0&pf=title_phonetic^0.8&pf=author^2.0&pf=author_phonetic^0.8&pf=content^1.0&tie=0.1&q=OR dad&fl=author,title,id,brief_synopsis,copyright_date,publish_date,format,grade,publisher,state,adult,demo,freely_available,nimac&rows=25&start=0&fq=(quality:2 OR quality:3 OR quality:0) AND state:5&hl=true&hl.snippets=3&hl.fl=content_highlight&facet=true&facet.field=author_exact&f.author_exact.facet.method=fc&f.author_exact.facet.limit=20&f.author_exact.facet.offset=0&f.author_exact.facet.mincount=1&f.author_exact.facet.sort=true&debugQuery=false&wt=javabin&version=1\nat org.apache.solr.client.solrj.impl.CommonsHttpSolrServer.request(CommonsHttpSolrServer.java:424)\nat org.apache.solr.client.solrj.impl.CommonsHttpSolrServer.request(CommonsHttpSolrServer.java:243)\nat org.apache.solr.client.solrj.request.QueryRequest.process(QueryRequest.java:89) ... 34 more \n--------------------------------------------------------------------------------\norg.apache.solr.common.SolrException@b2b9bc[ org.apache.solr.common.SolrException: org.apache.lucene.queryParser.ParseException: Cannot parse 'OR dad': Encountered \" <OR> \"OR \"\"\nat line 1, column 0. org.apache.lucene.queryParser.ParseException: Cannot parse 'OR dad': Encountered \" <OR> \"OR \"\"\nat line 1, column 0. request: http://localhost:8080/solr/select?q.alt=*:*&qt=dismax&qf=title^2.0&qf=title_phonetic^0.8&qf=author^2.0&qf=author_phonetic^0.8&qf=isbn^3.0&qf=content^1.0&pf=title^2.0&pf=title_phonetic^0.8&pf=author^2.0&pf=author_phonetic^0.8&pf=content^1.0&tie=0.1&q=OR dad&fl=author,title,id,brief_synopsis,copyright_date,publish_date,format,grade,publisher,state,adult,demo,freely_available,nimac&rows=25&start=0&fq=(quality:2 OR quality:3 OR quality:0) AND state:5&hl=true&hl.snippets=3&hl.fl=content_highlight&facet=true&facet.field=author_exact&f.author_exact.facet.method=fc&f.author_exact.facet.limit=20&f.author_exact.facet.offset=0&f.author_exact.facet.mincount=1&f.author_exact.facet.sort=true&debugQuery=false&wt=javabin&version=1\nat org.apache.solr.client.solrj.impl.CommonsHttpSolrServer.request(CommonsHttpSolrServer.java:424)\nat org.apache.solr.client.solrj.impl.CommonsHttpSolrServer.request(CommonsHttpSolrServer.java:243)\nat org.apache.solr.client.solrj.request.QueryRequest.process(QueryRequest.java:89)\nat org.apache.solr.client.solrj.SolrServer.query(SolrServer.java:118)\nat org.bookshare.search.solr.SolrSearchServerWrapper.query(SolrSearchServerWrapper.java:98)\nat org.bookshare.search.solr.SolrSearchEngine.search(SolrSearchEngine.java:256)\nat org.bookshare.web.servlet.mvc.BetaAwesomeSearchController.search(BetaAwesomeSearchController.java:425)\nat org.bookshare.web.servlet.mvc.BetaAwesomeSearchController.onSubmit(BetaAwesomeSearchController.java:168)\nat org.springframework.web.servlet.mvc.SimpleFormController.processFormSubmission(SimpleFormController.java:267)\nat org.springframework.web.servlet.mvc.AbstractFormController.handleRequestInternal(AbstractFormController.java:265)\nat org.springframework.web.servlet.mvc.AbstractController.handleRequest(AbstractController.java:153)\nat org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter.handle(SimpleControllerHandlerAdapter.java:48)\nat org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:875)\nat org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:809)\nat org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:571)\nat org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:501)\nat javax.servlet.http.HttpServlet.service(HttpServlet.java:114)\nat javax.servlet.http.HttpServlet.service(HttpServlet.java:91)\nat com.caucho.server.dispatch.ServletFilterChain.doFilter(ServletFilterChain.java:103)\nat org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:359)\nat org.springframework.web.filter.AbstractRequestLoggingFilter.doFilterInternal(AbstractRequestLoggingFilter.java:156)\nat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)\nat org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:371)\nat org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:96)\nat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)\nat org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:371)\nat org.springframework.security.util.FilterChainProxy.doFilter(FilterChainProxy.java:174)\nat org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:236)\nat org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:167)\nat com.caucho.server.dispatch.FilterFilterChain.doFilter(FilterFilterChain.java:76)\nat com.caucho.server.webapp.WebAppFilterChain.doFilter(WebAppFilterChain.java:178)\nat com.caucho.server.dispatch.ServletInvocation.service(ServletInvocation.java:241)\nat com.caucho.server.http.HttpRequest.handleRequest(HttpRequest.java:268)\nat com.caucho.server.port.TcpConnection.run(TcpConnection.java:586)\nat com.caucho.util.ThreadPool$Item.runTasks(ThreadPool.java:690)\nat com.caucho.util.ThreadPool$Item.run(ThreadPool.java:612)\nat java.lang.Thread.run(Thread.java:619) \n\n\n "
        },
        {
            "author": "Jan H\u00f8ydahl",
            "id": "comment-15517394",
            "date": "2016-09-23T19:47:33+0000",
            "content": "Closing very old issue. If you still face such issues with latest version of Solr, please open a new issue. "
        }
    ]
}