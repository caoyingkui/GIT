{
    "id": "LUCENE-189",
    "title": "java.io.IOException: read past EOF when building index",
    "details": {
        "labels": "",
        "priority": "Major",
        "components": [
            "core/index"
        ],
        "type": "Bug",
        "fix_versions": [],
        "affect_versions": "None",
        "resolution": "Incomplete",
        "status": "Closed"
    },
    "description": "I found a thread on the dev mailing list relating to this problem, but no \nresolution or bug for it.  Here is Doug's last message on the subject: \nhttp://www.mail-archive.com/lucene-dev@jakarta.apache.org/msg04387.html\n\nIf I run that code from Doug's post within Websphere Studio Application \nDeveloper 5.0 (based on Eclipse), which uses IBM JDK 1.3.1, using code checked \nout from cvs on March 1st, I get the following exception every time:\n\n<pre>\njava.io.IOException: read past EOF\n\tat org.apache.lucene.store.InputStream.refill(InputStream.java(Compiled \nCode))\n\tat org.apache.lucene.index.SegmentTermEnum.next(SegmentTermEnum.java\n(Compiled Code))\n\tat org.apache.lucene.index.SegmentTermEnum.next(SegmentTermEnum.java\n(Compiled Code))\n\tat org.apache.lucene.index.SegmentTermEnum.next(SegmentTermEnum.java\n(Compiled Code))\n\tat org.apache.lucene.index.SegmentTermEnum.next(SegmentTermEnum.java\n(Compiled Code))\n\tat org.apache.lucene.index.TermInfosReader.readIndex\n(TermInfosReader.java:114)\n\tat org.apache.lucene.index.TermInfosReader.<init>\n(TermInfosReader.java:82)\n\tat org.apache.lucene.index.SegmentReader.<init>(SegmentReader.java:143)\n\tat org.apache.lucene.index.IndexWriter.mergeSegments\n(IndexWriter.java:423)\n\tat org.apache.lucene.index.IndexWriter.maybeMergeSegments\n(IndexWriter.java(Compiled Code))\n\tat org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java:260)\n\tat test.com.ibm.services.salesone.fsearch.search.Test.main(Test.java\n(Compiled Code))\n\tat test.com.ibm.services.salesone.fsearch.search.Test.main(Test.java\n(Compiled Code))\n</pre>\n\nHowever, I found that disabling the just in time compiler fixes this problem (-\nDjava.compiler=NONE).  Using IBM JDK 1.4.1 (with or without JIT) fixes this \nalso.\n\nBelow are the properties of my IBM 1.3.1 JVM when this exception occurs:\njava.assistive=ON\njava.runtime.name=Java(TM) 2 Runtime Environment, Standard Edition\nsun.boot.library.path=C:\\Program Files\\IBM\\WebSphere Studio\\runtimes\\aes_v4\n\\java\\jre\\bin\njava.vm.version=1.3.1\njava.vm.vendor=IBM Corporation\njava.vendor.url=http://www.ibm.com/\npath.separator=;\njava.vm.name=Classic VM\nfile.encoding.pkg=sun.io\njava.vm.specification.name=Java Virtual Machine Specification\nuser.dir=C:\\dev\\wsad\\workspace\\fsearch\njava.runtime.version=1.3.1\njava.fullversion=J2RE 1.3.1 IBM Windows 32 build cn131w-20020710 ORB130 (JIT \nenabled: jitc)\njava.awt.graphicsenv=sun.awt.Win32GraphicsEnvironment\nos.arch=x86\njava.io.tmpdir=C:\\DOCUME~1\\JMCKIN~1\\LOCALS~1\\Temp\\\nline.separator=\n\njava.vm.specification.vendor=Sun Microsystems Inc.\njava.awt.fonts=\nos.name=Windows 2000\njava.library.path=C:\\Program Files\\IBM\\WebSphere Studio\\runtimes\\aes_v4\n\\java\\jre\\bin;.;C:\\WINNT\\system32;C:\\WINNT;C:\\Program Files\\ibm\\gsk5\n\\lib;C:\\IBMDebug\\bin;C:\\WebSphere\\SQLLIB\\bin;C:\\Program \nFiles\\IBMTrans\\bin;C:\\WINNT\\system32;C:\\WINNT;C:\\WINNT\\System32\n\\Wbem;C:\\IBM\\IMNNQ;C:\\SQLLIB\\BIN;C:\\SQLLIB\\FUNCTION;C:\\SQLLIB\\SAMPLES\\REPL;C:\\SQ\nLLIB\\HELP;C:\\IFOR\\WIN\\BIN;C:\\IFOR\\WIN\\BIN\\EN_US;C:\\WebSphere\\AppServer\\bin;C:\\Pr\nogram Files\\GNU\\WinCvs 1.2;C:\\dev\\java\\apache-ant-1.6.0\\bin;C:\\j2sdk1.4.1_01\n\\bin;C:\\Program Files\\Rational\\common;c:\\PSM\njava.specification.name=Java Platform API Specification\njava.class.version=46.0\ninvokedviajava=\nos.version=5.0\nuser.home=C:\\Documents and Settings\\jmckinney\nuser.timezone=Europe/London\njava.awt.printerjob=sun.awt.windows.WPrinterJob\nfile.encoding=Cp1252\njava.specification.version=1.3\njava.class.path=C:\\dev\\wsad\\workspace\\fsearch\\bin;C:\\Program \nFiles\\IBM\\WebSphere Studio\\eclipse\\plugins\\org.apache.xerces_4.0.7\n\\xmlParserAPIs.jar;C:\\Program Files\\IBM\\WebSphere Studio\\runtimes\\aes_v4\n\\lib\\j2ee.jar;C:\\Program Files\\IBM\\WebSphere \nStudio\\eclipse\\plugins\\org.junit_3.7.0\\junit.jar;C:\\Program Files\\IBM\\WebSphere \nStudio\\runtimes\\aes_v4\\lib\\xerces.jar;C:\\dev\\wsad\\workspace\\fsearch\\lib\\lucene-\n1.4-rc1-dev.jar\nuser.name=jmckinney\njava.vm.specification.version=1.0\njava.home=C:\\Program Files\\IBM\\WebSphere Studio\\runtimes\\aes_v4\\java\\jre\nuser.language=en\njava.specification.vendor=Sun Microsystems Inc.\nawt.toolkit=sun.awt.windows.WToolkit\njava.vm.info=J2RE 1.3.1 IBM Windows 32 build cn131w-20020710 ORB130 (JIT \nenabled: jitc)\njava.version=1.3.1\njava.ext.dirs=C:\\Program Files\\IBM\\WebSphere Studio\\runtimes\\aes_v4\n\\java\\jre\\lib\\ext\nsun.boot.class.path=C:\\Program Files\\IBM\\WebSphere Studio\\runtimes\\aes_v4\n\\java\\jre\\lib\\rt.jar\njava.vendor=IBM Corporation\nfile.separator=\\\njava.vendor.url.bug=\njava.compiler=jitc\nsun.io.unicode.encoding=UnicodeLittle\nuser.region=GB",
    "attachments": {},
    "issue_links": {},
    "comments": [
        {
            "date": "2004-03-03T21:52:56+0000",
            "content": "It turned out to be a bug in the JVM.  Try upgrading. ",
            "author": "Otis Gospodnetic",
            "id": "comment-12321586"
        }
    ]
}