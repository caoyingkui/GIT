{
    "id": "SOLR-4939",
    "title": "Not able to import oracle DB on RedHat",
    "details": {
        "affect_versions": "4.3.1",
        "status": "Resolved",
        "fix_versions": [],
        "components": [],
        "type": "Bug",
        "priority": "Major",
        "labels": "",
        "resolution": "Invalid"
    },
    "description": "I have configured my RedHat system for Solr. After that I started the solr, it is started properly. I have to import the Oracle DB for indexing. My data config file is.\n\n<dataConfig>\n\t<dataSource type=\"JdbcDataSource\" driver=\"oracle.jdbc.driver.OracleDriver\" url=\"jdbc:oracle:thin:@//<hostname>:2126/DBNAme\" user=\"user\" password=\"Passwd\" batchSize=\"1\" />\n\t<document>\n\t\t<entity name=\"table1\" query=\"SELECT ID, col2, col3 FROM table1 WHERE rownum BETWEEN 1 AND 1000\" >\n\t\t\t<field column=\"ID\" name=\"id\" />\n\t\t\t<field column=\"col2\" name=\"col2\" />\n\t\t\t<field column=\"col3\" name=\"col3\" />\n\t\t</entity>\n\t</document>\n</dataConfig>\n\nI have done similar changes for schema.xml file.\n\nI have copied the solr-dataimporthandler-4.3.0.jar, solr-dataimporthandler-extras-4.3.0.jar, solr-solrj-4.3.0.jar from dist folder to ../lib folder. Also I have downloaded ojdbc6.jar and put in same folder.\n\nWith this setting, it is working properly on Windows. However on RedHat, it is not working. It is giving me errors when I try to index DB.\n\nBelow are the errors which I got on console.\n\nERROR org.apache.solr.handler.dataimport.DocBuilder  \u00e2 Exception while processing: table1 document : SolrInputDocument[]:org.apache.solr.handler.dataimport.DataImportHandlerException: Unable to execute query: SELECT ID, col2, col3 FROM table1 WHERE rownum BETWEEN 1 AND 1000 Processing Document # 1\n        at org.apache.solr.handler.dataimport.DataImportHandlerException.wrapAndThrow(DataImportHandlerException.java:71)\n        at org.apache.solr.handler.dataimport.JdbcDataSource$ResultSetIterator.<init>(JdbcDataSource.java:253)\n        at org.apache.solr.handler.dataimport.JdbcDataSource.getData(JdbcDataSource.java:210)\n        at org.apache.solr.handler.dataimport.JdbcDataSource.getData(JdbcDataSource.java:38)\n        at org.apache.solr.handler.dataimport.SqlEntityProcessor.initQuery(SqlEntityProcessor.java:59)\n        at org.apache.solr.handler.dataimport.SqlEntityProcessor.nextRow(SqlEntityProcessor.java:73)\n        at org.apache.solr.handler.dataimport.EntityProcessorWrapper.nextRow(EntityProcessorWrapper.java:243)\n        at org.apache.solr.handler.dataimport.DocBuilder.buildDocument(DocBuilder.java:465)\n        at org.apache.solr.handler.dataimport.DocBuilder.buildDocument(DocBuilder.java:404)\n        at org.apache.solr.handler.dataimport.DocBuilder.doFullDump(DocBuilder.java:319)\n        at org.apache.solr.handler.dataimport.DocBuilder.execute(DocBuilder.java:227)\n        at org.apache.solr.handler.dataimport.DataImporter.doFullImport(DataImporter.java:422)\n        at org.apache.solr.handler.dataimport.DataImporter.runCmd(DataImporter.java:487)\n        at org.apache.solr.handler.dataimport.DataImporter$1.run(DataImporter.java:468)\nCaused by: java.sql.SQLRecoverableException: IO Error: The Network Adapter could not establish the connection\n        at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:458)\n        at oracle.jdbc.driver.PhysicalConnection.<init>(PhysicalConnection.java:546)\n        at oracle.jdbc.driver.T4CConnection.<init>(T4CConnection.java:236)\n        at oracle.jdbc.driver.T4CDriverExtension.getConnection(T4CDriverExtension.java:32)\n        at oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:521)\n        at org.apache.solr.handler.dataimport.JdbcDataSource$1.call(JdbcDataSource.java:161)\n        at org.apache.solr.handler.dataimport.JdbcDataSource$1.call(JdbcDataSource.java:127)\n        at org.apache.solr.handler.dataimport.JdbcDataSource.getConnection(JdbcDataSource.java:366)\n        at org.apache.solr.handler.dataimport.JdbcDataSource.access$200(JdbcDataSource.java:38)\n        at org.apache.solr.handler.dataimport.JdbcDataSource$ResultSetIterator.<init>(JdbcDataSource.java:240)\n        ... 12 more\nCaused by: oracle.net.ns.NetException: The Network Adapter could not establish the connection\n        at oracle.net.nt.ConnStrategy.execute(ConnStrategy.java:392)\n        at oracle.net.resolver.AddrResolution.resolveAndExecute(AddrResolution.java:434)\n        at oracle.net.ns.NSProtocol.establishConnection(NSProtocol.java:687)\n        at oracle.net.ns.NSProtocol.connect(NSProtocol.java:247)\n        at oracle.jdbc.driver.T4CConnection.connect(T4CConnection.java:1102)\n        at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:320)\n        ... 21 more\nCaused by: java.net.ConnectException: Connection timed out\n        at java.net.PlainSocketImpl.socketConnect(Native Method)\n        at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:327)\n        at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:193)\n        at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:180)\n        at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:384)\n        at java.net.Socket.connect(Socket.java:546)\n        at oracle.net.nt.TcpNTAdapter.connect(TcpNTAdapter.java:150)\n        at oracle.net.nt.ConnOption.connect(ConnOption.java:133)\n        at oracle.net.nt.ConnStrategy.execute(ConnStrategy.java:370)\n        ... 26 more\n\n63262 [Thread-15] INFO  org.apache.solr.update.processor.LogUpdateProcessor  \u00e2 [collection1] webapp=/solr path=/dataimport params=\n{optimize=false&clean=false&indent=true&commit=true&verbose=false&command=full-import&debug=false&wt=json}\n status=0 QTime=21 {} 0 21\n63263 [Thread-15] ERROR org.apache.solr.handler.dataimport.DataImporter  \u00e2 Full Import failed:java.lang.RuntimeException: java.lang.RuntimeException: org.apache.solr.handler.dataimport.DataImportHandlerException: Unable to execute query: SELECT ID, col2, col3 FROM table1 WHERE rownum BETWEEN 1 AND 1000 Processing Document # 1\n        at org.apache.solr.handler.dataimport.DocBuilder.execute(DocBuilder.java:266)\n        at org.apache.solr.handler.dataimport.DataImporter.doFullImport(DataImporter.java:422)\n        at org.apache.solr.handler.dataimport.DataImporter.runCmd(DataImporter.java:487)\n        at org.apache.solr.handler.dataimport.DataImporter$1.run(DataImporter.java:468)\nCaused by: java.lang.RuntimeException: org.apache.solr.handler.dataimport.DataImportHandlerException: SELECT ID, col2, col3 FROM table1 WHERE rownum BETWEEN 1 AND 1000 Processing Document # 1\n        at org.apache.solr.handler.dataimport.DocBuilder.buildDocument(DocBuilder.java:406)\n        at org.apache.solr.handler.dataimport.DocBuilder.doFullDump(DocBuilder.java:319)\n        at org.apache.solr.handler.dataimport.DocBuilder.execute(DocBuilder.java:227)\n        ... 3 more\nCaused by: org.apache.solr.handler.dataimport.DataImportHandlerException: Unable to execute query: SELECT ID, col2, col3 FROM table1 WHERE rownum BETWEEN 1 AND 1000 Processing Document # 1\n        at org.apache.solr.handler.dataimport.DataImportHandlerException.wrapAndThrow(DataImportHandlerException.java:71)\n        at org.apache.solr.handler.dataimport.JdbcDataSource$ResultSetIterator.<init>(JdbcDataSource.java:253)\n        at org.apache.solr.handler.dataimport.JdbcDataSource.getData(JdbcDataSource.java:210)\n        at org.apache.solr.handler.dataimport.JdbcDataSource.getData(JdbcDataSource.java:38)\n        at org.apache.solr.handler.dataimport.SqlEntityProcessor.initQuery(SqlEntityProcessor.java:59)\n        at org.apache.solr.handler.dataimport.SqlEntityProcessor.nextRow(SqlEntityProcessor.java:73)\n        at org.apache.solr.handler.dataimport.EntityProcessorWrapper.nextRow(EntityProcessorWrapper.java:243)\n        at org.apache.solr.handler.dataimport.DocBuilder.buildDocument(DocBuilder.java:465)\n        at org.apache.solr.handler.dataimport.DocBuilder.buildDocument(DocBuilder.java:404)\n        ... 5 more\nCaused by: java.sql.SQLRecoverableException: IO Error: The Network Adapter could not establish the connection\n        at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:458)\n        at oracle.jdbc.driver.PhysicalConnection.<init>(PhysicalConnection.java:546)\n        at oracle.jdbc.driver.T4CConnection.<init>(T4CConnection.java:236)\n        at oracle.jdbc.driver.T4CDriverExtension.getConnection(T4CDriverExtension.java:32)\n        at oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:521)\n        at org.apache.solr.handler.dataimport.JdbcDataSource$1.call(JdbcDataSource.java:161)\n        at org.apache.solr.handler.dataimport.JdbcDataSource$1.call(JdbcDataSource.java:127)\n        at org.apache.solr.handler.dataimport.JdbcDataSource.getConnection(JdbcDataSource.java:366)\n        at org.apache.solr.handler.dataimport.JdbcDataSource.access$200(JdbcDataSource.java:38)\n        at org.apache.solr.handler.dataimport.JdbcDataSource$ResultSetIterator.<init>(JdbcDataSource.java:240)\n        ... 12 more\nCaused by: oracle.net.ns.NetException: The Network Adapter could not establish the connection\n        at oracle.net.nt.ConnStrategy.execute(ConnStrategy.java:392)\n        at oracle.net.resolver.AddrResolution.resolveAndExecute(AddrResolution.java:434)\n        at oracle.net.ns.NSProtocol.establishConnection(NSProtocol.java:687)\n        at oracle.net.ns.NSProtocol.connect(NSProtocol.java:247)\n        at oracle.jdbc.driver.T4CConnection.connect(T4CConnection.java:1102)\n        at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:320)\n        ... 21 more\nCaused by: java.net.ConnectException: Connection timed out\n        at java.net.PlainSocketImpl.socketConnect(Native Method)\n        at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:327)\n        at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:193)\n        at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:180)\n        at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:384)\n        at java.net.Socket.connect(Socket.java:546)\n        at oracle.net.nt.TcpNTAdapter.connect(TcpNTAdapter.java:150)\n        at oracle.net.nt.ConnOption.connect(ConnOption.java:133)\n        at oracle.net.nt.ConnStrategy.execute(ConnStrategy.java:370)\n        ... 26 more\n\nPlease let me know, what I am missing?",
    "attachments": {},
    "issue_links": {},
    "comments": [
        {
            "author": "Erick Erickson",
            "id": "comment-13687914",
            "date": "2013-06-19T12:12:27+0000",
            "content": "Please raise this issue on the user's list first to determine whether it's a bona-fide bug, I suspect a configuration error. If it is really a bug, we can re-open this. "
        },
        {
            "author": "Uwe Schindler",
            "id": "comment-13687924",
            "date": "2013-06-19T12:28:18+0000",
            "content": "Check your firewall! I think your server may not have TCP access to the database server. "
        },
        {
            "author": "Subhash Karemore",
            "id": "comment-13688201",
            "date": "2013-06-19T17:42:24+0000",
            "content": "Hi,\n\nI think you are right. I am not too much familiar with linux environment.  Could you please tell me exact command for allowing TCP connection so that I should able to connect to remote oracle DB using java. I searched lot for this problem, however I didn't find the exact command/solution.\n\nI appreciate your help.\n\nRegards,\nSubhash\n "
        },
        {
            "author": "Uwe Schindler",
            "id": "comment-13688217",
            "date": "2013-06-19T17:54:35+0000",
            "content": "Ask your firewall administrator, we have no idea about your environment and cannot help!\n\nA quick test if it works at all is to enter the following on shell (needs netcat installed):\n\n\nnc <hostname_of_oracle_server> 2126\n\n\n\nIf this also timeouts, ask somebody who knows your network. "
        }
    ]
}