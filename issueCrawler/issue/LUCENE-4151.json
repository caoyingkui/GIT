{
    "id": "LUCENE-4151",
    "title": "Hang in Lucene trunk while indexing",
    "details": {
        "labels": "",
        "priority": "Major",
        "components": [],
        "type": "Bug",
        "fix_versions": [],
        "affect_versions": "4.0-ALPHA,                                            6.0",
        "resolution": "Unresolved",
        "status": "Open"
    },
    "description": "See: http://jenkins.sd-datasolutions.de/job/Lucene-Solr-trunk-Linux-Java7-64/309/\n\nI stopped the build, 2 test childs were still running 100% CPU in analysis tests. I was ablte to get stack trace of one of then, see build log:\n\n\n[junit4] \"TEST-TestScope-org.apache.lucene.analysis.hunspell.HunspellStemFilterTest.testRandomStrings-seed#[BEEAD57FE445FA49]\" prio=10 tid=0x00007fde184d8800 nid=0x497d runnable [0x00007fde0bd7a000]\n[junit4]    java.lang.Thread.State: RUNNABLE\n[junit4] \tat org.apache.lucene.codecs.lucene40.values.Bytes$DerefBytesWriterBase.fillDefault(Bytes.java:456)\n[junit4] \tat org.apache.lucene.codecs.lucene40.values.Bytes$DerefBytesWriterBase.add(Bytes.java:435)\n[junit4] \tat org.apache.lucene.codecs.lucene40.values.FixedDerefBytesImpl$Writer.add(FixedDerefBytesImpl.java:48)\n[junit4] \tat org.apache.lucene.codecs.DocValuesConsumer.mergeDoc(DocValuesConsumer.java:237)\n[junit4] \tat org.apache.lucene.codecs.DocValuesConsumer.merge(DocValuesConsumer.java:184)\n[junit4] \tat org.apache.lucene.codecs.DocValuesConsumer.merge(DocValuesConsumer.java:112)\n[junit4] \tat org.apache.lucene.codecs.PerDocConsumer.merge(PerDocConsumer.java:60)\n[junit4] \tat org.apache.lucene.index.SegmentMerger.mergePerDoc(SegmentMerger.java:351)\n[junit4] \tat org.apache.lucene.index.SegmentMerger.merge(SegmentMerger.java:119)\n[junit4] \tat org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:3477)\n[junit4] \tat org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3112)\n[junit4] \tat org.apache.lucene.index.SerialMergeScheduler.merge(SerialMergeScheduler.java:37)\n[junit4] \t- locked <0x00000000f8cb6320> (a org.apache.lucene.index.SerialMergeScheduler)\n[junit4] \tat org.apache.lucene.index.IndexWriter.maybeMerge(IndexWriter.java:1706)\n[junit4] \tat org.apache.lucene.index.IndexWriter.maybeMerge(IndexWriter.java:1700)\n[junit4] \tat org.apache.lucene.index.IndexWriter.updateDocuments(IndexWriter.java:1197)\n[junit4] \tat org.apache.lucene.index.IndexWriter.addDocuments(IndexWriter.java:1147)\n[junit4] \tat org.apache.lucene.index.RandomIndexWriter.addDocument(RandomIndexWriter.java:157)\n[junit4] \tat org.apache.lucene.index.RandomIndexWriter.addDocument(RandomIndexWriter.java:145)\n[junit4] \tat org.apache.lucene.analysis.BaseTokenStreamTestCase.checkRandomData(BaseTokenStreamTestCase.java:558)\n[junit4] \tat org.apache.lucene.analysis.BaseTokenStreamTestCase.checkRandomData(BaseTokenStreamTestCase.java:446)\n[junit4] \tat org.apache.lucene.analysis.BaseTokenStreamTestCase.checkRandomData(BaseTokenStreamTestCase.java:373)\n[junit4] \tat org.apache.lucene.analysis.hunspell.HunspellStemFilterTest.testRandomStrings(HunspellStemFilterTest.java:75)\n[junit4] \tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n[junit4] \tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n[junit4] \tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n[junit4] \tat java.lang.reflect.Method.invoke(Method.java:601)\n[junit4] \tat com.carrotsearch.randomizedtesting.RandomizedRunner.invoke(RandomizedRunner.java:1969)\n[junit4] \tat com.carrotsearch.randomizedtesting.RandomizedRunner.access$1100(RandomizedRunner.java:132)\n[junit4] \tat com.carrotsearch.randomizedtesting.RandomizedRunner$6.evaluate(RandomizedRunner.java:814)\n[junit4] \tat com.carrotsearch.randomizedtesting.RandomizedRunner$7.evaluate(RandomizedRunner.java:875)\n[junit4] \tat com.carrotsearch.randomizedtesting.RandomizedRunner$8.evaluate(RandomizedRunner.java:889)\n[junit4] \tat org.apache.lucene.util.TestRuleSetupTeardownChained$1.evaluate(TestRuleSetupTeardownChained.java:50)\n[junit4] \tat org.apache.lucene.util.TestRuleFieldCacheSanity$1.evaluate(TestRuleFieldCacheSanity.java:32)\n[junit4] \tat org.apache.lucene.util.AbstractBeforeAfterRule$1.evaluate(AbstractBeforeAfterRule.java:45)\n[junit4] \tat com.carrotsearch.randomizedtesting.rules.SystemPropertiesInvariantRule$1.evaluate(SystemPropertiesInvariantRule.java:55)\n[junit4] \tat org.apache.lucene.util.TestRuleReportUncaughtExceptions$1.evaluate(TestRuleReportUncaughtExceptions.java:68)\n[junit4] \tat org.apache.lucene.util.TestRuleThreadAndTestName$1.evaluate(TestRuleThreadAndTestName.java:48)\n[junit4] \tat org.apache.lucene.util.TestRuleMarkFailure$1.evaluate(TestRuleMarkFailure.java:48)\n[junit4] \tat com.carrotsearch.randomizedtesting.RandomizedRunner.runSingleTest(RandomizedRunner.java:821)\n[junit4] \tat com.carrotsearch.randomizedtesting.RandomizedRunner.access$700(RandomizedRunner.java:132)\n[junit4] \tat com.carrotsearch.randomizedtesting.RandomizedRunner$3$1.run(RandomizedRunner.java:669)\n[junit4] \tat com.carrotsearch.randomizedtesting.RandomizedRunner$3.evaluate(RandomizedRunner.java:695)\n[junit4] \tat com.carrotsearch.randomizedtesting.RandomizedRunner$4.evaluate(RandomizedRunner.java:734)\n[junit4] \tat com.carrotsearch.randomizedtesting.RandomizedRunner$5.evaluate(RandomizedRunner.java:745)\n[junit4] \tat org.apache.lucene.util.AbstractBeforeAfterRule$1.evaluate(AbstractBeforeAfterRule.java:45)\n[junit4] \tat org.apache.lucene.util.TestRuleReportUncaughtExceptions$1.evaluate(TestRuleReportUncaughtExceptions.java:68)\n[junit4] \tat org.apache.lucene.util.TestRuleStoreClassName$1.evaluate(TestRuleStoreClassName.java:38)\n[junit4] \tat org.apache.lucene.util.TestRuleIcuHack$1.evaluate(TestRuleIcuHack.java:51)\n[junit4] \tat com.carrotsearch.randomizedtesting.rules.SystemPropertiesInvariantRule$1.evaluate(SystemPropertiesInvariantRule.java:55)\n[junit4] \tat org.apache.lucene.util.TestRuleNoInstanceHooksOverrides$1.evaluate(TestRuleNoInstanceHooksOverrides.java:53)\n[junit4] \tat org.apache.lucene.util.TestRuleNoStaticHooksShadowing$1.evaluate(TestRuleNoStaticHooksShadowing.java:52)\n[junit4] \tat org.apache.lucene.util.TestRuleAssertionsRequired$1.evaluate(TestRuleAssertionsRequired.java:36)\n[junit4] \tat org.apache.lucene.util.TestRuleMarkFailure$1.evaluate(TestRuleMarkFailure.java:48)\n[junit4] \tat org.apache.lucene.util.TestRuleIgnoreTestSuites$1.evaluate(TestRuleIgnoreTestSuites.java:56)\n[junit4] \tat com.carrotsearch.randomizedtesting.RandomizedRunner.runSuite(RandomizedRunner.java:605)\n[junit4] \tat com.carrotsearch.randomizedtesting.RandomizedRunner.access$400(RandomizedRunner.java:132)\n[junit4] \tat com.carrotsearch.randomizedtesting.RandomizedRunner$2.run(RandomizedRunner.java:551)\n\n\n\nPlease note the line with \"locked in SerialMergeScheduler\"!",
    "attachments": {},
    "issue_links": {},
    "comments": []
}