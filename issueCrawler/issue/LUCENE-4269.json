{
    "id": "LUCENE-4269",
    "title": "TestBalancedSegmentMergePolicy.setUp hang",
    "details": {
        "labels": "",
        "priority": "Major",
        "components": [],
        "type": "Bug",
        "fix_versions": [],
        "affect_versions": "None",
        "resolution": "Won't Fix",
        "status": "Resolved"
    },
    "description": "http://85.25.120.39/job/Lucene-trunk-Linux-Java7-64 was hung for a couple days ... stacktrace:\n\n\n2012-07-28 13:45:03\nFull thread dump Java HotSpot(TM) 64-Bit Server VM (23.1-b03 mixed mode):\n\n\"TEST-TestScope-org.apache.lucene.index.TestBalancedSegmentMergePolicy.testForceMerge-seed#[F42FFCD5FAEE14FF]\" prio=10 tid=0x00007f56e8371800 nid=0x106c runnable [0x00007f56b2130000]\n   java.lang.Thread.State: RUNNABLE\n\tat org.apache.lucene.codecs.BlockTreeTermsWriter$TermsWriter$FindBlocks.freeze(BlockTreeTermsWriter.java:392)\n\tat org.apache.lucene.util.fst.Builder.freezeTail(Builder.java:212)\n\tat org.apache.lucene.util.fst.Builder.add(Builder.java:392)\n\tat org.apache.lucene.codecs.BlockTreeTermsWriter$TermsWriter.finishTerm(BlockTreeTermsWriter.java:864)\n\tat org.apache.lucene.codecs.TermsConsumer.merge(TermsConsumer.java:167)\n\tat org.apache.lucene.codecs.FieldsConsumer.merge(FieldsConsumer.java:65)\n\tat org.apache.lucene.index.SegmentMerger.mergeTerms(SegmentMerger.java:323)\n\tat org.apache.lucene.index.SegmentMerger.merge(SegmentMerger.java:110)\n\tat org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:3539)\n\tat org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3154)\n\tat org.apache.lucene.index.SerialMergeScheduler.merge(SerialMergeScheduler.java:36)\n\t- locked <0x00000000dc0fcfb8> (a org.apache.lucene.index.SerialMergeScheduler)\n\tat org.apache.lucene.index.IndexWriter.maybeMerge(IndexWriter.java:1727)\n\tat org.apache.lucene.index.IndexWriter.maybeMerge(IndexWriter.java:1721)\n\tat org.apache.lucene.index.IndexWriter.prepareCommit(IndexWriter.java:2612)\n\t- locked <0x00000000dc0fcfc8> (a java.lang.Object)\n\tat org.apache.lucene.index.IndexWriter.commitInternal(IndexWriter.java:2699)\n\t- locked <0x00000000dc0fcfc8> (a java.lang.Object)\n\tat org.apache.lucene.index.IndexWriter.commit(IndexWriter.java:2679)\n\tat org.apache.lucene.index.IndexWriter.commit(IndexWriter.java:2663)\n\tat org.apache.lucene.index.RandomIndexWriter.commit(RandomIndexWriter.java:346)\n\tat org.apache.lucene.index.TestBalancedSegmentMergePolicy.setUp(TestBalancedSegmentMergePolicy.java:55)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:601)\n\tat com.carrotsearch.randomizedtesting.RandomizedRunner.invoke(RandomizedRunner.java:1995)\n\tat com.carrotsearch.randomizedtesting.RandomizedRunner.access$1100(RandomizedRunner.java:132)\n\tat com.carrotsearch.randomizedtesting.RandomizedRunner$7.evaluate(RandomizedRunner.java:875)\n\tat com.carrotsearch.randomizedtesting.RandomizedRunner$8.evaluate(RandomizedRunner.java:891)\n\tat org.apache.lucene.util.TestRuleSetupTeardownChained$1.evaluate(TestRuleSetupTeardownChained.java:50)\n\tat org.apache.lucene.util.TestRuleFieldCacheSanity$1.evaluate(TestRuleFieldCacheSanity.java:32)\n\tat org.apache.lucene.util.AbstractBeforeAfterRule$1.evaluate(AbstractBeforeAfterRule.java:45)\n\tat com.carrotsearch.randomizedtesting.rules.SystemPropertiesInvariantRule$1.evaluate(SystemPropertiesInvariantRule.java:55)\n\tat org.apache.lucene.util.TestRuleReportUncaughtExceptions$1.evaluate(TestRuleReportUncaughtExceptions.java:68)\n\tat org.apache.lucene.util.TestRuleThreadAndTestName$1.evaluate(TestRuleThreadAndTestName.java:48)\n\tat org.apache.lucene.util.TestRuleIgnoreAfterMaxFailures$1.evaluate(TestRuleIgnoreAfterMaxFailures.java:70)\n\tat org.apache.lucene.util.TestRuleMarkFailure$1.evaluate(TestRuleMarkFailure.java:48)\n\tat com.carrotsearch.randomizedtesting.RandomizedRunner.runSingleTest(RandomizedRunner.java:825)\n\tat com.carrotsearch.randomizedtesting.RandomizedRunner.access$700(RandomizedRunner.java:132)\n\tat com.carrotsearch.randomizedtesting.RandomizedRunner$3$1.run(RandomizedRunner.java:671)\n\tat com.carrotsearch.randomizedtesting.RandomizedRunner$3.evaluate(RandomizedRunner.java:697)\n\tat com.carrotsearch.randomizedtesting.RandomizedRunner$4.evaluate(RandomizedRunner.java:736)\n\tat com.carrotsearch.randomizedtesting.RandomizedRunner$5.evaluate(RandomizedRunner.java:747)\n\tat org.apache.lucene.util.AbstractBeforeAfterRule$1.evaluate(AbstractBeforeAfterRule.java:45)\n\tat org.apache.lucene.util.TestRuleReportUncaughtExceptions$1.evaluate(TestRuleReportUncaughtExceptions.java:68)\n\tat org.apache.lucene.util.TestRuleStoreClassName$1.evaluate(TestRuleStoreClassName.java:38)\n\tat org.apache.lucene.util.TestRuleIcuHack$1.evaluate(TestRuleIcuHack.java:51)\n\tat com.carrotsearch.randomizedtesting.rules.SystemPropertiesInvariantRule$1.evaluate(SystemPropertiesInvariantRule.java:55)\n\tat org.apache.lucene.util.TestRuleNoInstanceHooksOverrides$1.evaluate(TestRuleNoInstanceHooksOverrides.java:53)\n\tat org.apache.lucene.util.TestRuleNoStaticHooksShadowing$1.evaluate(TestRuleNoStaticHooksShadowing.java:52)\n\tat org.apache.lucene.util.TestRuleAssertionsRequired$1.evaluate(TestRuleAssertionsRequired.java:36)\n\tat org.apache.lucene.util.TestRuleMarkFailure$1.evaluate(TestRuleMarkFailure.java:48)\n\tat org.apache.lucene.util.TestRuleIgnoreAfterMaxFailures$1.evaluate(TestRuleIgnoreAfterMaxFailures.java:70)\n\tat org.apache.lucene.util.TestRuleIgnoreTestSuites$1.evaluate(TestRuleIgnoreTestSuites.java:55)\n\tat com.carrotsearch.randomizedtesting.RandomizedRunner.runSuite(RandomizedRunner.java:605)\n\tat com.carrotsearch.randomizedtesting.RandomizedRunner.access$400(RandomizedRunner.java:132)\n\tat com.carrotsearch.randomizedtesting.RandomizedRunner$2.run(RandomizedRunner.java:551)\n\n\"Service Thread\" daemon prio=10 tid=0x00007f56e81be800 nid=0x1062 runnable [0x0000000000000000]\n   java.lang.Thread.State: RUNNABLE\n\n\"C2 CompilerThread1\" daemon prio=10 tid=0x00007f56e81bc000 nid=0x1060 waiting on condition [0x0000000000000000]\n   java.lang.Thread.State: RUNNABLE\n\n\"C2 CompilerThread0\" daemon prio=10 tid=0x00007f56e81b9800 nid=0x105f waiting on condition [0x0000000000000000]\n   java.lang.Thread.State: RUNNABLE\n\n\"Signal Dispatcher\" daemon prio=10 tid=0x00007f56e81b7800 nid=0x105e waiting on condition [0x0000000000000000]\n   java.lang.Thread.State: RUNNABLE\n\n\"Surrogate Locker Thread (Concurrent GC)\" daemon prio=10 tid=0x00007f56e81b5800 nid=0x105c waiting on condition [0x0000000000000000]\n   java.lang.Thread.State: RUNNABLE\n\n\"Finalizer\" daemon prio=10 tid=0x00007f56e8167000 nid=0x1057 in Object.wait() [0x00007f56b3127000]\n   java.lang.Thread.State: WAITING (on object monitor)\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0x00000000dd21e078> (a java.lang.ref.ReferenceQueue$Lock)\n\tat java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:135)\n\t- locked <0x00000000dd21e078> (a java.lang.ref.ReferenceQueue$Lock)\n\tat java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:151)\n\tat java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:177)\n\n\"Reference Handler\" daemon prio=10 tid=0x00007f56e8164800 nid=0x1056 in Object.wait() [0x00007f56b3228000]\n   java.lang.Thread.State: WAITING (on object monitor)\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0x00000000dd21e068> (a java.lang.ref.Reference$Lock)\n\tat java.lang.Object.wait(Object.java:503)\n\tat java.lang.ref.Reference$ReferenceHandler.run(Reference.java:133)\n\t- locked <0x00000000dd21e068> (a java.lang.ref.Reference$Lock)\n\n\"main\" prio=10 tid=0x00007f56e800c000 nid=0x1028 in Object.wait() [0x00007f56edd14000]\n   java.lang.Thread.State: WAITING (on object monitor)\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0x00000000dc0f4528> (a com.carrotsearch.randomizedtesting.RandomizedRunner$2)\n\tat java.lang.Thread.join(Thread.java:1258)\n\t- locked <0x00000000dc0f4528> (a com.carrotsearch.randomizedtesting.RandomizedRunner$2)\n\tat java.lang.Thread.join(Thread.java:1332)\n\tat com.carrotsearch.randomizedtesting.RandomizedRunner.runSuite(RandomizedRunner.java:561)\n\tat com.carrotsearch.randomizedtesting.RandomizedRunner.run(RandomizedRunner.java:521)\n\tat com.carrotsearch.ant.tasks.junit4.slave.SlaveMain.execute(SlaveMain.java:153)\n\tat com.carrotsearch.ant.tasks.junit4.slave.SlaveMain.main(SlaveMain.java:246)\n\tat com.carrotsearch.ant.tasks.junit4.slave.SlaveMainSafe.main(SlaveMainSafe.java:12)\n\n\"VM Thread\" prio=10 tid=0x00007f",
    "attachments": {},
    "issue_links": {},
    "comments": [
        {
            "date": "2012-07-28T17:49:15+0000",
            "content": "Events file:\n\n\n[\n  \"BOOTSTRAP\",\n  {\n    \"defaultCharset\": \"US-ASCII\",\n    \"systemProperties\": {\n      \"awt.toolkit\": \"sun.awt.X11.XToolkit\",\n      \"file.encoding\": \"US-ASCII\",\n      \"file.encoding.pkg\": \"sun.io\",\n      \"file.separator\": \"/\",\n      \"java.awt.graphicsenv\": \"sun.awt.X11GraphicsEnvironment\",\n      \"java.awt.printerjob\": \"sun.print.PSPrinterJob\",\n      \"java.class.path\": \"/var/lib/jenkins/workspace/Lucene-trunk-Linux-Java7-64/checkout/lucene/build/test-framework/classes/java:/var/lib/jenkins/workspace/Lucene-trunk-Linux-Java7-64/checkout/lucene/build/core/classes/java:/var/lib/jenkins/workspace/Lucene-trunk-Linux-Java7-64/checkout/lucene/test-framework/lib/junit-4.10.jar:/var/lib/jenkins/workspace/Lucene-trunk-Linux-Java7-64/checkout/lucene/test-framework/lib/randomizedtesting-runner-1.6.0.jar:/var/lib/jenkins/workspace/Lucene-trunk-Linux-Java7-64/checkout/lucene/build/misc/classes/java:/var/lib/jenkins/workspace/Lucene-trunk-Linux-Java7-64/checkout/lucene/build/misc/classes/test:/var/lib/jenkins/tools/ant/supported18/lib/ant-launcher.jar:/var/lib/jenkins/.ant/lib/apache-rat-tasks-0.8.jar:/var/lib/jenkins/.ant/lib/ivy-2.2.0.jar:/var/lib/jenkins/.ant/lib/apache-rat-0.8.jar:/var/lib/jenkins/.ant/lib/apache-rat-plugin-0.8.jar:/var/lib/jenkins/.ant/lib/apache-rat-core-0.8.jar:/var/lib/jenkins/.ant/lib/clover-2.6.3.jar:/var/lib/jenkins/tools/ant/supported18/lib/ant-apache-regexp.jar:/var/lib/jenkins/tools/ant/supported18/lib/ivy-2.2.0.jar:/var/lib/jenkins/tools/ant/supported18/lib/ant-jmf.jar:/var/lib/jenkins/tools/ant/supported18/lib/ant-apache-log4j.jar:/var/lib/jenkins/tools/ant/supported18/lib/ant-jdepend.jar:/var/lib/jenkins/tools/ant/supported18/lib/ant-swing.jar:/var/lib/jenkins/tools/ant/supported18/lib/ant-antlr.jar:/var/lib/jenkins/tools/ant/supported18/lib/ant-apache-xalan2.jar:/var/lib/jenkins/tools/ant/supported18/lib/ant-apache-resolver.jar:/var/lib/jenkins/tools/ant/supported18/lib/ant-commons-logging.jar:/var/lib/jenkins/tools/ant/supported18/lib/ant-testutil.jar:/var/lib/jenkins/tools/ant/supported18/lib/ant-apache-bcel.jar:/var/lib/jenkins/tools/ant/supported18/lib/ant-jsch.jar:/var/lib/jenkins/tools/ant/supported18/lib/ant-junit.jar:/var/lib/jenkins/tools/ant/supported18/lib/ant-commons-net.jar:/var/lib/jenkins/tools/ant/supported18/lib/ant-apache-bsf.jar:/var/lib/jenkins/tools/ant/supported18/lib/ant-junit4.jar:/var/lib/jenkins/tools/ant/supported18/lib/ant-jai.jar:/var/lib/jenkins/tools/ant/supported18/lib/ant-javamail.jar:/var/lib/jenkins/tools/ant/supported18/lib/ant.jar:/var/lib/jenkins/tools/ant/supported18/lib/ant-apache-oro.jar:/var/lib/jenkins/tools/ant/supported18/lib/ant-netrexx.jar:/opt/java/64/jdk1.7.0_05/lib/tools.jar:/var/lib/jenkins/.ivy2/cache/com.carrotsearch.randomizedtesting/junit4-ant/jars/junit4-ant-1.6.0.jar\",\n      \"java.class.version\": \"51.0\",\n      \"java.endorsed.dirs\": \"/opt/java/64/jdk1.7.0_05/jre/lib/endorsed\",\n      \"java.ext.dirs\": \"/opt/java/64/jdk1.7.0_05/jre/lib/ext:/usr/java/packages/lib/ext\",\n      \"java.home\": \"/opt/java/64/jdk1.7.0_05/jre\",\n      \"java.io.tmpdir\": \"/tmp\",\n      \"java.library.path\": \"/usr/java/packages/lib/amd64:/usr/lib64:/lib64:/lib:/usr/lib\",\n      \"java.runtime.name\": \"Java(TM) SE Runtime Environment\",\n      \"java.runtime.version\": \"1.7.0_05-b05\",\n      \"java.specification.name\": \"Java Platform API Specification\",\n      \"java.specification.vendor\": \"Oracle Corporation\",\n      \"java.specification.version\": \"1.7\",\n      \"java.util.logging.config.file\": \"/dev/null\",\n      \"java.vendor\": \"Oracle Corporation\",\n      \"java.vendor.url\": \"http://java.oracle.com/\",\n      \"java.vendor.url.bug\": \"http://bugreport.sun.com/bugreport/\",\n      \"java.version\": \"1.7.0_05\",\n      \"java.vm.info\": \"mixed mode\",\n      \"java.vm.name\": \"Java HotSpot(TM) 64-Bit Server VM\",\n      \"java.vm.specification.name\": \"Java Virtual Machine Specification\",\n      \"java.vm.specification.vendor\": \"Oracle Corporation\",\n      \"java.vm.specification.version\": \"1.7\",\n      \"java.vm.vendor\": \"Oracle Corporation\",\n      \"java.vm.version\": \"23.1-b03\",\n      \"jetty.insecurerandom\": \"1\",\n      \"jetty.testMode\": \"1\",\n      \"junit4.memory.total\": \"131072000\",\n      \"junit4.processors\": \"8\",\n      \"line.separator\": \"\\n\",\n      \"lucene.version\": \"5.0-SNAPSHOT\",\n      \"os.arch\": \"amd64\",\n      \"os.name\": \"Linux\",\n      \"os.version\": \"3.2.0-26-generic\",\n      \"path.separator\": \":\",\n      \"solr.directoryFactory\": \"org.apache.solr.core.MockDirectoryFactory\",\n      \"sun.arch.data.model\": \"64\",\n      \"sun.boot.class.path\": \"/opt/java/64/jdk1.7.0_05/jre/lib/resources.jar:/opt/java/64/jdk1.7.0_05/jre/lib/rt.jar:/opt/java/64/jdk1.7.0_05/jre/lib/sunrsasign.jar:/opt/java/64/jdk1.7.0_05/jre/lib/jsse.jar:/opt/java/64/jdk1.7.0_05/jre/lib/jce.jar:/opt/java/64/jdk1.7.0_05/jre/lib/charsets.jar:/opt/java/64/jdk1.7.0_05/jre/lib/jfr.jar:/opt/java/64/jdk1.7.0_05/jre/classes\",\n      \"sun.boot.library.path\": \"/opt/java/64/jdk1.7.0_05/jre/lib/amd64\",\n      \"sun.cpu.endian\": \"little\",\n      \"sun.cpu.isalist\": \"\",\n      \"sun.io.unicode.encoding\": \"UnicodeLittle\",\n      \"sun.java.command\": \"com.carrotsearch.ant.tasks.junit4.slave.SlaveMainSafe -eventsfile /var/lib/jenkins/workspace/Lucene-trunk-Linux-Java7-64/checkout/lucene/build/misc/test/junit4-J0-1556533854f47d3df.events @/var/lib/jenkins/workspace/Lucene-trunk-Linux-Java7-64/checkout/lucene/build/misc/test/junit4-J0-1556533854f47d3df.suites -stdin\",\n      \"sun.java.launcher\": \"SUN_STANDARD\",\n      \"sun.jnu.encoding\": \"UTF-8\",\n      \"sun.management.compiler\": \"HotSpot 64-Bit Tiered Compilers\",\n      \"sun.os.patch.level\": \"unknown\",\n      \"tempDir\": \".\",\n      \"tests.asserts.gracious\": \"false\",\n      \"tests.cleanthreads\": \"perMethod\",\n      \"tests.codec\": \"random\",\n      \"tests.directory\": \"random\",\n      \"tests.infostream\": \"false\",\n      \"tests.iters\": \"\",\n      \"tests.linedocsfile\": \"/var/lib/jenkins/lucene-data/enwiki.random.lines.txt\",\n      \"tests.locale\": \"random\",\n      \"tests.lockdir\": \"/var/lib/jenkins/workspace/Lucene-trunk-Linux-Java7-64/checkout/lucene/build\",\n      \"tests.luceneMatchVersion\": \"5.0\",\n      \"tests.multiplier\": \"3\",\n      \"tests.nightly\": \"true\",\n      \"tests.postingsformat\": \"random\",\n      \"tests.prefix\": \"tests\",\n      \"tests.seed\": \"F42FFCD5FAEE14FF\",\n      \"tests.slow\": \"true\",\n      \"tests.timezone\": \"random\",\n      \"tests.verbose\": \"false\",\n      \"tests.weekly\": \"false\",\n      \"user.country\": \"US\",\n      \"user.dir\": \"/var/lib/jenkins/workspace/Lucene-trunk-Linux-Java7-64/checkout/lucene/build/misc/test/J0\",\n      \"user.home\": \"/var/lib/jenkins\",\n      \"user.language\": \"en\",\n      \"user.name\": \"jenkins\",\n      \"user.timezone\": \"\"\n    }\n  }\n]\n\n[\n  \"SUITE_STARTED\",\n  {\n    \"description\": {\n      \"id\": \"id#org.apache.lucene.index.TestMultiPassIndexSplitter[3]\",\n      \"displayName\": \"org.apache.lucene.index.TestMultiPassIndexSplitter\",\n      \"className\": \"org.apache.lucene.index.TestMultiPassIndexSplitter\",\n      \"annotations\": [\n        {\n          \"com.carrotsearch.randomizedtesting.annotations.ThreadLeaks\": {\n            \"failTestIfLeaking\": false,\n            \"stackSamples\": 10,\n            \"linger\": 0,\n            \"leakedThreadsBelongToSuite\": false\n          }\n        },\n        {\n          \"com.carrotsearch.randomizedtesting.annotations.TestMethodProviders\": {\n            \"value\": [\n              \"org.apache.lucene.util.LuceneJUnit3MethodProvider\",\n              \"com.carrotsearch.randomizedtesting.JUnit4MethodProvider\"\n            ]\n          }\n        },\n        {\n          \"org.junit.runner.RunWith\": {\n            \"value\": \"com.carrotsearch.randomizedtesting.RandomizedRunner\"\n          }\n        }\n      ],\n      \"children\": [\n        {\n          \"id\": \"id#testSplitSeq(org.apache.lucene.index.TestMultiPassIndexSplitter)[0]\",\n          \"displayName\": \"testSplitSeq(org.apache.lucene.index.TestMultiPassIndexSplitter)\",\n          \"methodName\": \"testSplitSeq\",\n          \"className\": \"org.apache.lucene.index.TestMultiPassIndexSplitter\",\n          \"annotations\": [],\n          \"children\": []\n        },\n        {\n          \"id\": \"id#testSplitRR(org.apache.lucene.index.TestMultiPassIndexSplitter)[0]\",\n          \"displayName\": \"testSplitRR(org.apache.lucene.index.TestMultiPassIndexSplitter)\",\n          \"methodName\": \"testSplitRR\",\n          \"className\": \"org.apache.lucene.index.TestMultiPassIndexSplitter\",\n          \"annotations\": [],\n          \"children\": []\n        }\n      ]\n    }\n  }\n]\n\n[\n  \"TEST_STARTED\",\n  {\n    \"description\": \"id#testSplitSeq(org.apache.lucene.index.TestMultiPassIndexSplitter)[0]\"\n  }\n]\n\n[\n  \"APPEND_STDERR\",\n  {\n    \"chunk\": \"57726974696E6720706172742031202E2E2E0A57726974696E6720706172742032202E2E2E0A57726974696E6720706172742033202E2E2E0A446F6E652E0A\"\n  }\n]\n\n[\n  \"TEST_FINISHED\",\n  {\n    \"executionTime\": 979,\n    \"startTimestamp\": 1343224614831,\n    \"description\": \"id#testSplitSeq(org.apache.lucene.index.TestMultiPassIndexSplitter)[0]\"\n  }\n]\n\n[\n  \"TEST_STARTED\",\n  {\n    \"description\": \"id#testSplitRR(org.apache.lucene.index.TestMultiPassIndexSplitter)[0]\"\n  }\n]\n\n[\n  \"APPEND_STDERR\",\n  {\n    \"chunk\": \"57726974696E6720706172742031202E2E2E0A57726974696E6720706172742032202E2E2E0A57726974696E6720706172742033202E2E2E0A446F6E652E0A\"\n  }\n]\n\n[\n  \"TEST_FINISHED\",\n  {\n    \"executionTime\": 1350,\n    \"startTimestamp\": 1343224615815,\n    \"description\": \"id#testSplitRR(org.apache.lucene.index.TestMultiPassIndexSplitter)[0]\"\n  }\n]\n\n[\n  \"SUITE_COMPLETED\",\n  {\n    \"startTimestamp\": 1343224614447,\n    \"executionTime\": 2777,\n    \"description\": \"id#org.apache.lucene.index.TestMultiPassIndexSplitter[3]\"\n  }\n]\n\n[\n  \"SUITE_STARTED\",\n  {\n    \"description\": {\n      \"id\": \"id#org.apache.lucene.index.TestBalancedSegmentMergePolicy[3]\",\n      \"displayName\": \"org.apache.lucene.index.TestBalancedSegmentMergePolicy\",\n      \"className\": \"org.apache.lucene.index.TestBalancedSegmentMergePolicy\",\n      \"annotations\": [\n        {\n          \"com.carrotsearch.randomizedtesting.annotations.ThreadLeaks\": {\n            \"failTestIfLeaking\": false,\n            \"stackSamples\": 10,\n            \"linger\": 0,\n            \"leakedThreadsBelongToSuite\": false\n          }\n        },\n        {\n          \"com.carrotsearch.randomizedtesting.annotations.TestMethodProviders\": {\n            \"value\": [\n              \"org.apache.lucene.util.LuceneJUnit3MethodProvider\",\n              \"com.carrotsearch.randomizedtesting.JUnit4MethodProvider\"\n            ]\n          }\n        },\n        {\n          \"org.junit.runner.RunWith\": {\n            \"value\": \"com.carrotsearch.randomizedtesting.RandomizedRunner\"\n          }\n        }\n      ],\n      \"children\": [\n        {\n          \"id\": \"id#testForceMerge(org.apache.lucene.index.TestBalancedSegmentMergePolicy)[0]\",\n          \"displayName\": \"testForceMerge(org.apache.lucene.index.TestBalancedSegmentMergePolicy)\",\n          \"methodName\": \"testForceMerge\",\n          \"className\": \"org.apache.lucene.index.TestBalancedSegmentMergePolicy\",\n          \"annotations\": [],\n          \"children\": []\n        }\n      ]\n    }\n  }\n]\n\n[\n  \"TEST_STARTED\",\n  {\n    \"description\": \"id#testForceMerge(org.apache.lucene.index.TestBalancedSegmentMergePolicy)[0]\"\n  }\n]\n\n\n ",
            "author": "Michael McCandless",
            "id": "comment-13424391"
        },
        {
            "date": "2012-07-28T18:03:34+0000",
            "content": "Note also users have reported actual hangs, such as http://www.lucidimagination.com/search/document/79dbebe26ad5c804\n ",
            "author": "Robert Muir",
            "id": "comment-13424396"
        },
        {
            "date": "2012-07-29T10:41:12+0000",
            "content": "This does reproduce ... I dug a bit: the test got SerialMergeScheduler, and then BSMP just kept merging the same single segment over and over.\n\nRather than debug BSMP I'm inclined to deprecate/remove it ... TieredMergePolicy should accomplish the same thing as BSMP in an NRT setting. ",
            "author": "Michael McCandless",
            "id": "comment-13424513"
        },
        {
            "date": "2012-07-29T11:04:17+0000",
            "content": "If we deprecate it we have to fix this? And then it makes no sense to deprecate it \n\nWe should remove it in 4.0 if it is as good as TieredMergePolicy! In 3.6.2 we should maybe really deprecate it and add a warning that it does not work with SerialMergeSchedulerr (or it should throw ex when started with Serial MergeScheduler) ",
            "author": "Uwe Schindler",
            "id": "comment-13424520"
        },
        {
            "date": "2012-07-29T14:27:18+0000",
            "content": "The bug is really in BalancedSegmentMergePolicy, it's just that SMS exacerbates this because it forever merges (ie an addDocument or commit will just run forever).  If you use CMS then this busy loop runs in the background...\n\nI'll remove it in 4.x/5.x and deprecate in 3.6.x. ",
            "author": "Michael McCandless",
            "id": "comment-13424557"
        }
    ]
}