{
    "id": "SOLR-10796",
    "title": "TestPointFields: increase randomized testing of non-trivial values",
    "details": {
        "labels": "",
        "priority": "Major",
        "components": [],
        "type": "Sub-task",
        "fix_versions": [
            "7.0",
            "7.1",
            "master (8.0)"
        ],
        "affect_versions": "None",
        "resolution": "Fixed",
        "status": "Closed"
    },
    "description": "A lot of TestPointFields code just uses positive nums, or only ranodmizes values between -100 and 100, etc.",
    "attachments": {
        "SOLR-10796.patch": "https://issues.apache.org/jira/secure/attachment/12876174/SOLR-10796.patch",
        "SOLR-10796-part2.patch": "https://issues.apache.org/jira/secure/attachment/12877350/SOLR-10796-part2.patch"
    },
    "issue_links": {},
    "comments": [
        {
            "date": "2017-06-09T00:29:47+0000",
            "content": "This was at least partially addressed by SOLR-10501.  Still need to verify that all field types are getting full range randomization. ",
            "author": "Steve Rowe",
            "id": "comment-16043723"
        },
        {
            "date": "2017-07-08T04:30:03+0000",
            "content": "Patch that adds randomization everywhere. This is close to done.\n\nThere is one nocommit: testFloatPointFieldRangeFacet() fails on a docValues=\"true\" field with facet.range.method=dv, but not with the default method using the exact same documents and query.  None of the other test{Double,Long,Int}PointFieldRangeFacet() tests fail in this way.  I'll investigate more next week. ",
            "author": "Steve Rowe",
            "id": "comment-16078950"
        },
        {
            "date": "2017-07-10T22:28:19+0000",
            "content": "There is one nocommit: testFloatPointFieldRangeFacet() fails on a docValues=\"true\" field with facet.range.method=dv, but not with the default method using the exact same documents and query. None of the other test{Double,Long,Int}PointFieldRangeFacet() tests fail in this way. I'll investigate more next week.\n\nI filed SOLR-11043 for this.  It's reproducible with Trie fields as well as point fields. ",
            "author": "Steve Rowe",
            "id": "comment-16081287"
        },
        {
            "date": "2017-07-10T22:30:59+0000",
            "content": "Patch with the failing test annotated with @AwaitsFix(bugUrl = \"https://issues.apache.org/jira/browse/SOLR-11043\").\n\nI'll commit this after beasting it for a while. ",
            "author": "Steve Rowe",
            "id": "comment-16081289"
        },
        {
            "date": "2017-07-10T23:48:15+0000",
            "content": "I'll commit this after beasting it for a while.\n\n10/200 iterations failed, all on the same test: testIntPointFieldRangeFacet().  I traced this to a test bug: the test miscalculates bucket counts because of int overflow in a calculation. \n\nIn the attached patch I've widened the calculation to long, and none of the 10 previously reproducing seeds reproduce any longer.\n\nCommitting shortly. ",
            "author": "Steve Rowe",
            "id": "comment-16081370"
        },
        {
            "date": "2017-07-11T00:00:16+0000",
            "content": "Commit 0511aeb5137c81cf4966f691d27b8c74bda04e20 in lucene-solr's branch refs/heads/branch_7_0 from Steve Rowe\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=0511aeb ]\n\nSOLR-10796: TestPointFields: increase randomized testing of non-trivial values ",
            "author": "ASF subversion and git services",
            "id": "comment-16081378"
        },
        {
            "date": "2017-07-11T00:00:18+0000",
            "content": "Commit 83400bd81eb911ee3623c6636f1c6e968cb0c46d in lucene-solr's branch refs/heads/branch_7x from Steve Rowe\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=83400bd ]\n\nSOLR-10796: TestPointFields: increase randomized testing of non-trivial values ",
            "author": "ASF subversion and git services",
            "id": "comment-16081379"
        },
        {
            "date": "2017-07-11T00:00:19+0000",
            "content": "Commit 5bb09e08528552c310d30fc627dc823a86aa6880 in lucene-solr's branch refs/heads/master from Steve Rowe\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=5bb09e0 ]\n\nSOLR-10796: TestPointFields: increase randomized testing of non-trivial values ",
            "author": "ASF subversion and git services",
            "id": "comment-16081380"
        },
        {
            "date": "2017-07-11T00:02:49+0000",
            "content": "Committed.\n\nI didn't backport to branch_6x, because there were conflicts in the test suite - apparently other changes in this test on 7.0+ haven't been backported. ",
            "author": "Steve Rowe",
            "id": "comment-16081387"
        },
        {
            "date": "2017-07-11T04:21:58+0000",
            "content": "That was quick... Failures on Policeman Jenkins https://jenkins.thetaphi.de/job/Lucene-Solr-master-Linux/20110/ - I'll investigate tomorrow:\n\n\n   [junit4]   2> NOTE: reproduce with: ant test  -Dtestcase=TestPointFields -Dtests.method=testDoublePointStats -Dtests.seed=CBFB848A18E90F56 -Dtests.multiplier=3 -Dtests.slow=true -Dtests.locale=en-LR -Dtests.timezone=America/Moncton -Dtests.asserts=true -Dtests.file.encoding=UTF-8\n   [junit4] ERROR   0.02s J1 | TestPointFields.testDoublePointStats <<<\n   [junit4]    > Throwable #1: java.lang.RuntimeException: Exception during query\n   [junit4]    > \tat __randomizedtesting.SeedInfo.seed([CBFB848A18E90F56:E4E14ADCEC4413F2]:0)\n   [junit4]    > \tat org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:878)\n   [junit4]    > \tat org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:845)\n   [junit4]    > \tat org.apache.solr.schema.TestPointFields.testPointStats(TestPointFields.java:2197)\n   [junit4]    > \tat org.apache.solr.schema.TestPointFields.testDoublePointStats(TestPointFields.java:689)\n   [junit4]    > \tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n   [junit4]    > \tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n   [junit4]    > \tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n   [junit4]    > \tat java.base/java.lang.reflect.Method.invoke(Method.java:564)\n   [junit4]    > \tat java.base/java.lang.Thread.run(Thread.java:844)\n   [junit4]    > Caused by: java.lang.RuntimeException: REQUEST FAILED: xpath=//*[@numFound='11']\n   [junit4]    > \txml response was: <?xml version=\"1.0\" encoding=\"UTF-8\"?>\n   [junit4]    > <response>\n   [junit4]    > <lst name=\"responseHeader\"><int name=\"status\">0</int><int name=\"QTime\">0</int></lst><result name=\"response\" numFound=\"31\" start=\"0\"><doc><str name=\"id\">0</str><double name=\"number_p_d_dv\">-7974577.0</double></doc><doc><str name=\"id\">1</str><double name=\"number_p_d_dv\">6774331.0</double></doc><doc><str name=\"id\">2</str><double name=\"number_p_d_dv\">22.1992</double></doc><doc><str name=\"id\">3</str><double name=\"number_p_d_dv\">-6.96236</double></doc><doc><str name=\"id\">4</str><double name=\"number_p_d_dv\">171.406</double></doc><doc><str name=\"id\">5</str><double name=\"number_p_d_dv\">0.812382</double></doc><doc><str name=\"id\">6</str><double name=\"number_p_d_dv\">-470.8613</double></doc><doc><str name=\"id\">7</str><double name=\"number_p_d_dv\">-0.784826</double></doc><doc><str name=\"id\">8</str><double name=\"number_p_d_dv\">-15.3976</double></doc><doc><str name=\"id\">9</str><double name=\"number_p_d_dv\">-64376.88</double></doc></result><lst name=\"stats\"><lst name=\"stats_fields\"><lst name=\"number_p_d_dv\"><double name=\"min\">-9715025.0</double><double name=\"max\">6774331.0</double><long name=\"count\">30</long><long name=\"missing\">1</long><double name=\"sum\">-1.1905904570462001E7</double><double name=\"sumOfSquares\">3.138795364109037E14</double><double name=\"mean\">-396863.4856820667</double><double name=\"stddev\">3265042.2061108556</double></lst></lst></lst>\n   [junit4]    > </response>\n   [junit4]    > \trequest was:q=*:*&stats=true&fl=id,+number_p_d_dv&wt=xml&stats.field=number_p_d_dv\n   [junit4]    > \tat org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:871)\n\n\n\n\n   [junit4]   2> NOTE: reproduce with: ant test  -Dtestcase=TestPointFields -Dtests.method=testIntPointStats -Dtests.seed=CBFB848A18E90F56 -Dtests.multiplier=3 -Dtests.slow=true -Dtests.locale=en-LR -Dtests.timezone=America/Moncton -Dtests.asserts=true -Dtests.file.encoding=UTF-8\n   [junit4] ERROR   0.02s J1 | TestPointFields.testIntPointStats <<<\n   [junit4]    > Throwable #1: java.lang.RuntimeException: Exception during query\n   [junit4]    > \tat __randomizedtesting.SeedInfo.seed([CBFB848A18E90F56:A07E7D81864F118F]:0)\n   [junit4]    > \tat org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:878)\n   [junit4]    > \tat org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:845)\n   [junit4]    > \tat org.apache.solr.schema.TestPointFields.testPointStats(TestPointFields.java:2197)\n   [junit4]    > \tat org.apache.solr.schema.TestPointFields.testIntPointStats(TestPointFields.java:278)\n   [junit4]    > \tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n   [junit4]    > \tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n   [junit4]    > \tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n   [junit4]    > \tat java.base/java.lang.reflect.Method.invoke(Method.java:564)\n   [junit4]    > \tat java.base/java.lang.Thread.run(Thread.java:844)\n   [junit4]    > Caused by: java.lang.RuntimeException: REQUEST FAILED: xpath=//*[@numFound='11']\n   [junit4]    > \txml response was: <?xml version=\"1.0\" encoding=\"UTF-8\"?>\n   [junit4]    > <response>\n   [junit4]    > <lst name=\"responseHeader\"><int name=\"status\">0</int><int name=\"QTime\">0</int></lst><result name=\"response\" numFound=\"31\" start=\"0\"><doc><str name=\"id\">0</str><int name=\"number_p_i_dv\">-3921387</int></doc><doc><str name=\"id\">1</str><int name=\"number_p_i_dv\">393540</int></doc><doc><str name=\"id\">2</str><int name=\"number_p_i_dv\">-2255296</int></doc><doc><str name=\"id\">3</str><int name=\"number_p_i_dv\">6049329</int></doc><doc><str name=\"id\">4</str><int name=\"number_p_i_dv\">-3534779</int></doc><doc><str name=\"id\">5</str><int name=\"number_p_i_dv\">-9527262</int></doc><doc><str name=\"id\">6</str><int name=\"number_p_i_dv\">9250948</int></doc><doc><str name=\"id\">7</str><int name=\"number_p_i_dv\">5178097</int></doc><doc><str name=\"id\">8</str><int name=\"number_p_i_dv\">-2047962</int></doc><doc><str name=\"id\">9</str><int name=\"number_p_i_dv\">8566785</int></doc></result><lst name=\"stats\"><lst name=\"stats_fields\"><lst name=\"number_p_i_dv\"><double name=\"min\">-9527262.0</double><double name=\"max\">9250948.0</double><long name=\"count\">30</long><long name=\"missing\">1</long><double name=\"sum\">5505165.0</double><double name=\"sumOfSquares\">9.98913400825957E14</double><double name=\"mean\">183505.5</double><double name=\"stddev\">5866042.467750296</double></lst></lst></lst>\n   [junit4]    > </response>\n   [junit4]    > \trequest was:q=*:*&stats=true&fl=id,+number_p_i_dv&wt=xml&stats.field=number_p_i_dv\n   [junit4]    > \tat org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:871)\n\n\n\n\n   [junit4]   2> NOTE: reproduce with: ant test  -Dtestcase=TestPointFields -Dtests.method=testFloatPointStats -Dtests.seed=CBFB848A18E90F56 -Dtests.multiplier=3 -Dtests.slow=true -Dtests.locale=en-LR -Dtests.timezone=America/Moncton -Dtests.asserts=true -Dtests.file.encoding=UTF-8\n   [junit4] ERROR   0.01s J1 | TestPointFields.testFloatPointStats <<<\n   [junit4]    > Throwable #1: java.lang.RuntimeException: Exception during query\n   [junit4]    > \tat __randomizedtesting.SeedInfo.seed([CBFB848A18E90F56:71F1FCADA0F8CDB4]:0)\n   [junit4]    > \tat org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:878)\n   [junit4]    > \tat org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:845)\n   [junit4]    > \tat org.apache.solr.schema.TestPointFields.testPointStats(TestPointFields.java:2197)\n   [junit4]    > \tat org.apache.solr.schema.TestPointFields.testFloatPointStats(TestPointFields.java:989)\n   [junit4]    > \tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n   [junit4]    > \tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n   [junit4]    > \tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n   [junit4]    > \tat java.base/java.lang.reflect.Method.invoke(Method.java:564)\n   [junit4]    > \tat java.base/java.lang.Thread.run(Thread.java:844)\n   [junit4]    > Caused by: java.lang.RuntimeException: REQUEST FAILED: xpath=//*[@numFound='11']\n   [junit4]    > \txml response was: <?xml version=\"1.0\" encoding=\"UTF-8\"?>\n   [junit4]    > <response>\n   [junit4]    > <lst name=\"responseHeader\"><int name=\"status\">0</int><int name=\"QTime\">0</int></lst><result name=\"response\" numFound=\"31\" start=\"0\"><doc><str name=\"id\">0</str><float name=\"number_p_f_dv\">-59769.92</float></doc><doc><str name=\"id\">1</str><float name=\"number_p_f_dv\">0.9821898</float></doc><doc><str name=\"id\">2</str><float name=\"number_p_f_dv\">-0.0470837</float></doc><doc><str name=\"id\">3</str><float name=\"number_p_f_dv\">-385.6739</float></doc><doc><str name=\"id\">4</str><float name=\"number_p_f_dv\">0.9368263</float></doc><doc><str name=\"id\">5</str><float name=\"number_p_f_dv\">744.6789</float></doc><doc><str name=\"id\">6</str><float name=\"number_p_f_dv\">-30.54257</float></doc><doc><str name=\"id\">7</str><float name=\"number_p_f_dv\">7323450.0</float></doc><doc><str name=\"id\">8</str><float name=\"number_p_f_dv\">122800.0</float></doc><doc><str name=\"id\">9</str><float name=\"number_p_f_dv\">515664.1</float></doc></result><lst name=\"stats\"><lst name=\"stats_fields\"><lst name=\"number_p_f_dv\"><double name=\"min\">-2785962.0</double><double name=\"max\">7323450.0</double><long name=\"count\">30</long><long name=\"missing\">1</long><double name=\"sum\">5050253.209396519</double><double name=\"sumOfSquares\">6.2304910711722305E13</double><double name=\"mean\">168341.77364655063</double><double name=\"stddev\">1455722.8578730498</double></lst></lst></lst>\n   [junit4]    > </response>\n   [junit4]    > \trequest was:q=*:*&stats=true&fl=id,+number_p_f_dv&wt=xml&stats.field=number_p_f_dv\n   [junit4]    > \tat org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:871)\n\n\n\n\n   [junit4]   2> NOTE: reproduce with: ant test  -Dtestcase=TestPointFields -Dtests.method=testLongPointStats -Dtests.seed=CBFB848A18E90F56 -Dtests.multiplier=3 -Dtests.slow=true -Dtests.locale=en-LR -Dtests.timezone=America/Moncton -Dtests.asserts=true -Dtests.file.encoding=UTF-8\n   [junit4] ERROR   0.01s J1 | TestPointFields.testLongPointStats <<<\n   [junit4]    > Throwable #1: java.lang.RuntimeException: Exception during query\n   [junit4]    > \tat __randomizedtesting.SeedInfo.seed([CBFB848A18E90F56:7C06125F33BCFB33]:0)\n   [junit4]    > \tat org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:878)\n   [junit4]    > \tat org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:845)\n   [junit4]    > \tat org.apache.solr.schema.TestPointFields.testPointStats(TestPointFields.java:2197)\n   [junit4]    > \tat org.apache.solr.schema.TestPointFields.testLongPointStats(TestPointFields.java:1251)\n   [junit4]    > \tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n   [junit4]    > \tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n   [junit4]    > \tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n   [junit4]    > \tat java.base/java.lang.reflect.Method.invoke(Method.java:564)\n   [junit4]    > \tat java.base/java.lang.Thread.run(Thread.java:844)\n   [junit4]    > Caused by: java.lang.RuntimeException: REQUEST FAILED: xpath=//*[@numFound='11']\n   [junit4]    > \txml response was: <?xml version=\"1.0\" encoding=\"UTF-8\"?>\n   [junit4]    > <response>\n   [junit4]    > <lst name=\"responseHeader\"><int name=\"status\">0</int><int name=\"QTime\">0</int></lst><result name=\"response\" numFound=\"31\" start=\"0\"><doc><str name=\"id\">0</str><long name=\"number_p_l_dv\">-796143</long></doc><doc><str name=\"id\">1</str><long name=\"number_p_l_dv\">-4966593</long></doc><doc><str name=\"id\">2</str><long name=\"number_p_l_dv\">-2917497</long></doc><doc><str name=\"id\">3</str><long name=\"number_p_l_dv\">4677958</long></doc><doc><str name=\"id\">4</str><long name=\"number_p_l_dv\">1053568</long></doc><doc><str name=\"id\">5</str><long name=\"number_p_l_dv\">-5881926</long></doc><doc><str name=\"id\">6</str><long name=\"number_p_l_dv\">-6950672</long></doc><doc><str name=\"id\">7</str><long name=\"number_p_l_dv\">-8105782</long></doc><doc><str name=\"id\">8</str><long name=\"number_p_l_dv\">9120754</long></doc><doc><str name=\"id\">9</str><long name=\"number_p_l_dv\">-5490091</long></doc></result><lst name=\"stats\"><lst name=\"stats_fields\"><lst name=\"number_p_l_dv\"><double name=\"min\">-9197708.0</double><double name=\"max\">9783145.0</double><long name=\"count\">30</long><long name=\"missing\">1</long><double name=\"sum\">-2.1684491E7</double><double name=\"sumOfSquares\">8.30670534168123E14</double><double name=\"mean\">-722816.3666666667</double><double name=\"stddev\">5301257.5904554585</double></lst></lst></lst>\n   [junit4]    > </response>\n   [junit4]    > \trequest was:q=*:*&stats=true&fl=id,+number_p_l_dv&wt=xml&stats.field=number_p_l_dv\n   [junit4]    > \tat org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:871)\n\n\n ",
            "author": "Steve Rowe",
            "id": "comment-16081632"
        },
        {
            "date": "2017-07-11T14:49:00+0000",
            "content": "Commit 4391b14b637253aa5c69c1f9a3358c15830bbee2 in lucene-solr's branch refs/heads/branch_7_0 from Steve Rowe\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=4391b14 ]\n\nSOLR-10796: fix failing stats tests by starting with an empty index. ",
            "author": "ASF subversion and git services",
            "id": "comment-16082313"
        },
        {
            "date": "2017-07-11T14:49:01+0000",
            "content": "Commit 9af2f78d4c5bf57f6a1721350bb412fa15185b9a in lucene-solr's branch refs/heads/branch_7x from Steve Rowe\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=9af2f78 ]\n\nSOLR-10796: fix failing stats tests by starting with an empty index. ",
            "author": "ASF subversion and git services",
            "id": "comment-16082314"
        },
        {
            "date": "2017-07-11T14:49:26+0000",
            "content": "Commit 5dbcb28acca4a795b04a9a3ea1e6497b58e10114 in lucene-solr's branch refs/heads/master from Steve Rowe\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=5dbcb28 ]\n\nSOLR-10796: fix failing stats tests by starting with an empty index. ",
            "author": "ASF subversion and git services",
            "id": "comment-16082316"
        },
        {
            "date": "2017-07-11T19:02:41+0000",
            "content": "Commit 87828591154a82e56f4b33735ac0e1f0041fb362 in lucene-solr's branch refs/heads/branch_7_0 from Steve Rowe\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=8782859 ]\n\nSOLR-10796: try again to fix failing stats tests: fix hard-coded assertions to depend on doc count where it's affected by the random multiplier. ",
            "author": "ASF subversion and git services",
            "id": "comment-16082778"
        },
        {
            "date": "2017-07-11T19:02:43+0000",
            "content": "Commit 37bdd54f570586410c75235eac558f89c03f0ee1 in lucene-solr's branch refs/heads/branch_7x from Steve Rowe\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=37bdd54 ]\n\nSOLR-10796: try again to fix failing stats tests: fix hard-coded assertions to depend on doc count where it's affected by the random multiplier. ",
            "author": "ASF subversion and git services",
            "id": "comment-16082779"
        },
        {
            "date": "2017-07-11T19:02:57+0000",
            "content": "Commit 8a3ca50c1a11aabcdd17ccdf634028bff76d8f2a in lucene-solr's branch refs/heads/master from Steve Rowe\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=8a3ca50 ]\n\nSOLR-10796: try again to fix failing stats tests: fix hard-coded assertions to depend on doc count where it's affected by the random multiplier. ",
            "author": "ASF subversion and git services",
            "id": "comment-16082781"
        },
        {
            "date": "2017-07-11T23:16:32+0000",
            "content": "A reproducing branch_7_0 failure, from http://jenkins.sarowe.net/job/Lucene-Solr-tests-7.0/22/ - I'm investigating:\n\n\n   [junit4]   2> NOTE: reproduce with: ant test  -Dtestcase=TestPointFields -Dtests.method=testLongPointFieldRangeFacet -Dtests.seed=A3AB56679F64D76 -Dtests.slow=true -Dtests.locale=id-ID -Dtests.timezone=Europe/Paris -Dtests.asserts=true -Dtests.file.encoding=ISO-8859-1\n   [junit4] ERROR   0.09s J6  | TestPointFields.testLongPointFieldRangeFacet <<<\n   [junit4]    > Throwable #1: java.lang.RuntimeException: Exception during query\n   [junit4]    > \tat __randomizedtesting.SeedInfo.seed([A3AB56679F64D76:EB5AA9B848F84E66]:0)\n   [junit4]    > \tat org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:878)\n   [junit4]    > \tat org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:845)\n   [junit4]    > \tat org.apache.solr.schema.TestPointFields.testLongPointFieldRangeFacet(TestPointFields.java:1217)\n   [junit4]    > \tat java.lang.Thread.run(Thread.java:745)\n   [junit4]    > Caused by: java.lang.RuntimeException: REQUEST FAILED: xpath=//lst[@name='facet_counts']/lst[@name='facet_ranges']/lst[@name='number_p_l_dv']/lst[@name='counts']/int[@name='-894046239074522863'][.='4']\n   [junit4]    > \txml response was: <?xml version=\"1.0\" encoding=\"UTF-8\"?>\n   [junit4]    > <response>\n   [junit4]    > <lst name=\"responseHeader\"><int name=\"status\">0</int><int name=\"QTime\">0</int></lst><result name=\"response\" numFound=\"10\" start=\"0\"><doc><str name=\"id\">0</str><long name=\"number_p_l_dv\">1586386398396807928</long><long name=\"number_p_l\">1586386398396807928</long><long name=\"_version_\">1572667407280898048</long></doc><doc><str name=\"id\">1</str><long name=\"number_p_l_dv\">8388164214690932920</long><long name=\"number_p_l\">8388164214690932920</long><long name=\"_version_\">1572667407282995200</long></doc><doc><str name=\"id\">2</str><long name=\"number_p_l_dv\">345919010516441979</long><long name=\"number_p_l\">345919010516441979</long><long name=\"_version_\">1572667407282995201</long></doc><doc><str name=\"id\">3</str><long name=\"number_p_l_dv\">-6612528902354323499</long><long name=\"number_p_l\">-6612528902354323499</long><long name=\"_version_\">1572667407282995202</long></doc><doc><str name=\"id\">4</str><long name=\"number_p_l_dv\">-4613459503085754991</long><long name=\"number_p_l\">-4613459503085754991</long><long name=\"_version_\">1572667407284043776</long></doc><doc><str name=\"id\">5</str><long name=\"number_p_l_dv\">-4144127791340196059</long><long name=\"number_p_l\">-4144127791340196059</long><long name=\"_version_\">1572667407284043777</long></doc><doc><str name=\"id\">6</str><long name=\"number_p_l_dv\">-1192431832086875895</long><long name=\"number_p_l\">-1192431832086875895</long><long name=\"_version_\">1572667407284043778</long></doc><doc><str name=\"id\">7</str><long name=\"number_p_l_dv\">-6179315529630012256</long><long name=\"number_p_l\">-6179315529630012256</long><long name=\"_version_\">1572667407284043779</long></doc><doc><str name=\"id\">8</str><long name=\"number_p_l_dv\">-7082186541584826723</long><long name=\"number_p_l\">-7082186541584826723</long><long name=\"_version_\">1572667407285092352</long></doc><doc><str name=\"id\">9</str><long name=\"number_p_l_dv\">1815644870476716143</long><long name=\"number_p_l\">1815644870476716143</long><long name=\"_version_\">1572667407285092353</long></doc></result><lst name=\"facet_counts\"><lst name=\"facet_queries\"/><lst name=\"facet_fields\"/><lst name=\"facet_ranges\"><lst name=\"number_p_l_dv\"><lst name=\"counts\"><int name=\"-7082186541584826723\">5</int><int name=\"-3988116390329674793\">1</int><int name=\"-894046239074522863\">3</int><int name=\"2200023912180629067\">0</int><int name=\"5294094063435780997\">1</int></lst><long name=\"gap\">3094070151255151930</long><long name=\"start\">-7082186541584826723</long><long name=\"end\">8388164214690932927</long></lst></lst><lst name=\"facet_intervals\"/><lst name=\"facet_heatmaps\"/></lst>\n   [junit4]    > </response>\n   [junit4]    > \trequest was:facet.range=number_p_l_dv&q=*:*&facet.range.gap=3094070151255151930&facet=true&wt=xml&facet.range.start=-7082186541584826723&facet.range.end=8388164214690932920\n   [junit4]    > \tat org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:871)\n\n ",
            "author": "Steve Rowe",
            "id": "comment-16083159"
        },
        {
            "date": "2017-07-12T15:56:40+0000",
            "content": "Commit 821caefe12e8ecde7434f94d517c239121d5768d in lucene-solr's branch refs/heads/branch_7_0 from Steve Rowe\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=821caef ]\n\nSOLR-10796: fix long overflow in testLongPointFieldRangeFacet() ",
            "author": "ASF subversion and git services",
            "id": "comment-16084212"
        },
        {
            "date": "2017-07-12T15:56:42+0000",
            "content": "Commit 79515eda6c01cf0591b4cf8ed42a34f7465f934a in lucene-solr's branch refs/heads/branch_7x from Steve Rowe\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=79515ed ]\n\nSOLR-10796: fix long overflow in testLongPointFieldRangeFacet() ",
            "author": "ASF subversion and git services",
            "id": "comment-16084213"
        },
        {
            "date": "2017-07-12T15:56:43+0000",
            "content": "Commit 6188c8ce389d187e49453668bc194074cac72842 in lucene-solr's branch refs/heads/master from Steve Rowe\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=6188c8c ]\n\nSOLR-10796: fix long overflow in testLongPointFieldRangeFacet() ",
            "author": "ASF subversion and git services",
            "id": "comment-16084214"
        },
        {
            "date": "2017-07-12T15:59:42+0000",
            "content": "Commit 833b4278aca4f56af885c4f0cd03d5a8fc140279 in lucene-solr's branch refs/heads/branch_7_0 from Steve Rowe\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=833b427 ]\n\nSOLR-10796: comment out debug printing ",
            "author": "ASF subversion and git services",
            "id": "comment-16084217"
        },
        {
            "date": "2017-07-12T15:59:44+0000",
            "content": "Commit 9b9eb2c289488aa8807d613fe421e15cc53ad39a in lucene-solr's branch refs/heads/branch_7x from Steve Rowe\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=9b9eb2c ]\n\nSOLR-10796: comment out debug printing ",
            "author": "ASF subversion and git services",
            "id": "comment-16084218"
        },
        {
            "date": "2017-07-12T15:59:45+0000",
            "content": "Commit 00b5930cc9066ec14cc16aa665f01dc0996e9f1f in lucene-solr's branch refs/heads/master from Steve Rowe\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=00b5930 ]\n\nSOLR-10796: comment out debug printing ",
            "author": "ASF subversion and git services",
            "id": "comment-16084219"
        },
        {
            "date": "2017-07-14T17:52:09+0000",
            "content": "I realized when I was fixing the latest test bug that there were quite a few methods that I could have randomized but didn't.  This patch adds randomization to those methods, and also includes some miscellaneous cleanup elsewhere in TestPointFields.\n\nCommitting shortly. ",
            "author": "Steve Rowe",
            "id": "comment-16087683"
        },
        {
            "date": "2017-07-14T17:55:18+0000",
            "content": "Commit 94ba07759f5adce7fc242dde521d62c539d0a613 in lucene-solr's branch refs/heads/branch_7_0 from Steve Rowe\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=94ba077 ]\n\nSOLR-10796: TestPointFields: increase randomized testing of non-trivial values (part 2) ",
            "author": "ASF subversion and git services",
            "id": "comment-16087690"
        },
        {
            "date": "2017-07-14T17:55:19+0000",
            "content": "Commit 824cbdfc9ea58eab94f15dfd9e6faa017bdb5e1c in lucene-solr's branch refs/heads/branch_7x from Steve Rowe\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=824cbdf ]\n\nSOLR-10796: TestPointFields: increase randomized testing of non-trivial values (part 2) ",
            "author": "ASF subversion and git services",
            "id": "comment-16087691"
        },
        {
            "date": "2017-07-14T17:55:21+0000",
            "content": "Commit 82515fd329ce02cee68ea533e7d4bfb022b2fb00 in lucene-solr's branch refs/heads/master from Steve Rowe\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=82515fd ]\n\nSOLR-10796: TestPointFields: increase randomized testing of non-trivial values (part 2) ",
            "author": "ASF subversion and git services",
            "id": "comment-16087692"
        },
        {
            "date": "2017-07-14T20:40:55+0000",
            "content": "Commit 034549789ebf84dc1b5bd89ae160c3a94c4c9ef6 in lucene-solr's branch refs/heads/branch_7_0 from Steve Rowe\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=0345497 ]\n\nSOLR-10796: fix test bugs when RANDOM_MULTIPLIER > 1 ",
            "author": "ASF subversion and git services",
            "id": "comment-16088024"
        },
        {
            "date": "2017-07-14T20:40:57+0000",
            "content": "Commit 001e7383d17ac16de140fcfa4bdd637a61094c8c in lucene-solr's branch refs/heads/branch_7x from Steve Rowe\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=001e738 ]\n\nSOLR-10796: fix test bugs when RANDOM_MULTIPLIER > 1 ",
            "author": "ASF subversion and git services",
            "id": "comment-16088025"
        },
        {
            "date": "2017-07-14T20:40:59+0000",
            "content": "Commit 4cb74a50ef8a3386a436e69da6f9cd80fe4d746d in lucene-solr's branch refs/heads/master from Steve Rowe\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=4cb74a5 ]\n\nSOLR-10796: fix test bugs when RANDOM_MULTIPLIER > 1 ",
            "author": "ASF subversion and git services",
            "id": "comment-16088026"
        },
        {
            "date": "2017-08-04T23:19:49+0000",
            "content": "My Jenkins found a reproducing seed for a failure in one of the beefed up tests - I'll investigate:\n\n\nChecking out Revision d09d8bcaa9cc7e1f58646028f4389e11958dd93f (refs/remotes/origin/branch_7x)\n[...]\n   [junit4]   2> NOTE: reproduce with: ant test  -Dtestcase=TestPointFields -Dtests.method=testDoublePointFieldRangeFacet -Dtests.seed=3F61066AF1671866 -Dtests.slow=true -Dtests.locale=es-SV -Dtests.timezone=America/Cambridge_Bay -Dtests.asserts=true -Dtests.file.encoding=UTF-8\n   [junit4] ERROR   0.01s J4  | TestPointFields.testDoublePointFieldRangeFacet <<<\n   [junit4]    > Throwable #1: java.lang.NumberFormatException\n   [junit4]    > \tat __randomizedtesting.SeedInfo.seed([3F61066AF1671866:603562685C3CEB8D]:0)\n   [junit4]    > \tat java.math.BigDecimal.<init>(BigDecimal.java:494)\n   [junit4]    > \tat java.math.BigDecimal.<init>(BigDecimal.java:383)\n   [junit4]    > \tat java.math.BigDecimal.<init>(BigDecimal.java:806)\n   [junit4]    > \tat java.math.BigDecimal.valueOf(BigDecimal.java:1274)\n   [junit4]    > \tat org.apache.solr.schema.TestPointFields.testDoublePointFieldRangeFacet(TestPointFields.java:618)\n   [junit4]    > \tat java.lang.Thread.run(Thread.java:745)\n[...]\n   [junit4]   2> NOTE: test params are: codec=Asserting(Lucene70): {id=PostingsFormat(name=Memory)}, docValues:{foo_p_f_ni_dv_ns=DocValuesFormat(name=Lucene70), foo_p_f_ni_dv_ns_mv=DocValuesFormat(name=Lucene70), number_p_dt_dv_ns=DocValuesFormat(name=Direct), foo_p_d_ni_dv_ns_mv=DocValuesFormat(name=Asserting), foo_p_i_ni_dv_ns=DocValuesFormat(name=Direct), number_p_f_ni_mv_dv_smf=DocValuesFormat(name=Asserting), number_p_dt_ni_mv_dv_sml=DocValuesFormat(name=Lucene70), number_p_i_dv_ns=DocValuesFormat(name=Lucene70), number_p_l_ni_dv=DocValuesFormat(name=Memory), number_p_f_dv=DocValuesFormat(name=Direct), number_p_l_dv_ns=DocValuesFormat(name=Memory), foo_p_l_ni_dv_ns=DocValuesFormat(name=Lucene70), number_p_dt_ni_mv_dv=DocValuesFormat(name=Memory), number_p_l_dv_sml=DocValuesFormat(name=Asserting), number_p_i_dv_smf=DocValuesFormat(name=Memory), number_p_d_ni_ns_dv=DocValuesFormat(name=Direct), number_p_dt_ni_dv_ns_mv=DocValuesFormat(name=Direct), number_p_i_ni_dv_ns_mv=DocValuesFormat(name=Asserting), number_p_f_dv_smf=DocValuesFormat(name=Lucene70), number_p_l_ni_dv_ns=DocValuesFormat(name=Memory), number_p_l_dv_smf=DocValuesFormat(name=Lucene70), number_p_d_ni_mv_dv_sml=DocValuesFormat(name=Lucene70), number_p_f_ni_dv_ns_mv=DocValuesFormat(name=Direct), number_p_d_dv_smf=DocValuesFormat(name=Lucene70), number_p_f_ni_mv_dv_sml=DocValuesFormat(name=Lucene70), number_p_d_ni_mv_dv_smf=DocValuesFormat(name=Asserting), number_p_dt_ni_dv=DocValuesFormat(name=Direct), number_p_f_dv_ns_mv=DocValuesFormat(name=Direct), number_p_l_dv_ns_mv=DocValuesFormat(name=Memory), number_p_dt_mv_dv_sml=DocValuesFormat(name=Lucene70), number_p_l_ni_ns_dv=DocValuesFormat(name=Direct), number_p_i_ni_dv_ns=DocValuesFormat(name=Asserting), number_p_i_dv_sml=DocValuesFormat(name=Direct), number_p_f_ni_ns_dv=DocValuesFormat(name=Memory), foo_p_d_ni_dv_ns=DocValuesFormat(name=Asserting), number_p_dt_dv_sml=DocValuesFormat(name=Lucene70), number_p_dt_dv_smf=DocValuesFormat(name=Asserting), number_p_i_mv_dv=DocValuesFormat(name=Asserting), number_p_l_ni_dv_ns_mv=DocValuesFormat(name=Memory), number_p_d_ni_dv=DocValuesFormat(name=Memory), number_p_dt_ni_dv_sml=DocValuesFormat(name=Asserting), number_p_d_mv_dv_smf=DocValuesFormat(name=Asserting), number_p_d_ni_dv_smf=DocValuesFormat(name=Asserting), number_p_dt_ni_dv_smf=DocValuesFormat(name=Lucene70), foo_p_l_ni_dv_ns_mv=DocValuesFormat(name=Lucene70), number_p_d_mv_dv_sml=DocValuesFormat(name=Lucene70), number_p_dt_ni_ns_dv=DocValuesFormat(name=Memory), number_p_dt_mv_dv_smf=DocValuesFormat(name=Asserting), foo_p_i_ni_dv_ns_mv=DocValuesFormat(name=Direct), number_p_l_mv_dv=DocValuesFormat(name=Direct), number_p_d_ni_dv_sml=DocValuesFormat(name=Lucene70), number_p_i_ni_mv_dv=DocValuesFormat(name=Lucene70), number_p_f_mv_dv=DocValuesFormat(name=Memory), number_p_f_ni_mv_dv=DocValuesFormat(name=Memory), number_p_i_mv_dv_smf=DocValuesFormat(name=Memory), foo_p_dt_ni_dv_ns_mv=DocValuesFormat(name=Asserting), number_p_l_ni_mv_dv=DocValuesFormat(name=Direct), number_p_l_ni_dv_sml=DocValuesFormat(name=Asserting), number_p_d_dv=DocValuesFormat(name=Memory), number_p_i_ni_mv_dv_smf=DocValuesFormat(name=Direct), number_p_d_dv_ns=DocValuesFormat(name=Memory), number_p_l_ni_dv_smf=DocValuesFormat(name=Lucene70), number_p_i_ni_mv_dv_sml=DocValuesFormat(name=Memory), number_p_dt_dv_ns_mv=DocValuesFormat(name=Direct), number_p_l_dv=DocValuesFormat(name=Memory), number_p_dt_mv_dv=DocValuesFormat(name=Memory), number_p_l_mv_dv_smf=DocValuesFormat(name=Lucene70), number_p_d_ni_dv_ns=DocValuesFormat(name=Memory), number_p_i_dv_ns_mv=DocValuesFormat(name=Lucene70), number_p_d_ni_dv_ns_mv=DocValuesFormat(name=Memory), number_p_i_ni_dv_sml=DocValuesFormat(name=Memory), number_p_i_ni_dv_smf=DocValuesFormat(name=Direct), number_p_l_mv_dv_sml=DocValuesFormat(name=Asserting), number_p_f_dv_sml=DocValuesFormat(name=Asserting), number_p_d_dv_sml=DocValuesFormat(name=Asserting), number_p_i_ni_ns_dv=DocValuesFormat(name=Lucene70), number_p_f_ni_dv_ns=DocValuesFormat(name=Direct), number_p_f_ni_dv=DocValuesFormat(name=Direct), foo_p_dt_ni_dv_ns=DocValuesFormat(name=Lucene70), number_p_l_ni_mv_dv_smf=DocValuesFormat(name=Asserting), number_p_dt_dv=DocValuesFormat(name=Direct), number_p_dt_ni_mv_dv_smf=DocValuesFormat(name=Asserting), number_p_l_ni_mv_dv_sml=DocValuesFormat(name=Lucene70), number_p_f_ni_dv_sml=DocValuesFormat(name=Asserting), number_p_d_ni_mv_dv=DocValuesFormat(name=Direct), number_p_d_dv_ns_mv=DocValuesFormat(name=Memory), number_p_d_mv_dv=DocValuesFormat(name=Direct), number_p_i_dv=DocValuesFormat(name=Asserting), number_p_f_mv_dv_sml=DocValuesFormat(name=Asserting), number_p_i_mv_dv_sml=DocValuesFormat(name=Direct), number_p_f_ni_dv_smf=DocValuesFormat(name=Lucene70), number_p_dt_ni_dv_ns=DocValuesFormat(name=Direct), number_p_f_mv_dv_smf=DocValuesFormat(name=Lucene70), number_p_i_ni_dv=DocValuesFormat(name=Lucene70), number_p_f_dv_ns=DocValuesFormat(name=Direct)}, maxPointsInLeafNode=64, maxMBSortInHeap=6.795554133146786, sim=RandomSimilarity(queryNorm=false): {}, locale=es-SV, timezone=America/Cambridge_Bay\n   [junit4]   2> NOTE: Linux 4.1.0-custom2-amd64 amd64/Oracle Corporation 1.8.0_77 (64-bit)/cpus=16,threads=1,free=22495096,total=534773760\n\n ",
            "author": "Steve Rowe",
            "id": "comment-16115083"
        },
        {
            "date": "2017-08-05T14:59:44+0000",
            "content": "Commit ec99019b3660cacdb10bb8f81923ad4111f99d7e in lucene-solr's branch refs/heads/branch_7_0 from Steve Rowe\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=ec99019 ]\n\nSOLR-10796: TestPointFields.testDoublePointFieldRangeFacet(): Guard against converting a double-valued '-Infinity' to BigDecimal ",
            "author": "ASF subversion and git services",
            "id": "comment-16115421"
        },
        {
            "date": "2017-08-05T14:59:47+0000",
            "content": "Commit 23541b75c1a2452a94c1e26be76cc295470e4462 in lucene-solr's branch refs/heads/branch_7x from Steve Rowe\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=23541b7 ]\n\nSOLR-10796: TestPointFields.testDoublePointFieldRangeFacet(): Guard against converting a double-valued '-Infinity' to BigDecimal ",
            "author": "ASF subversion and git services",
            "id": "comment-16115422"
        },
        {
            "date": "2017-08-05T14:59:49+0000",
            "content": "Commit cff5e985835759b4fcb64629ddca817fa6e17944 in lucene-solr's branch refs/heads/master from Steve Rowe\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=cff5e98 ]\n\nSOLR-10796: TestPointFields.testDoublePointFieldRangeFacet(): Guard against converting a double-valued '-Infinity' to BigDecimal ",
            "author": "ASF subversion and git services",
            "id": "comment-16115423"
        },
        {
            "date": "2017-08-07T05:00:36+0000",
            "content": "Commit 1bdcae44fc77abf0311abe2ac0853e4a30b172dc in lucene-solr's branch refs/heads/branch_7_0 from Steve Rowe\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=1bdcae4 ]\n\nSOLR-10796: TestPointFields.testDoublePointFieldRangeFacet(): Guard against converting a double-valued '-Infinity' to BigDecimal (fix location #2) ",
            "author": "ASF subversion and git services",
            "id": "comment-16116052"
        },
        {
            "date": "2017-08-07T05:00:40+0000",
            "content": "Commit 3beca08be1accb3562bf731fc87acd79ff265f28 in lucene-solr's branch refs/heads/branch_7x from Steve Rowe\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=3beca08 ]\n\nSOLR-10796: TestPointFields.testDoublePointFieldRangeFacet(): Guard against converting a double-valued '-Infinity' to BigDecimal (fix location #2) ",
            "author": "ASF subversion and git services",
            "id": "comment-16116053"
        },
        {
            "date": "2017-08-07T05:00:42+0000",
            "content": "Commit 5f30765331fe05a8394266081f041a1831e7adf1 in lucene-solr's branch refs/heads/master from Steve Rowe\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=5f30765 ]\n\nSOLR-10796: TestPointFields.testDoublePointFieldRangeFacet(): Guard against converting a double-valued '-Infinity' to BigDecimal (fix location #2) ",
            "author": "ASF subversion and git services",
            "id": "comment-16116054"
        },
        {
            "date": "2017-10-17T11:04:09+0000",
            "content": "Bulk close after 7.1.0 release ",
            "author": "Shalin Shekhar Mangar",
            "id": "comment-16207431"
        }
    ]
}