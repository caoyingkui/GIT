{
    "id": "SOLR-6598",
    "title": "Solr Collections API, case sensitivity of collection name and core's/replica's instance directory",
    "details": {
        "components": [
            "SolrCloud"
        ],
        "type": "Bug",
        "labels": "",
        "fix_versions": [],
        "affect_versions": "4.10.1",
        "status": "Open",
        "resolution": "Unresolved",
        "priority": "Trivial"
    },
    "description": "Solr Collections API returns misleading error when trying to create two collections with the same name but with different case on MacOS file system (which is case insensitive). \n\n\nsh> curl 'http://localhost:8983/solr/admin/collections?action=CREATE&name=test&numShards=1&collection.configName=default&indent=true&wt=json'\n\n{\n  \"responseHeader\":{\n    \"status\":0,\n    \"QTime\":1949},\n  \"success\":{\n    \"\":{\n      \"responseHeader\":{\n        \"status\":0,\n        \"QTime\":1833},\n      \"core\":\"test_shard1_replica1\"}}}\n\nsh> curl 'http://localhost:8983/solr/admin/collections?action=CREATE&name=TEST&numShards=1&collection.configName=default&indent=true&wt=json'\n\n{\n  \"responseHeader\":{\n    \"status\":0,\n    \"QTime\":2509},\n  \"failure\":{\n    \"\":\"org.apache.solr.client.solrj.impl.HttpSolrServer$RemoteSolrException:Error CREATEing SolrCore 'TEST_shard1_replica1': Unable to create core [TEST_shard1_replica1] Caused by: Lock obtain timed out: NativeFSLock@/Users/alexey/Desktop/solr-4.10.1/node1/solr/test_shard1_replica1/data/index/write.lock\"}}\n\n\n\nSee Lock obtain timed out exception. It will be more user friendly to check existence of instance dir test_shard1_replica1 and return something like \"Node A has replica B that uses the same index directory\" exception (instead of just trying to hijack that existing directory and then propagating the inexplicable lock exception that arises as a result).",
    "attachments": {},
    "issue_links": {},
    "comments": [
        {
            "date": "2014-10-18T16:22:07+0000",
            "author": "Anurag Sharma",
            "content": "Is it specific to MacOS? Case sensitive names are supported by most of the OS. ",
            "id": "comment-14176053"
        },
        {
            "date": "2014-11-02T05:46:36+0000",
            "author": "Anurag Sharma",
            "content": "I am able to reproducible on windows/cygwin. \nInteresting observation, it allows creation creation of 'tEsT' but not 'TEST' after creation of 'test' collection.\n\n\n$ curl 'http://localhost:8983/solr/admin/collections?action=CREATE&name=test&numShards=1&collection.configName=myconf&indent=true&wt=json'\n{\n  \"responseHeader\":{\n    \"status\":0,\n    \"QTime\":8565},\n  \"success\":{\n    \"\":{\n      \"responseHeader\":{\n        \"status\":0,\n        \"QTime\":8003},\n      \"core\":\"test_shard1_replica1\"}}}\n\n$ curl 'http://localhost:8983/solr/admin/collections?action=CREATE&name=test&numShards=1&collection.configName=myconf&indent=true&wt=json'\n{\n  \"responseHeader\":{\n    \"status\":400,\n    \"QTime\":156},\n  \"Operation create caused exception:\":\"org.apache.solr.common.SolrException:org.apache.solr.common.SolrException: collection already exists: test\",\n  \"exception\":{\n    \"msg\":\"collection already exists: test\",\n    \"rspCode\":400},\n  \"error\":{\n    \"msg\":\"collection already exists: test\",\n    \"code\":400}}\n\n$ curl 'http://localhost:8983/solr/admin/collections?action=CREATE&name=TEST&numShards=1&collection.configName=myconf&indent=true&wt=json'\n{\n  \"responseHeader\":{\n    \"status\":0,\n    \"QTime\":7768},\n  \"failure\":{\n    \"\":\"org.apache.solr.client.solrj.impl.HttpSolrServer$RemoteSolrException:Error CREATEing SolrCore 'TEST_shard1_replica1': Unable to create core [TEST_shard1_replica1] Caused by: Lock obtain timed out: NativeFSLock@C:\\\\work\\\\trunk\\\\solr\\\\node2\\\\solr\\\\test_shard1_replica1\\\\data\\\\index\\\\write.lock\"}}\n\n$ curl 'http://localhost:8983/solr/admin/collections?action=CREATE&name=TEST1&numShards=1&collection.configName=myconf&indent=true&wt=json'\n{\n  \"responseHeader\":{\n    \"status\":0,\n    \"QTime\":6869},\n  \"success\":{\n    \"\":{\n      \"responseHeader\":{\n        \"status\":0,\n        \"QTime\":6415},\n      \"core\":\"TEST1_shard1_replica1\"}}}\n\n$ curl 'http://localhost:8983/solr/admin/collections?action=CREATE&name=tEsT&numShards=1&collection.configName=myconf&indent=true&wt=json'\n{\n  \"responseHeader\":{\n    \"status\":0,\n    \"QTime\":6471},\n  \"success\":{\n    \"\":{\n      \"responseHeader\":{\n        \"status\":0,\n        \"QTime\":6064},\n      \"core\":\"tEsT_shard1_replica1\"}}}\n\n$ curl 'http://localhost:8983/solr/admin/collections?action=CREATE&name=TEST&numShards=1&collection.configName=myconf&indent=true&wt=json'\n{\n  \"responseHeader\":{\n    \"status\":0,\n    \"QTime\":8690},\n  \"failure\":{\n    \"\":\"org.apache.solr.client.solrj.impl.HttpSolrServer$RemoteSolrException:Error CREATEing SolrCore 'TEST_shard1_replica1': Unable to create core [TEST_shard1_replica1] Caused by: Lock obtain timed out: NativeFSLock@C:\\\\work\\\\trunk\\\\solr\\\\node2\\\\solr\\\\test_shard1_replica1\\\\\n\n$ curl 'http://localhost:8983/solr/admin/collections?action=CREATE&name=TEst&numShards=1&collection.configName=myconf&indent=true&wt=json'\n{\n  \"responseHeader\":{\n    \"status\":0,\n    \"QTime\":5920},\n  \"failure\":{\n    \"\":\"org.apache.solr.client.solrj.impl.HttpSolrServer$RemoteSolrException:Error CREATEing SolrCore 'TEst_shard1_replica1': Unable to create core [TEst_shard1_replica1] Caused by: Lock obtain timed out: NativeFSLock@C:\\\\work\\\\trunk\\\\solr\\\\node2\\\\solr\\\\test_shard1_replica1\\\\data\\\\index\\\\write.lock\"}}\n\n$ curl 'http://localhost:8983/solr/admin/collections?action=CREATE&name=Test&numShards=1&collection.configName=myconf&indent=true&wt=json'\n{\n  \"responseHeader\":{\n    \"status\":0,\n    \"QTime\":6332},\n  \"failure\":{\n    \"\":\"org.apache.solr.client.solrj.impl.HttpSolrServer$RemoteSolrException:Error CREATEing SolrCore 'Test_shard1_replica1': Unable to create core [Test_shard1_replica1] Caused by: Lock obtain timed out: NativeFSLock@C:\\\\work\\\\trunk\\\\solr\\\\node1\\\\solr\\\\tEsT_shard1_replica1\\\\data\\\\index\\\\write.lock\"}}\n\n$ curl 'http://localhost:8983/solr/admin/collections?action=CREATE&name=Test1&numShards=1&collection.configName=myconf&indent=true&wt=json'\n{\n  \"responseHeader\":{\n    \"status\":0,\n    \"QTime\":6214},\n  \"success\":{\n    \"\":{\n      \"responseHeader\":{\n        \"status\":0,\n        \"QTime\":5636},\n      \"core\":\"Test1_shard1_replica1\"}}}\n\n\n ",
            "id": "comment-14193718"
        }
    ]
}