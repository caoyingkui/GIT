{
    "id": "SOLR-11549",
    "title": "SOLR 7 Extract PDF will Add many meta columns",
    "details": {
        "labels": "",
        "priority": "Major",
        "components": [
            "clients - C#",
            "contrib - Solr Cell (Tika extraction)"
        ],
        "type": "Improvement",
        "fix_versions": [],
        "affect_versions": "7.1",
        "resolution": "Invalid",
        "status": "Resolved"
    },
    "description": "in solr 6,extract pdf data to default column content\nin solr 7,extract pdf data ,will add many meta columns\n                                               how to don't add many meta columns",
    "attachments": {},
    "issue_links": {},
    "comments": [
        {
            "date": "2017-10-25T14:55:11+0000",
            "content": "Please raise this question on the user's list at solr-user@lucene.apache.org, see: (http://lucene.apache.org/solr/community.html#mailing-lists-irc) there are a lot more people watching that list who may be able to help. \n\nIf it's determined that this really is a code issue in Solr and not a configuration/usage problem, we can raise a new JIRA or reopen this one.\n\nLikely the issue is you're using the _default config set which adds any unrecognized fields as new fields, see \"schemaless\" in the reference guide.\n\nSwitch to a schema that throws out unrecognized fields, the \"ignored\" type in some of the older schemas. ",
            "author": "Erick Erickson",
            "id": "comment-16218825"
        },
        {
            "date": "2017-10-26T01:11:38+0000",
            "content": "I has close schemaless\n<!--   <updateRequestProcessorChain name=\"add-unknown-fields-to-the-schema\" default=\"${update.autoCreateFields:true}\"\n           processor=\"uuid,remove-blank,field-name-mutating,parse-boolean,parse-long,parse-double,parse-date,add-schema-fields\">\n    <processor class=\"solr.LogUpdateProcessorFactory\"/>\n    <processor class=\"solr.DistributedUpdateProcessorFactory\"/>\n    <processor class=\"solr.RunUpdateProcessorFactory\"/>\n  </updateRequestProcessorChain> -->\n\nand i use extract pdf function\nconfig is below:\n  <requestHandler name=\"/update/extract\"\n                  startup=\"lazy\"\n                  class=\"solr.extraction.ExtractingRequestHandler\" >\n    <lst name=\"defaults\">\n\t <str name=\"wt\">xml</str>\n      <str name=\"lowernames\">true</str>\n      <str name=\"fmap.meta\">ignored_</str>\n      <str name=\"fmap.content\">text</str>\n    </lst>\n  </requestHandler>\nhow to config extract pdf function,\n                        i think in sol7 extracthandler' pdf function is wrong,\n                      how to  not include extra columns\n\n<response>\n\n<lst name=\"responseHeader\">\n  <int name=\"status\">400</int>\n  <int name=\"QTime\">81</int>\n</lst>\n<lst name=\"error\">\n  <lst name=\"metadata\">\n    <str name=\"error-class\">org.apache.solr.common.SolrException</str>\n    <str name=\"root-error-class\">org.apache.solr.common.SolrException</str>\n  </lst>\n  <str name=\"msg\">ERROR: [doc=2N6C000A] unknown field 'date'</str>\n  <int name=\"code\">400</int>\n</lst>\n</response>\n<response>\n\n<lst name=\"responseHeader\">\n  <int name=\"status\">400</int>\n  <int name=\"QTime\">15</int>\n</lst>\n<lst name=\"error\">\n  <lst name=\"metadata\">\n    <str name=\"error-class\">org.apache.solr.common.SolrException</str>\n    <str name=\"root-error-class\">org.apache.solr.common.SolrException</str>\n  </lst>\n  <str name=\"msg\">ERROR: [doc=2EE0000A] unknown field 'date'</str>\n  <int name=\"code\">400</int>\n</lst>\n</response>\n<response>\n\n<lst name=\"responseHeader\">\n  <int name=\"status\">400</int>\n  <int name=\"QTime\">108</int>\n</lst>\n<lst name=\"error\">\n  <lst name=\"metadata\">\n    <str name=\"error-class\">org.apache.solr.common.SolrException</str>\n    <str name=\"root-error-class\">org.apache.solr.common.SolrException</str>\n  </lst>\n  <str name=\"msg\">ERROR: [doc=24ER000A] unknown field 'stream_size'</str>\n  <int name=\"code\">400</int>\n</lst>\n</response>\n\nSOL6.6 tkia 1.13\nSOL7.1 tkia 1.16\n\nException:\n\u5341\u6708 26, 2017 1:40:14 \u4e0a\u5348 org.apache.tika.config.InitializablePr\noblemHandler$3 handleInitializableProblem\nWARNING: JBIG2ImageReader not loaded. jbig2 files will be ignored\nSee https://pdfbox.apache.org/2.0/dependencies.html#jai-image-io\nfor optional dependencies.\nTIFFImageWriter not loaded. tiff files will not be processed\nSee https://pdfbox.apache.org/2.0/dependencies.html#jai-image-io\nfor optional dependencies.\nJ2KImageReader not loaded. JPEG2000 files will not be processed.\nSee https://pdfbox.apache.org/2.0/dependencies.html#jai-image-io\nfor optional dependencies.\n\n\u5341\u6708 26, 2017 1:40:14 \u4e0a\u5348 org.apache.tika.config.InitializableProblemHandler$3\nhandleInitializableProblem\nWARNING: org.xerial's sqlite-jdbc is not loaded.\nPlease provide the jar on your classpath to parse sqlite files.\nSee tika-parsers/pom.xml for the correct version. ",
            "author": "actcat",
            "id": "comment-16219808"
        },
        {
            "date": "2017-10-26T02:44:23+0000",
            "content": "2017-10-26 02:43:31.862 ERROR (qtp205125520-21) [c:RDS3 s:shard1 r:core_node2 x:RDS3_shard1_replica_n1] o.a.s.h.RequestHandlerBase org.apache.solr.common.SolrException: ERROR: [doc=262E000A] unknown field 'date'\n\tat org.apache.solr.update.DocumentBuilder.toDocument(DocumentBuilder.java:214)\n\tat org.apache.solr.update.AddUpdateCommand.getLuceneDocument(AddUpdateCommand.java:100)\n\tat org.apache.solr.update.DirectUpdateHandler2.updateDocument(DirectUpdateHandler2.java:958)\n\tat org.apache.solr.update.DirectUpdateHandler2.updateDocOrDocValues(DirectUpdateHandler2.java:949)\n\tat org.apache.solr.update.DirectUpdateHandler2.doNormalUpdate(DirectUpdateHandler2.java:329)\n\tat org.apache.solr.update.DirectUpdateHandler2.addDoc0(DirectUpdateHandler2.java:266)\n\tat org.apache.solr.update.DirectUpdateHandler2.addDoc(DirectUpdateHandler2.java:216)\n\tat org.apache.solr.update.processor.RunUpdateProcessor.processAdd(RunUpdateProcessorFactory.java:67)\n\tat org.apache.solr.update.processor.UpdateRequestProcessor.processAdd(UpdateRequestProcessor.java:55)\n\tat org.apache.solr.update.processor.DistributedUpdateProcessor.doLocalAdd(DistributedUpdateProcessor.java:991)\n\tat org.apache.solr.update.processor.DistributedUpdateProcessor.versionAdd(DistributedUpdateProcessor.java:1207)\n\tat org.apache.solr.update.processor.DistributedUpdateProcessor.processAdd(DistributedUpdateProcessor.java:753)\n\tat org.apache.solr.update.processor.LogUpdateProcessorFactory$LogUpdateProcessor.processAdd(LogUpdateProcessorFactory.java:103)\n\tat org.apache.solr.handler.extraction.ExtractingDocumentLoader.doAdd(ExtractingDocumentLoader.java:126)\n\tat org.apache.solr.handler.extraction.ExtractingDocumentLoader.addDoc(ExtractingDocumentLoader.java:131)\n\tat org.apache.solr.handler.extraction.ExtractingDocumentLoader.load(ExtractingDocumentLoader.java:237)\n\tat org.apache.solr.handler.ContentStreamHandlerBase.handleRequestBody(ContentStreamHandlerBase.java:68)\n\tat org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:177)\n\tat org.apache.solr.core.SolrCore.execute(SolrCore.java:2484)\n\tat org.apache.solr.servlet.HttpSolrCall.execute(HttpSolrCall.java:720)\n\tat org.apache.solr.servlet.HttpSolrCall.call(HttpSolrCall.java:526)\n\tat org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:382)\n\tat org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:326)\n\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1751)\n\tat org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:582)\n\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)\n\tat org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:548)\n\tat org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:226)\n\tat org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1180)\n\tat org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:512)\n\tat org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)\n\tat org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1112)\n\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)\n\tat org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:213)\n\tat org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:119)\n\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:134)\n\tat org.eclipse.jetty.rewrite.handler.RewriteHandler.handle(RewriteHandler.java:335)\n\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:134)\n\tat org.eclipse.jetty.server.Server.handle(Server.java:534)\n\tat org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:320)\n\tat org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:251)\n\tat org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:283)\n\tat org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:108)\n\tat org.eclipse.jetty.io.SelectChannelEndPoint$2.run(SelectChannelEndPoint.java:93)\n\tat org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.executeProduceConsume(ExecuteProduceConsume.java:303)\n\tat org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.produceConsume(ExecuteProduceConsume.java:148)\n\tat org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.run(ExecuteProduceConsume.java:136)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:671)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool$2.run(QueuedThreadPool.java:589)\n\tat java.lang.Thread.run(Unknown Source) ",
            "author": "actcat",
            "id": "comment-16219881"
        },
        {
            "date": "2017-10-26T02:53:12+0000",
            "content": "Please do not reopen this issue unless and until you have asked the question on the user's list and we have consensus that this is a code issue rather than a usage/configuration issue. The JIRA list is intended for bugs/improvements once it's ascertained that it's a real bug and not a usage issue. ",
            "author": "Erick Erickson",
            "id": "comment-16219885"
        }
    ]
}