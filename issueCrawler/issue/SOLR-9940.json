{
    "id": "SOLR-9940",
    "title": "Config API throws Index Not Mutable when creating a RequestHandler on a Classic Schema",
    "details": {
        "components": [
            "config-api"
        ],
        "type": "Bug",
        "labels": "",
        "fix_versions": [],
        "affect_versions": "6.2",
        "status": "Open",
        "resolution": "Unresolved",
        "priority": "Minor"
    },
    "description": "All of our schema are Classic, we do no use mutable schemas.\nWe use the Config API to create /cdcr request handlers \n\n{\n  \"add-requesthandler\":{\n    \"name\":\"/cdcr\",\n    \"class\":\"solr.CdcrRequestHandler\",\n    \"replica\": [{\n    \t\"zkHost\":\"stldeepx20.sial.com:2181/solr\",\n    \t\"source\":\"sial-catalog-material\",\n    \t\"target\":\"sial-catalog-material\"\n    }, {\n    \t\"zkHost\":\"stldeepx06.sial.com:2181/solr\",\n    \t\"source\":\"sial-catalog-material\",\n    \t\"target\":\"sial-catalog-material\"\n    }],\n    \"replicator\": {\n      \"threadPoolSize\":2,\n      \"schedule\": 1000,\n      \"batchSize\": 128\n    },\n    \"updateLogSynchronizer\" : {\n      \"schedule\": 60000\n    }\n  }\n}\n\n\nThe actual handler is generated by by an endpoint.\nThe handler is created, and is functional, but the following errors are present in the log:\n\n2017-01-06 21:34:12.377 ERROR (SolrConfigHandler-refreshconf) [c:test-catalog-product s:shard1 r:core_node1 x:test-catalog-product_s\nhard1_replica1] o.a.s.s.IndexSchema This IndexSchema is not mutable.\n2017-01-06 21:34:12.377 WARN  (SolrConfigHandler-refreshconf) [c:test-catalog-product s:shard1 r:core_node1 x:test-catalog-product_s\nhard1_replica1] o.a.s.c.SolrCore \norg.apache.solr.common.SolrException: This IndexSchema is not mutable.\n        at org.apache.solr.schema.IndexSchema.getSchemaUpdateLock(IndexSchema.java:1864)\n        at org.apache.solr.schema.SchemaManager.getFreshManagedSchema(SchemaManager.java:434)\n        at org.apache.solr.core.SolrCore.lambda$getConfListener$6(SolrCore.java:2571)\n        at org.apache.solr.core.SolrCore$$Lambda$91/766533008.run(Unknown Source)\n        at org.apache.solr.handler.SolrConfigHandler$Command.lambda$handleGET$0(SolrConfigHandler.java:216)\n        at org.apache.solr.handler.SolrConfigHandler$Command$$Lambda$143/2029435585.run(Unknown Source)\n        at java.lang.Thread.run(Thread.java:745)",
    "attachments": {},
    "issue_links": {},
    "comments": []
}