{
    "id": "SOLR-5180",
    "title": "Core admin reload for an invalid core name returns 500 rather than 400 status code",
    "details": {
        "affect_versions": "4.4",
        "status": "Resolved",
        "fix_versions": [],
        "components": [
            "multicore"
        ],
        "type": "Bug",
        "priority": "Major",
        "labels": "",
        "resolution": "Fixed"
    },
    "description": "A core admin request to reload a nonexistent core name returns a 500 Server Error rather than a 400 Invalid Request status code.\n\nThe request: \n\ncurl \"http://localhost:8983/solr/admin/cores?action=reload&core=bogus&indent=true\"\n\n\n\nThe response:\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<response>\n\n<lst name=\"responseHeader\">\n  <int name=\"status\">500</int>\n  <int name=\"QTime\">5</int>\n</lst>\n<lst name=\"error\">\n  <str name=\"msg\">Error handling 'reload' action</str>\n  <str name=\"trace\">org.apache.solr.common.SolrException: Error handling 'reload' action\n        at org.apache.solr.handler.admin.CoreAdminHandler.handleReloadAction(CoreAdminHandler.java:673)\n        at org.apache.solr.handler.admin.CoreAdminHandler.handleRequestBody(CoreAdminHandler.java:172)\n        at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:135)\n        at org.apache.solr.servlet.SolrDispatchFilter.handleAdminRequest(SolrDispatchFilter.java:655)\n        at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:246)\n        at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:195)\n        at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1419)\n        at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:455)\n        at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:137)\n        at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:557)\n        at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:231)\n        at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1075)\n        at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:384)\n        at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:193)\n        at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1009)\n        at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:135)\n        at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:255)\n        at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:154)\n        at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:116)\n        at org.eclipse.jetty.server.Server.handle(Server.java:368)\n        at org.eclipse.jetty.server.AbstractHttpConnection.handleRequest(AbstractHttpConnection.java:489)\n        at org.eclipse.jetty.server.BlockingHttpConnection.handleRequest(BlockingHttpConnection.java:53)\n        at org.eclipse.jetty.server.AbstractHttpConnection.headerComplete(AbstractHttpConnection.java:942)\n        at org.eclipse.jetty.server.AbstractHttpConnection$RequestHandler.headerComplete(AbstractHttpConnection.java:1004)\n        at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:640)\n        at org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:235)\n        at org.eclipse.jetty.server.BlockingHttpConnection.handle(BlockingHttpConnection.java:72)\n        at org.eclipse.jetty.server.bio.SocketConnector$ConnectorEndPoint.run(SocketConnector.java:264)\n        at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:608)\n        at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:543)\n        at java.lang.Thread.run(Unknown Source)\nCaused by: org.apache.solr.common.SolrException: Unable to reload core: bogus\n        at org.apache.solr.core.CoreContainer.recordAndThrow(CoreContainer.java:930)\n        at org.apache.solr.core.CoreContainer.reload(CoreContainer.java:685)\n        at org.apache.solr.handler.admin.CoreAdminHandler.handleReloadAction(CoreAdminHandler.java:671)\n        ... 30 more\nCaused by: org.apache.solr.common.SolrException: No such core: bogus\n        at org.apache.solr.core.CoreContainer.reload(CoreContainer.java:636)\n        ... 31 more\n</str>\n  <int name=\"code\">500</int>\n</lst>\n</response>\n\n\n\nThe code at CoreContainer.reload(CoreContainer.java:636) correctly throws a Solr Bad Request Exception:\n\n\n\n\n      if (core == null)\n        throw new SolrException( SolrException.ErrorCode.BAD_REQUEST, \"No such core: \" + name );\n\nBut then the code at CoreAdminHandler.handleReloadAction(CoreAdminHandler.java:673) catches it and throws the Server Error exception:\n\n\n\n    try \n{\n      coreContainer.reload(cname);\n    }\n catch (Exception ex) \n{\n      throw new SolrException(SolrException.ErrorCode.SERVER_ERROR, \"Error handling 'reload' action\", ex);\n    }",
    "attachments": {},
    "issue_links": {},
    "comments": [
        {
            "author": "Scott Blum",
            "id": "comment-16581801",
            "date": "2018-08-16T00:53:42+0000",
            "content": "This is now fixed "
        }
    ]
}