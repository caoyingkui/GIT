{
    "id": "SOLR-2160",
    "title": "Unknown query type 'func'",
    "details": {
        "affect_versions": "3.1,                                            4.0-ALPHA",
        "status": "Closed",
        "fix_versions": [
            "3.1",
            "4.0-ALPHA"
        ],
        "components": [
            "Build"
        ],
        "type": "Test",
        "priority": "Major",
        "labels": "",
        "resolution": "Fixed"
    },
    "description": "Several test methods in TestTrie failed in hudson, with errors such as this:\n\nCaused by: org.apache.solr.common.SolrException: Unknown query type 'func'",
    "attachments": {
        "SOLR-2160.patch": "https://issues.apache.org/jira/secure/attachment/12457933/SOLR-2160.patch"
    },
    "issue_links": {},
    "comments": [
        {
            "author": "Yonik Seeley",
            "id": "comment-12921330",
            "date": "2010-10-15T12:47:26+0000",
            "content": "Hmmm, \"func\" (the function query parser) not found?\nMust be meddling from another test.\n\nIs there a way to find out what test(s) run before any given test in the same JVM? "
        },
        {
            "author": "Robert Muir",
            "id": "comment-12921334",
            "date": "2010-10-15T12:56:42+0000",
            "content": "\nMust be meddling from another test\nIs there a way to find out what test(s) run before any given test in the same JVM?\n\nAt the moment, its very hackish. The way i hack around it is by looking in build/test-results/temp\nThere you see unique temp folders for each jvm (0, 1, 2, 3, etc).\nAnd if you disable Solr's deletion of its temp folders in AbstractSolrTestCase/SolrTestCaseJ4 (the recursiveDelete),\nthen you have a log of all tests that ran in that jvm, sorta.\n\nI think we really need to improve the build system to somehow provide this information easier when a test fails.\nOtherwise its extremely difficult to debug an issue like this. "
        },
        {
            "author": "Yonik Seeley",
            "id": "comment-12923440",
            "date": "2010-10-21T13:52:52+0000",
            "content": "Moving stacktrace out of description:\n\nHere is the stacktrace:\n\n   [junit] Testsuite: org.apache.solr.TestTrie\n    [junit] Testcase: testTrieIntRangeSearch(org.apache.solr.TestTrie):\tCaused an ERROR\n    [junit] Exception during query\n    [junit] java.lang.RuntimeException: Exception during query\n    [junit] \tat org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:339)\n    [junit] \tat org.apache.solr.TestTrie.testTrieIntRangeSearch(TestTrie.java:76)\n    [junit] \tat org.apache.lucene.util.LuceneTestCase$LuceneTestCaseRunner.runChild(LuceneTestCase.java:795)\n    [junit] \tat org.apache.lucene.util.LuceneTestCase$LuceneTestCaseRunner.runChild(LuceneTestCase.java:768)\n    [junit] Caused by: org.apache.solr.common.SolrException: Unknown query type 'func'\n    [junit] \tat org.apache.solr.core.SolrCore.getQueryPlugin(SolrCore.java:1474)\n    [junit] \tat org.apache.solr.search.QParser.getParser(QParser.java:286)\n    [junit] \tat org.apache.solr.search.QParser.subQuery(QParser.java:176)\n    [junit] \tat org.apache.solr.search.SolrQueryParser.getFieldQuery(SolrQueryParser.java:142)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.getFieldQuery(QueryParser.java:754)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.Term(QueryParser.java:1594)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.Clause(QueryParser.java:1337)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.Query(QueryParser.java:1263)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.TopLevelQuery(QueryParser.java:1252)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.parse(QueryParser.java:208)\n    [junit] \tat org.apache.solr.search.LuceneQParser.parse(LuceneQParserPlugin.java:73)\n    [junit] \tat org.apache.solr.search.QParser.getQuery(QParser.java:142)\n    [junit] \tat org.apache.solr.handler.component.QueryComponent.prepare(QueryComponent.java:93)\n    [junit] \tat org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:210)\n    [junit] \tat org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:131)\n    [junit] \tat org.apache.solr.core.SolrCore.execute(SolrCore.java:1325)\n    [junit] \tat org.apache.solr.util.TestHarness.queryAndResponse(TestHarness.java:334)\n    [junit] \tat org.apache.solr.util.TestHarness.query(TestHarness.java:321)\n    [junit] \tat org.apache.solr.util.TestHarness.query(TestHarness.java:307)\n    [junit] \tat org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:317)\n    [junit] \n    [junit] \n    [junit] Testcase: testTrieFloatRangeSearch(org.apache.solr.TestTrie):\tCaused an ERROR\n    [junit] Exception during query\n    [junit] java.lang.RuntimeException: Exception during query\n    [junit] \tat org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:339)\n    [junit] \tat org.apache.solr.TestTrie.testTrieFloatRangeSearch(TestTrie.java:119)\n    [junit] \tat org.apache.lucene.util.LuceneTestCase$LuceneTestCaseRunner.runChild(LuceneTestCase.java:795)\n    [junit] \tat org.apache.lucene.util.LuceneTestCase$LuceneTestCaseRunner.runChild(LuceneTestCase.java:768)\n    [junit] Caused by: org.apache.solr.common.SolrException: Unknown query type 'func'\n    [junit] \tat org.apache.solr.core.SolrCore.getQueryPlugin(SolrCore.java:1474)\n    [junit] \tat org.apache.solr.search.QParser.getParser(QParser.java:286)\n    [junit] \tat org.apache.solr.search.QParser.subQuery(QParser.java:176)\n    [junit] \tat org.apache.solr.search.SolrQueryParser.getFieldQuery(SolrQueryParser.java:142)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.getFieldQuery(QueryParser.java:754)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.Term(QueryParser.java:1594)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.Clause(QueryParser.java:1337)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.Query(QueryParser.java:1263)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.TopLevelQuery(QueryParser.java:1252)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.parse(QueryParser.java:208)\n    [junit] \tat org.apache.solr.search.LuceneQParser.parse(LuceneQParserPlugin.java:73)\n    [junit] \tat org.apache.solr.search.QParser.getQuery(QParser.java:142)\n    [junit] \tat org.apache.solr.handler.component.QueryComponent.prepare(QueryComponent.java:93)\n    [junit] \tat org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:210)\n    [junit] \tat org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:131)\n    [junit] \tat org.apache.solr.core.SolrCore.execute(SolrCore.java:1325)\n    [junit] \tat org.apache.solr.util.TestHarness.queryAndResponse(TestHarness.java:334)\n    [junit] \tat org.apache.solr.util.TestHarness.query(TestHarness.java:321)\n    [junit] \tat org.apache.solr.util.TestHarness.query(TestHarness.java:307)\n    [junit] \tat org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:317)\n    [junit] \n    [junit] \n    [junit] Testcase: testTrieLongRangeSearch(org.apache.solr.TestTrie):\tCaused an ERROR\n    [junit] Exception during query\n    [junit] java.lang.RuntimeException: Exception during query\n    [junit] \tat org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:339)\n    [junit] \tat org.apache.solr.TestTrie.testTrieLongRangeSearch(TestTrie.java:138)\n    [junit] \tat org.apache.lucene.util.LuceneTestCase$LuceneTestCaseRunner.runChild(LuceneTestCase.java:795)\n    [junit] \tat org.apache.lucene.util.LuceneTestCase$LuceneTestCaseRunner.runChild(LuceneTestCase.java:768)\n    [junit] Caused by: org.apache.solr.common.SolrException: Unknown query type 'func'\n    [junit] \tat org.apache.solr.core.SolrCore.getQueryPlugin(SolrCore.java:1474)\n    [junit] \tat org.apache.solr.search.QParser.getParser(QParser.java:286)\n    [junit] \tat org.apache.solr.search.QParser.subQuery(QParser.java:176)\n    [junit] \tat org.apache.solr.search.SolrQueryParser.getFieldQuery(SolrQueryParser.java:142)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.getFieldQuery(QueryParser.java:754)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.Term(QueryParser.java:1594)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.Clause(QueryParser.java:1337)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.Query(QueryParser.java:1263)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.TopLevelQuery(QueryParser.java:1252)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.parse(QueryParser.java:208)\n    [junit] \tat org.apache.solr.search.LuceneQParser.parse(LuceneQParserPlugin.java:73)\n    [junit] \tat org.apache.solr.search.QParser.getQuery(QParser.java:142)\n    [junit] \tat org.apache.solr.handler.component.QueryComponent.prepare(QueryComponent.java:93)\n    [junit] \tat org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:210)\n    [junit] \tat org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:131)\n    [junit] \tat org.apache.solr.core.SolrCore.execute(SolrCore.java:1325)\n    [junit] \tat org.apache.solr.util.TestHarness.queryAndResponse(TestHarness.java:334)\n    [junit] \tat org.apache.solr.util.TestHarness.query(TestHarness.java:321)\n    [junit] \tat org.apache.solr.util.TestHarness.query(TestHarness.java:307)\n    [junit] \tat org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:317)\n    [junit] \n    [junit] \n    [junit] Testcase: testTrieDoubleRangeSearch(org.apache.solr.TestTrie):\tCaused an ERROR\n    [junit] Exception during query\n    [junit] java.lang.RuntimeException: Exception during query\n    [junit] \tat org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:339)\n    [junit] \tat org.apache.solr.TestTrie.testTrieDoubleRangeSearch(TestTrie.java:156)\n    [junit] \tat org.apache.lucene.util.LuceneTestCase$LuceneTestCaseRunner.runChild(LuceneTestCase.java:795)\n    [junit] \tat org.apache.lucene.util.LuceneTestCase$LuceneTestCaseRunner.runChild(LuceneTestCase.java:768)\n    [junit] Caused by: org.apache.solr.common.SolrException: Unknown query type 'func'\n    [junit] \tat org.apache.solr.core.SolrCore.getQueryPlugin(SolrCore.java:1474)\n    [junit] \tat org.apache.solr.search.QParser.getParser(QParser.java:286)\n    [junit] \tat org.apache.solr.search.QParser.subQuery(QParser.java:176)\n    [junit] \tat org.apache.solr.search.SolrQueryParser.getFieldQuery(SolrQueryParser.java:142)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.getFieldQuery(QueryParser.java:754)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.Term(QueryParser.java:1594)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.Clause(QueryParser.java:1337)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.Query(QueryParser.java:1263)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.TopLevelQuery(QueryParser.java:1252)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.parse(QueryParser.java:208)\n    [junit] \tat org.apache.solr.search.LuceneQParser.parse(LuceneQParserPlugin.java:73)\n    [junit] \tat org.apache.solr.search.QParser.getQuery(QParser.java:142)\n    [junit] \tat org.apache.solr.handler.component.QueryComponent.prepare(QueryComponent.java:93)\n    [junit] \tat org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:210)\n    [junit] \tat org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:131)\n    [junit] \tat org.apache.solr.core.SolrCore.execute(SolrCore.java:1325)\n    [junit] \tat org.apache.solr.util.TestHarness.queryAndResponse(TestHarness.java:334)\n    [junit] \tat org.apache.solr.util.TestHarness.query(TestHarness.java:321)\n    [junit] \tat org.apache.solr.util.TestHarness.query(TestHarness.java:307)\n    [junit] \tat org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:317)\n    [junit] \n    [junit] \n    [junit] Testcase: testTrieDateRangeSearch(org.apache.solr.TestTrie):\tCaused an ERROR\n    [junit] Exception during query\n    [junit] java.lang.RuntimeException: Exception during query\n    [junit] \tat org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:339)\n    [junit] \tat org.apache.solr.TestTrie.testTrieDateRangeSearch(TestTrie.java:202)\n    [junit] \tat org.apache.lucene.util.LuceneTestCase$LuceneTestCaseRunner.runChild(LuceneTestCase.java:795)\n    [junit] \tat org.apache.lucene.util.LuceneTestCase$LuceneTestCaseRunner.runChild(LuceneTestCase.java:768)\n    [junit] Caused by: org.apache.solr.common.SolrException: Unknown query type 'func'\n    [junit] \tat org.apache.solr.core.SolrCore.getQueryPlugin(SolrCore.java:1474)\n    [junit] \tat org.apache.solr.search.QParser.getParser(QParser.java:286)\n    [junit] \tat org.apache.solr.search.QParser.subQuery(QParser.java:176)\n    [junit] \tat org.apache.solr.search.SolrQueryParser.getFieldQuery(SolrQueryParser.java:142)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.getFieldQuery(QueryParser.java:754)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.Term(QueryParser.java:1594)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.Clause(QueryParser.java:1337)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.Query(QueryParser.java:1263)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.TopLevelQuery(QueryParser.java:1252)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.parse(QueryParser.java:208)\n    [junit] \tat org.apache.solr.search.LuceneQParser.parse(LuceneQParserPlugin.java:73)\n    [junit] \tat org.apache.solr.search.QParser.getQuery(QParser.java:142)\n    [junit] \tat org.apache.solr.handler.component.QueryComponent.prepare(QueryComponent.java:93)\n    [junit] \tat org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:210)\n    [junit] \tat org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:131)\n    [junit] \tat org.apache.solr.core.SolrCore.execute(SolrCore.java:1325)\n    [junit] \tat org.apache.solr.util.TestHarness.queryAndResponse(TestHarness.java:334)\n    [junit] \tat org.apache.solr.util.TestHarness.query(TestHarness.java:321)\n    [junit] \tat org.apache.solr.util.TestHarness.query(TestHarness.java:307)\n    [junit] \tat org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:317)\n    [junit] \n    [junit] \n    [junit] Tests run: 8, Failures: 0, Errors: 5, Time elapsed: 3.814 sec\n    [junit] \n    [junit] ------------- Standard Output ---------------\n    [junit] NOTE: reproduce with: ant test -Dtestcase=TestTrie -Dtestmethod=testTrieIntRangeSearch -Dtests.seed=-2722426925580758488:-212535574334114449\n    [junit] NOTE: reproduce with: ant test -Dtestcase=TestTrie -Dtestmethod=testTrieFloatRangeSearch -Dtests.seed=-2722426925580758488:-8980412733871305155\n    [junit] NOTE: reproduce with: ant test -Dtestcase=TestTrie -Dtestmethod=testTrieLongRangeSearch -Dtests.seed=-2722426925580758488:-8688081968302257420\n    [junit] NOTE: reproduce with: ant test -Dtestcase=TestTrie -Dtestmethod=testTrieDoubleRangeSearch -Dtests.seed=-2722426925580758488:1705446365560533918\n    [junit] NOTE: reproduce with: ant test -Dtestcase=TestTrie -Dtestmethod=testTrieDateRangeSearch -Dtests.seed=-2722426925580758488:2549506927018087212\n    [junit] NOTE: test params are: codec=Standard, locale=sl, timezone=Japan\n    [junit] ------------- ---------------- ---------------\n    [junit] ------------- Standard Error -----------------\n    [junit] 15.10.2010 7:29:20 org.apache.solr.common.SolrException log\n    [junit] SEVERE: org.apache.solr.common.SolrException: Unknown query type 'func'\n    [junit] \tat org.apache.solr.core.SolrCore.getQueryPlugin(SolrCore.java:1474)\n    [junit] \tat org.apache.solr.search.QParser.getParser(QParser.java:286)\n    [junit] \tat org.apache.solr.search.QParser.subQuery(QParser.java:176)\n    [junit] \tat org.apache.solr.search.SolrQueryParser.getFieldQuery(SolrQueryParser.java:142)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.getFieldQuery(QueryParser.java:754)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.Term(QueryParser.java:1594)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.Clause(QueryParser.java:1337)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.Query(QueryParser.java:1263)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.TopLevelQuery(QueryParser.java:1252)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.parse(QueryParser.java:208)\n    [junit] \tat org.apache.solr.search.LuceneQParser.parse(LuceneQParserPlugin.java:73)\n    [junit] \tat org.apache.solr.search.QParser.getQuery(QParser.java:142)\n    [junit] \tat org.apache.solr.handler.component.QueryComponent.prepare(QueryComponent.java:93)\n    [junit] \tat org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:210)\n    [junit] \tat org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:131)\n    [junit] \tat org.apache.solr.core.SolrCore.execute(SolrCore.java:1325)\n    [junit] \tat org.apache.solr.util.TestHarness.queryAndResponse(TestHarness.java:334)\n    [junit] \tat org.apache.solr.util.TestHarness.query(TestHarness.java:321)\n    [junit] \tat org.apache.solr.util.TestHarness.query(TestHarness.java:307)\n    [junit] \tat org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:317)\n    [junit] \tat org.apache.solr.TestTrie.testTrieIntRangeSearch(TestTrie.java:76)\n    [junit] \tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    [junit] \tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n    [junit] \tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    [junit] \tat java.lang.reflect.Method.invoke(Method.java:616)\n    [junit] \tat org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)\n    [junit] \tat org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)\n    [junit] \tat org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)\n    [junit] \tat org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)\n    [junit] \tat org.junit.rules.TestWatchman$1.evaluate(TestWatchman.java:48)\n    [junit] \tat org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)\n    [junit] \tat org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:31)\n    [junit] \tat org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:76)\n    [junit] \tat org.apache.lucene.util.LuceneTestCase$LuceneTestCaseRunner.runChild(LuceneTestCase.java:795)\n    [junit] \tat org.apache.lucene.util.LuceneTestCase$LuceneTestCaseRunner.runChild(LuceneTestCase.java:768)\n    [junit] \tat org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)\n    [junit] \tat org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)\n    [junit] \tat org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)\n    [junit] \tat org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)\n    [junit] \tat org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)\n    [junit] \tat org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)\n    [junit] \tat org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:31)\n    [junit] \tat org.junit.runners.ParentRunner.run(ParentRunner.java:236)\n    [junit] \tat junit.framework.JUnit4TestAdapter.run(JUnit4TestAdapter.java:39)\n    [junit] \tat org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:421)\n    [junit] \tat org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:912)\n    [junit] \tat org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:743)\n    [junit] \n    [junit] 15.10.2010 7:29:20 org.apache.solr.common.SolrException log\n    [junit] SEVERE: org.apache.solr.common.SolrException: Unknown query type 'func'\n    [junit] \tat org.apache.solr.core.SolrCore.getQueryPlugin(SolrCore.java:1474)\n    [junit] \tat org.apache.solr.search.QParser.getParser(QParser.java:286)\n    [junit] \tat org.apache.solr.search.QParser.subQuery(QParser.java:176)\n    [junit] \tat org.apache.solr.search.SolrQueryParser.getFieldQuery(SolrQueryParser.java:142)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.getFieldQuery(QueryParser.java:754)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.Term(QueryParser.java:1594)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.Clause(QueryParser.java:1337)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.Query(QueryParser.java:1263)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.TopLevelQuery(QueryParser.java:1252)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.parse(QueryParser.java:208)\n    [junit] \tat org.apache.solr.search.LuceneQParser.parse(LuceneQParserPlugin.java:73)\n    [junit] \tat org.apache.solr.search.QParser.getQuery(QParser.java:142)\n    [junit] \tat org.apache.solr.handler.component.QueryComponent.prepare(QueryComponent.java:93)\n    [junit] \tat org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:210)\n    [junit] \tat org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:131)\n    [junit] \tat org.apache.solr.core.SolrCore.execute(SolrCore.java:1325)\n    [junit] \tat org.apache.solr.util.TestHarness.queryAndResponse(TestHarness.java:334)\n    [junit] \tat org.apache.solr.util.TestHarness.query(TestHarness.java:321)\n    [junit] \tat org.apache.solr.util.TestHarness.query(TestHarness.java:307)\n    [junit] \tat org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:317)\n    [junit] \tat org.apache.solr.TestTrie.testTrieFloatRangeSearch(TestTrie.java:119)\n    [junit] \tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    [junit] \tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n    [junit] \tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    [junit] \tat java.lang.reflect.Method.invoke(Method.java:616)\n    [junit] \tat org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)\n    [junit] \tat org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)\n    [junit] \tat org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)\n    [junit] \tat org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)\n    [junit] \tat org.junit.rules.TestWatchman$1.evaluate(TestWatchman.java:48)\n    [junit] \tat org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)\n    [junit] \tat org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:31)\n    [junit] \tat org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:76)\n    [junit] \tat org.apache.lucene.util.LuceneTestCase$LuceneTestCaseRunner.runChild(LuceneTestCase.java:795)\n    [junit] \tat org.apache.lucene.util.LuceneTestCase$LuceneTestCaseRunner.runChild(LuceneTestCase.java:768)\n    [junit] \tat org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)\n    [junit] \tat org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)\n    [junit] \tat org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)\n    [junit] \tat org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)\n    [junit] \tat org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)\n    [junit] \tat org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)\n    [junit] \tat org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:31)\n    [junit] \tat org.junit.runners.ParentRunner.run(ParentRunner.java:236)\n    [junit] \tat junit.framework.JUnit4TestAdapter.run(JUnit4TestAdapter.java:39)\n    [junit] \tat org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:421)\n    [junit] \tat org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:912)\n    [junit] \tat org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:743)\n    [junit] \n    [junit] 15.10.2010 7:29:20 org.apache.solr.common.SolrException log\n    [junit] SEVERE: org.apache.solr.common.SolrException: Unknown query type 'func'\n    [junit] \tat org.apache.solr.core.SolrCore.getQueryPlugin(SolrCore.java:1474)\n    [junit] \tat org.apache.solr.search.QParser.getParser(QParser.java:286)\n    [junit] \tat org.apache.solr.search.QParser.subQuery(QParser.java:176)\n    [junit] \tat org.apache.solr.search.SolrQueryParser.getFieldQuery(SolrQueryParser.java:142)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.getFieldQuery(QueryParser.java:754)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.Term(QueryParser.java:1594)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.Clause(QueryParser.java:1337)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.Query(QueryParser.java:1263)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.TopLevelQuery(QueryParser.java:1252)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.parse(QueryParser.java:208)\n    [junit] \tat org.apache.solr.search.LuceneQParser.parse(LuceneQParserPlugin.java:73)\n    [junit] \tat org.apache.solr.search.QParser.getQuery(QParser.java:142)\n    [junit] \tat org.apache.solr.handler.component.QueryComponent.prepare(QueryComponent.java:93)\n    [junit] \tat org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:210)\n    [junit] \tat org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:131)\n    [junit] \tat org.apache.solr.core.SolrCore.execute(SolrCore.java:1325)\n    [junit] \tat org.apache.solr.util.TestHarness.queryAndResponse(TestHarness.java:334)\n    [junit] \tat org.apache.solr.util.TestHarness.query(TestHarness.java:321)\n    [junit] \tat org.apache.solr.util.TestHarness.query(TestHarness.java:307)\n    [junit] \tat org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:317)\n    [junit] \tat org.apache.solr.TestTrie.testTrieLongRangeSearch(TestTrie.java:138)\n    [junit] \tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    [junit] \tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n    [junit] \tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    [junit] \tat java.lang.reflect.Method.invoke(Method.java:616)\n    [junit] \tat org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)\n    [junit] \tat org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)\n    [junit] \tat org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)\n    [junit] \tat org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)\n    [junit] \tat org.junit.rules.TestWatchman$1.evaluate(TestWatchman.java:48)\n    [junit] \tat org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)\n    [junit] \tat org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:31)\n    [junit] \tat org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:76)\n    [junit] \tat org.apache.lucene.util.LuceneTestCase$LuceneTestCaseRunner.runChild(LuceneTestCase.java:795)\n    [junit] \tat org.apache.lucene.util.LuceneTestCase$LuceneTestCaseRunner.runChild(LuceneTestCase.java:768)\n    [junit] \tat org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)\n    [junit] \tat org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)\n    [junit] \tat org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)\n    [junit] \tat org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)\n    [junit] \tat org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)\n    [junit] \tat org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)\n    [junit] \tat org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:31)\n    [junit] \tat org.junit.runners.ParentRunner.run(ParentRunner.java:236)\n    [junit] \tat junit.framework.JUnit4TestAdapter.run(JUnit4TestAdapter.java:39)\n    [junit] \tat org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:421)\n    [junit] \tat org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:912)\n    [junit] \tat org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:743)\n    [junit] \n    [junit] 15.10.2010 7:29:21 org.apache.solr.common.SolrException log\n    [junit] SEVERE: org.apache.solr.common.SolrException: Unknown query type 'func'\n    [junit] \tat org.apache.solr.core.SolrCore.getQueryPlugin(SolrCore.java:1474)\n    [junit] \tat org.apache.solr.search.QParser.getParser(QParser.java:286)\n    [junit] \tat org.apache.solr.search.QParser.subQuery(QParser.java:176)\n    [junit] \tat org.apache.solr.search.SolrQueryParser.getFieldQuery(SolrQueryParser.java:142)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.getFieldQuery(QueryParser.java:754)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.Term(QueryParser.java:1594)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.Clause(QueryParser.java:1337)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.Query(QueryParser.java:1263)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.TopLevelQuery(QueryParser.java:1252)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.parse(QueryParser.java:208)\n    [junit] \tat org.apache.solr.search.LuceneQParser.parse(LuceneQParserPlugin.java:73)\n    [junit] \tat org.apache.solr.search.QParser.getQuery(QParser.java:142)\n    [junit] \tat org.apache.solr.handler.component.QueryComponent.prepare(QueryComponent.java:93)\n    [junit] \tat org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:210)\n    [junit] \tat org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:131)\n    [junit] \tat org.apache.solr.core.SolrCore.execute(SolrCore.java:1325)\n    [junit] \tat org.apache.solr.util.TestHarness.queryAndResponse(TestHarness.java:334)\n    [junit] \tat org.apache.solr.util.TestHarness.query(TestHarness.java:321)\n    [junit] \tat org.apache.solr.util.TestHarness.query(TestHarness.java:307)\n    [junit] \tat org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:317)\n    [junit] \tat org.apache.solr.TestTrie.testTrieDoubleRangeSearch(TestTrie.java:156)\n    [junit] \tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    [junit] \tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n    [junit] \tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    [junit] \tat java.lang.reflect.Method.invoke(Method.java:616)\n    [junit] \tat org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)\n    [junit] \tat org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)\n    [junit] \tat org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)\n    [junit] \tat org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)\n    [junit] \tat org.junit.rules.TestWatchman$1.evaluate(TestWatchman.java:48)\n    [junit] \tat org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)\n    [junit] \tat org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:31)\n    [junit] \tat org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:76)\n    [junit] \tat org.apache.lucene.util.LuceneTestCase$LuceneTestCaseRunner.runChild(LuceneTestCase.java:795)\n    [junit] \tat org.apache.lucene.util.LuceneTestCase$LuceneTestCaseRunner.runChild(LuceneTestCase.java:768)\n    [junit] \tat org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)\n    [junit] \tat org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)\n    [junit] \tat org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)\n    [junit] \tat org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)\n    [junit] \tat org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)\n    [junit] \tat org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)\n    [junit] \tat org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:31)\n    [junit] \tat org.junit.runners.ParentRunner.run(ParentRunner.java:236)\n    [junit] \tat junit.framework.JUnit4TestAdapter.run(JUnit4TestAdapter.java:39)\n    [junit] \tat org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:421)\n    [junit] \tat org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:912)\n    [junit] \tat org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:743)\n    [junit] \n    [junit] 15.10.2010 7:29:21 org.apache.solr.common.SolrException log\n    [junit] SEVERE: org.apache.solr.common.SolrException: Unknown query type 'func'\n    [junit] \tat org.apache.solr.core.SolrCore.getQueryPlugin(SolrCore.java:1474)\n    [junit] \tat org.apache.solr.search.QParser.getParser(QParser.java:286)\n    [junit] \tat org.apache.solr.search.QParser.subQuery(QParser.java:176)\n    [junit] \tat org.apache.solr.search.SolrQueryParser.getFieldQuery(SolrQueryParser.java:142)\n    [junit] Testsuite: org.apache.solr.analysis.SnowballPorterFilterFactoryTest\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.getFieldQuery(QueryParser.java:754)\n    [junit] Tests run: 3, Failures: 0, Errors: 0, Time elapsed: 0.02 sec\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.Term(QueryParser.java:1594)\n    [junit] \n    [junit] \tat org.apache.lucene.queryParser.QueryParser.Clause(QueryParser.java:1337)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.Query(QueryParser.java:1263)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.TopLevelQuery(QueryParser.java:1252)\n    [junit] \tat org.apache.lucene.queryParser.QueryParser.parse(QueryParser.java:208)\n    [junit] \tat org.apache.solr.search.LuceneQParser.parse(LuceneQParserPlugin.java:73)\n    [junit] \tat org.apache.solr.search.QParser.getQuery(QParser.java:142)\n    [junit] \tat org.apache.solr.handler.component.QueryComponent.prepare(QueryComponent.java:93)\n    [junit] \tat org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:210)\n    [junit] \tat org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:131)\n    [junit] \tat org.apache.solr.core.SolrCore.execute(SolrCore.java:1325)\n    [junit] \tat org.apache.solr.util.TestHarness.queryAndResponse(TestHarness.java:334)\n    [junit] \tat org.apache.solr.util.TestHarness.query(TestHarness.java:321)\n    [junit] \tat org.apache.solr.util.TestHarness.query(TestHarness.java:307)\n    [junit] \tat org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:317)\n    [junit] \tat org.apache.solr.TestTrie.testTrieDateRangeSearch(TestTrie.java:202)\n    [junit] \tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    [junit] \tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n    [junit] \tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    [junit] \tat java.lang.reflect.Method.invoke(Method.java:616)\n    [junit] \tat org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)\n    [junit] \tat org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)\n    [junit] \tat org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)\n    [junit] \tat org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)\n    [junit] \tat org.junit.rules.TestWatchman$1.evaluate(TestWatchman.java:48)\n    [junit] \tat org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)\n    [junit] \tat org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:31)\n    [junit] \tat org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:76)\n    [junit] \tat org.apache.lucene.util.LuceneTestCase$LuceneTestCaseRunner.runChild(LuceneTestCase.java:795)\n    [junit] \tat org.apache.lucene.util.LuceneTestCase$LuceneTestCaseRunner.runChild(LuceneTestCase.java:768)\n    [junit] \tat org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)\n    [junit] \tat org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)\n    [junit] \tat org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)\n    [junit] \tat org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)\n    [junit] \tat org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)\n    [junit] \tat org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)\n    [junit] \tat org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:31)\n    [junit] \tat org.junit.runners.ParentRunner.run(ParentRunner.java:236)\n    [junit] \tat junit.framework.JUnit4TestAdapter.run(JUnit4TestAdapter.java:39)\n    [junit] \tat org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:421)\n    [junit] \tat org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:912)\n    [junit] \tat org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:743)\n    [junit] \n    [junit] ------------- ---------------- ---------------\n    [junit] TEST org.apache.solr.TestTrie FAILED\n\n "
        },
        {
            "author": "Yonik Seeley",
            "id": "comment-12923445",
            "date": "2010-10-21T14:04:17+0000",
            "content": "I'm looping the tests on my ubuntu system now trying to reproduce this (solr tests now only take 2min!) "
        },
        {
            "author": "Robert Muir",
            "id": "comment-12923447",
            "date": "2010-10-21T14:07:10+0000",
            "content": "I too find this test hard to reproduce.\n\nBut, I think if we look at hudson logs it is all caused by SolrInfoMBeanTest.\n\nThe problem is that now this test only loads up src/java things, so the concern would be that its a real static or similar problem.\n\nI wish we could come up with a better way than SolrInfoMBeanTest to find problems since it makes debugging very difficult "
        },
        {
            "author": "Uwe Schindler",
            "id": "comment-12923449",
            "date": "2010-10-21T14:11:24+0000",
            "content": "The problem seems to be one of the solr classes that does some static initialization that depends e.g. on a SolrCore be available. If this class is initialized before (e.g. in SolrMBeanTest) and no SolrCore or other part is available, it fails. The SolrMBean test is not the bug, it's the class that does static initialization! How gets the func QP be enabled? Is the info about it cached in a static field? Something like that causes this issue. "
        },
        {
            "author": "Yonik Seeley",
            "id": "comment-12923455",
            "date": "2010-10-21T14:24:25+0000",
            "content": "The SolrMBean test is not the bug\n\nI'd say it's both a bug in some unknown class, and a bug in SolrMBean test.\nAssuming you can instantiate random classes in a random order w/o any side effects isn't a valid. "
        },
        {
            "author": "Uwe Schindler",
            "id": "comment-12923461",
            "date": "2010-10-21T14:40:30+0000",
            "content": "Its not always instantiating. Mostly, SolrMBean only loads the classes! So only statics are initialized. And that should be able to be done in random order. Especially could optimizers in the JVM do this (this is even allowed in the JLS). SolrMBean only instantiates classes with default ctor that implement this interface (this is a bug, you are right). But this problem seems to be more a static initializer bug.\n\nTo track this, we can temporarily disable the instantiation part of SolrMBean and only do the Class.forName() calls. If it then still fails its a real bug. If it does not fail then, the reason is SolrMBean. In all other cases, the static initializers run by Class.forName() use wrong assumptions! "
        },
        {
            "author": "Robert Muir",
            "id": "comment-12923462",
            "date": "2010-10-21T14:43:43+0000",
            "content": "Its not instantiating. SolrMBean only loads the classes!\n\nI disagree... unless I'm completely wrong about what Class.newInstance() does!\n\n\n    for( Class clazz : classes ) {\n      if( SolrInfoMBean.class.isAssignableFrom( clazz ) ) {\n        try {\n          SolrInfoMBean info = (SolrInfoMBean)clazz.newInstance();\n          \n          //System.out.println( info.getClass() );\n          assertNotNull( info.getName() );\n\n "
        },
        {
            "author": "Uwe Schindler",
            "id": "comment-12923465",
            "date": "2010-10-21T14:48:45+0000",
            "content": "See above I changed my original comment before you posted your reply - sorry.\n\nIt only instantiates few classes (which match the interface). Because of this I suggested at the end, to disable this instantiation temporarily. If it then does not fail, the bug is tracked to the instantiation. If it then also fails, you can be 10% sure that it is caused by static initialization.\n\nSorry for incomplete comment at the beginning! "
        },
        {
            "author": "Robert Muir",
            "id": "comment-12923466",
            "date": "2010-10-21T14:51:02+0000",
            "content": "Because of this I suggested at the end, to disable this instantiation temporarily.\n\nThis is a good idea for debugging. This is how i found it was meddling with \nTestReplicationHandler by only doing Class.forName(TestReplicationHandler) back \nwhen SolrInfoMBeanTest meddled with test classes too\n\nthe difference with that one was that it was easier to reproduce... this func() one is tricky! "
        },
        {
            "author": "Simon Willnauer",
            "id": "comment-12923808",
            "date": "2010-10-22T10:08:42+0000",
            "content": "FYI - I can reliably reproduce with running SolrInfoBeanTest first inthe same vm\n\n--- build.xml\t(revision 1025747)\n+++ build.xml\t(working copy)\n@@ -475,7 +475,7 @@\n         </fileset>\n       </batchtest>\n       <batchtest fork=\"yes\" todir=\"${junit.output.dir}\" if=\"testcase\">\n-        <fileset dir=\"src/test\" includes=\"**/${testcase}.java\"/>\n+        <fileset dir=\"src/test\" includes=\"**/SolrInfoMBeanTest.java, **/${testcase}.java\"/>\n       </batchtest>\n     </junit>\n \n\n\n\n\"ant test -Dtestcase=TestQueryTypes\" will then fail and this fixes the problem. Its a hack I know but it might help to find a solution.\n\n\nIndex: src/test/org/apache/solr/SolrInfoMBeanTest.java\n===================================================================\n--- src/test/org/apache/solr/SolrInfoMBeanTest.java\t(revision 1025719)\n+++ src/test/org/apache/solr/SolrInfoMBeanTest.java\t(working copy)\n@@ -42,6 +42,7 @@\n    * a name, description, etc...\n    */\n   public void testCallMBeanInfo() throws Exception {\n+    Object[] init = org.apache.solr.search.QParserPlugin.standardPlugins;\n     List<Class> classes = new ArrayList<Class>();\n     classes.addAll(getClassesForPackage(StandardRequestHandler.class.getPackage().getName()));\n     classes.addAll(getClassesForPackage(SearchHandler.class.getPackage().getName()));\n\n "
        },
        {
            "author": "Simon Willnauer",
            "id": "comment-12923813",
            "date": "2010-10-22T10:38:24+0000",
            "content": "Could we put @Ignore on the SolrInfoMBeanTest#testCallMBeanInfo() until this is fixed? I mean a stable build would be nice though  I use @Ignore on the DocValues branch and the build finally succeeds after continuously failing for 10 times\n\nsimon "
        },
        {
            "author": "Robert Muir",
            "id": "comment-12923882",
            "date": "2010-10-22T15:14:16+0000",
            "content": "Thanks for the reproducable case, Simon.\n\nUnfortunately, I don't think we should @Ignore this, this is a real bug.\n\nif you disable the instantiation itself (and just leave the Class.forName enabled), it still fails... "
        },
        {
            "author": "Yonik Seeley",
            "id": "comment-12924336",
            "date": "2010-10-24T15:47:51+0000",
            "content": "Grrr, I can't even run SolrInfoMBeanTest from by IDE.\njava.lang.AssertionError: there are at least 10 SolrInfoMBean that should be found in the classpath, found 0 "
        },
        {
            "author": "Uwe Schindler",
            "id": "comment-12924345",
            "date": "2010-10-24T16:15:55+0000",
            "content": "Grrr, I can't even run SolrInfoMBeanTest from by IDE. java.lang.AssertionError: there are at least 10 SolrInfoMBean that should be found in the classpath, found 0 \n\nThats because the test only works if the class files are physically on disk and not in JAR file. And IDEs have own classloaders to serve classes directly from their debugger. "
        },
        {
            "author": "Yonik Seeley",
            "id": "comment-12924346",
            "date": "2010-10-24T16:20:13+0000",
            "content": "I'm starting to think this may be a classloader issue.\nA SolrCore can have it's own classloader... and the SolrInfoMBeanTest loads the classes (I think) in the parent classloader. "
        },
        {
            "author": "Yonik Seeley",
            "id": "comment-12924349",
            "date": "2010-10-24T16:27:58+0000",
            "content": "If I change this test to be a Solr test, and use the classloader from the core, it seems to work. "
        },
        {
            "author": "Uwe Schindler",
            "id": "comment-12924357",
            "date": "2010-10-24T17:25:26+0000",
            "content": "Let's try it out? "
        },
        {
            "author": "Robert Muir",
            "id": "comment-12982349",
            "date": "2011-01-16T18:22:49+0000",
            "content": "pretty sure this one is fixed?\n\nHaven't seen any problems like this in quite some time. "
        },
        {
            "author": "Robert Muir",
            "id": "comment-12982831",
            "date": "2011-01-17T19:55:49+0000",
            "content": "Marking as fixed... please reopen if you think there might still be a bug, \nbut again I haven't seen issues in a very long time "
        },
        {
            "author": "Grant Ingersoll",
            "id": "comment-13013156",
            "date": "2011-03-30T15:45:43+0000",
            "content": "Bulk close for 3.1.0 release "
        }
    ]
}