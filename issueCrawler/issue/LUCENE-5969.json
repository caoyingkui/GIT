{
    "id": "LUCENE-5969",
    "title": "Add Lucene50Codec",
    "details": {
        "type": "Improvement",
        "priority": "Major",
        "labels": "",
        "resolution": "Fixed",
        "components": [],
        "affect_versions": "None",
        "status": "Closed",
        "fix_versions": [
            "5.0",
            "6.0"
        ]
    },
    "description": "Spinoff from LUCENE-5952:\n\n\n\tFix .si to write Version as 3 ints, not a String that requires parsing at read time.\n\n\n\n\n\tLucene42TermVectorsFormat should not use the same codecName as Lucene41StoredFieldsFormat\n\n\n\nIt would also be nice if we had a \"bumpCodecVersion\" script so rolling a new codec is not so daunting.",
    "attachments": {
        "LUCENE-5969_part2.patch": "https://issues.apache.org/jira/secure/attachment/12672942/LUCENE-5969_part2.patch",
        "LUCENE-5969_part3.patch": "https://issues.apache.org/jira/secure/attachment/12676316/LUCENE-5969_part3.patch",
        "LUCENE-5969.patch": "https://issues.apache.org/jira/secure/attachment/12670774/LUCENE-5969.patch"
    },
    "issue_links": {},
    "comments": [
        {
            "id": "comment-14142438",
            "author": "Robert Muir",
            "content": "I dont think we should do this wit a script. More care is needed. I already volunteered to do the bumping. Honestly if we want this to be easier, the fix is to remove or simplify all the crazy tests that need to manipulate the default codec directly. Why must they be so damn complicated like that? ",
            "date": "2014-09-21T12:38:54+0000"
        },
        {
            "id": "comment-14142533",
            "author": "Michael McCandless",
            "content": "Honestly if we want this to be easier, the fix is to remove or simplify all the crazy tests that need to manipulate the default codec directly. Why must they be so damn complicated like that?\n\n+1, I don't know why so many places must be changed when we move to a new codec ... ",
            "date": "2014-09-21T17:51:52+0000"
        },
        {
            "id": "comment-14143147",
            "author": "Robert Muir",
            "content": "I will try to clean this up some this morning before switching over any codec. Easy ones first. ",
            "date": "2014-09-22T12:30:00+0000"
        },
        {
            "id": "comment-14143150",
            "author": "ASF subversion and git services",
            "content": "Commit 1626753 from Robert Muir in branch 'dev/trunk'\n[ https://svn.apache.org/r1626753 ]\n\nLUCENE-5969: remove unnecessary code ",
            "date": "2014-09-22T12:31:52+0000"
        },
        {
            "id": "comment-14143151",
            "author": "ASF subversion and git services",
            "content": "Commit 1626754 from Robert Muir in branch 'dev/branches/branch_5x'\n[ https://svn.apache.org/r1626754 ]\n\nLUCENE-5969: remove unnecessary code ",
            "date": "2014-09-22T12:32:49+0000"
        },
        {
            "id": "comment-14143224",
            "author": "ASF subversion and git services",
            "content": "Commit 1626778 from Robert Muir in branch 'dev/trunk'\n[ https://svn.apache.org/r1626778 ]\n\nLUCENE-5969: add TestUtil.getDefaultCodec() ",
            "date": "2014-09-22T13:58:00+0000"
        },
        {
            "id": "comment-14143229",
            "author": "ASF subversion and git services",
            "content": "Commit 1626781 from Robert Muir in branch 'dev/branches/branch_5x'\n[ https://svn.apache.org/r1626781 ]\n\nLUCENE-5969: add TestUtil.getDefaultCodec() ",
            "date": "2014-09-22T14:09:10+0000"
        },
        {
            "id": "comment-14143258",
            "author": "ASF subversion and git services",
            "content": "Commit 1626794 from Robert Muir in branch 'dev/trunk'\n[ https://svn.apache.org/r1626794 ]\n\nLUCENE-5969: improve this test, we cant uncomment the assert until we fix 5.0 codec ",
            "date": "2014-09-22T14:48:08+0000"
        },
        {
            "id": "comment-14143261",
            "author": "ASF subversion and git services",
            "content": "Commit 1626796 from Robert Muir in branch 'dev/branches/branch_5x'\n[ https://svn.apache.org/r1626796 ]\n\nLUCENE-5969: improve this test, we cant uncomment the assert until we fix 5.0 codec ",
            "date": "2014-09-22T14:49:41+0000"
        },
        {
            "id": "comment-14143390",
            "author": "ASF subversion and git services",
            "content": "Commit 1626826 from Robert Muir in branch 'dev/trunk'\n[ https://svn.apache.org/r1626826 ]\n\nLUCENE-5969: let AssertingCodec implement RandomAccessOrds, and test it directly too ",
            "date": "2014-09-22T16:38:52+0000"
        },
        {
            "id": "comment-14143395",
            "author": "ASF subversion and git services",
            "content": "Commit 1626830 from Robert Muir in branch 'dev/branches/branch_5x'\n[ https://svn.apache.org/r1626830 ]\n\nLUCENE-5969: let AssertingCodec implement RandomAccessOrds, and test it directly too ",
            "date": "2014-09-22T16:42:44+0000"
        },
        {
            "id": "comment-14144129",
            "author": "ASF subversion and git services",
            "content": "Commit 1626921 from Robert Muir in branch 'dev/trunk'\n[ https://svn.apache.org/r1626921 ]\n\nLUCENE-5969: move bumping default codec/dv/pf in tests to TestUtil methods, put blocktreeords in rotation ",
            "date": "2014-09-23T00:52:40+0000"
        },
        {
            "id": "comment-14144144",
            "author": "ASF subversion and git services",
            "content": "Commit 1626922 from Robert Muir in branch 'dev/branches/branch_5x'\n[ https://svn.apache.org/r1626922 ]\n\nLUCENE-5969: move bumping default codec/dv/pf in tests to TestUtil methods, put blocktreeords in rotation ",
            "date": "2014-09-23T01:03:54+0000"
        },
        {
            "id": "comment-14145237",
            "author": "Robert Muir",
            "content": "Here is an initial patch.\n\nI already refactored tests so to bump the default codec/PF/DVF its much easier: you just change methods in TestUtil.\n\nI also added a check to TestAllFilesHaveCodecHeader to look for duplicate codec names (its commented out until we fix TVF). \n\nIn this patch, I added new infos formats (.SI and .FNM) that don't have all the confusing backwards version stuff. The fnm reader and writer (and checkindex) hard-check fieldinfos consistency on both read and write.\n\nAlso checkindex got a little cleanup, so that \"foreign\" readers (TestUtil.checkReader) get fieldinfos and livedocs validation, whereas they did not before.\n\nI added CodecUtil.checkFooter(input, Throwable) to give better exceptions when things are corrupt (e.g., it adds suppressed exception for checksum status), and cut over .SI/.FNM/.NVM/.DVM to use it. I also added standalone tests for this.\n\nI want to cutover other parts too (like .FDX, .TVX, ...) but we shouldnt use this method until we remove all the conditional versioning and cut \"clean\" versions (also without bogus codec ids), otherwise I think its confusing and potentially unsafe.\n\nHowever, I think we should start with this, to unblock Mike's cleanup of SI version handling and other work? I dont think we have to write 5.0's format in one day. \n\nAfter we are happy with 5.0 format, we can then cleanup the back compat (trunk doesnt need all the 4.x back compat, etc). ",
            "date": "2014-09-23T18:55:01+0000"
        },
        {
            "id": "comment-14145296",
            "author": "Michael McCandless",
            "content": "+1, this is fabulous! ",
            "date": "2014-09-23T19:30:27+0000"
        },
        {
            "id": "comment-14145544",
            "author": "Uwe Schindler",
            "content": "I fixed the forbidden issue in the process-webpages ant target in svn and made the comment \"generic\" (it was just a template). You can remove/resolve the conflict on svn up with \"use theirs\". ",
            "date": "2014-09-23T22:24:51+0000"
        },
        {
            "id": "comment-14145691",
            "author": "Robert Muir",
            "content": "Thanks Uwe, one less thing to update when bumping codec version, too. ",
            "date": "2014-09-24T00:28:28+0000"
        },
        {
            "id": "comment-14145718",
            "author": "ASF subversion and git services",
            "content": "Commit 1627187 from Robert Muir in branch 'dev/trunk'\n[ https://svn.apache.org/r1627187 ]\n\nLUCENE-5969: Add Lucene50Codec (infos, dv, norms) ",
            "date": "2014-09-24T00:59:51+0000"
        },
        {
            "id": "comment-14145765",
            "author": "ASF subversion and git services",
            "content": "Commit 1627189 from Robert Muir in branch 'dev/branches/branch_5x'\n[ https://svn.apache.org/r1627189 ]\n\nLUCENE-5969: Add Lucene50Codec (infos, dv, norms) ",
            "date": "2014-09-24T01:44:13+0000"
        },
        {
            "id": "comment-14146872",
            "author": "Uwe Schindler",
            "content": "Thanks Robert. Unfortunately I was not able to verify the full patch. But the changes with supressed exceptions looked fine. ",
            "date": "2014-09-24T20:58:43+0000"
        },
        {
            "id": "comment-14147637",
            "author": "ASF subversion and git services",
            "content": "Commit 1627517 from Robert Muir in branch 'dev/trunk'\n[ https://svn.apache.org/r1627517 ]\n\nLUCENE-5969: Lucene410Codec -> backwards ",
            "date": "2014-09-25T11:28:23+0000"
        },
        {
            "id": "comment-14147656",
            "author": "ASF subversion and git services",
            "content": "Commit 1627522 from Robert Muir in branch 'dev/branches/branch_5x'\n[ https://svn.apache.org/r1627522 ]\n\nLUCENE-5969: Lucene410Codec -> backwards ",
            "date": "2014-09-25T11:39:30+0000"
        },
        {
            "id": "comment-14147690",
            "author": "ASF subversion and git services",
            "content": "Commit 1627530 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1627530 ]\n\nLUCENE-5969: make branch for the heavy parts ",
            "date": "2014-09-25T12:32:35+0000"
        },
        {
            "id": "comment-14147718",
            "author": "ASF subversion and git services",
            "content": "Commit 1627535 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1627535 ]\n\nLUCENE-5969, LUCENE-5412: make .si immutable again, and make ancient writers read-only ",
            "date": "2014-09-25T13:16:17+0000"
        },
        {
            "id": "comment-14147752",
            "author": "ASF subversion and git services",
            "content": "Commit 1627544 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1627544 ]\n\nLUCENE-5969: file mismatch detection for 5.0 fnm ",
            "date": "2014-09-25T13:55:27+0000"
        },
        {
            "id": "comment-14147893",
            "author": "ASF subversion and git services",
            "content": "Commit 1627564 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1627564 ]\n\nLUCENE-5969: add AssertingLiveDocsFormat ",
            "date": "2014-09-25T15:58:08+0000"
        },
        {
            "id": "comment-14148164",
            "author": "ASF subversion and git services",
            "content": "Commit 1627593 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1627593 ]\n\nLUCENE-5969: improve checks for livedocs ",
            "date": "2014-09-25T19:12:41+0000"
        },
        {
            "id": "comment-14148330",
            "author": "ASF subversion and git services",
            "content": "Commit 1627669 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1627669 ]\n\nLUCENE-5969: beef up AssertingLiveDocs more ",
            "date": "2014-09-25T21:19:59+0000"
        },
        {
            "id": "comment-14148635",
            "author": "ASF subversion and git services",
            "content": "Commit 1627701 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1627701 ]\n\nLUCENE-5969: take bitvector out back and shoot it ",
            "date": "2014-09-26T02:22:19+0000"
        },
        {
            "id": "comment-14148793",
            "author": "ASF subversion and git services",
            "content": "Commit 1627714 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1627714 ]\n\nLUCENE-5969, LUCENE-5895: fix sign bit bugs in segment/commit IDs, use byte[] representation ",
            "date": "2014-09-26T05:20:45+0000"
        },
        {
            "id": "comment-14149281",
            "author": "ASF subversion and git services",
            "content": "Commit 1627805 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1627805 ]\n\nLUCENE-5969: add remaining infos/deletions safety ",
            "date": "2014-09-26T15:19:10+0000"
        },
        {
            "id": "comment-14149287",
            "author": "Robert Muir",
            "content": "Here is a difference between trunk and branch as a patch.\n\n\tfixed .si to be immutable again, so copySegmentAsIs doesn't rewrite it. Instead we strip segment prefixes just like .CFS (LUCENE-5412)\n\tdisabled write-access to all old .SI writers, its no longer needed.\n\tfixed segment/commit unique ID generation (bugs with sign bits). Also changed this to be a byte[] so it can be efficiently encoded.\n\tAdd CodecUtil.write/checkSegmentHeader, which is a regular header, plus the ID of the segment. This gives us mismatched files detection.\n\tbeefed up assertingcodec more, with assertinglivedocs\n\tadd lots of safety to .si/.fnm/.del\n\tmoved out cruft to backwards-codecs.\n\n\n\nI think this is a good point to merge, and then i will continue on with the other parts of the index. ",
            "date": "2014-09-26T15:26:26+0000"
        },
        {
            "id": "comment-14149305",
            "author": "Michael McCandless",
            "content": "+1, these are great improvements. ",
            "date": "2014-09-26T15:36:40+0000"
        },
        {
            "id": "comment-14150515",
            "author": "ASF subversion and git services",
            "content": "Commit 1627941 from Robert Muir in branch 'dev/trunk'\n[ https://svn.apache.org/r1627941 ]\n\nLUCENE-5969, LUCENE-5412: add more infos/metadata safety ",
            "date": "2014-09-27T09:57:40+0000"
        },
        {
            "id": "comment-14150520",
            "author": "ASF subversion and git services",
            "content": "Commit 1627943 from Robert Muir in branch 'dev/branches/branch_5x'\n[ https://svn.apache.org/r1627943 ]\n\nLUCENE-5969, LUCENE-5412: add more infos/metadata safety ",
            "date": "2014-09-27T10:23:25+0000"
        },
        {
            "id": "comment-14150522",
            "author": "ASF subversion and git services",
            "content": "Commit 1627944 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1627944 ]\n\nLUCENE-5969: delete branch ",
            "date": "2014-09-27T10:26:07+0000"
        },
        {
            "id": "comment-14150523",
            "author": "ASF subversion and git services",
            "content": "Commit 1627945 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1627945 ]\n\nLUCENE-5969: recreate branch ",
            "date": "2014-09-27T10:26:34+0000"
        },
        {
            "id": "comment-14150527",
            "author": "ASF subversion and git services",
            "content": "Commit 1627951 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1627951 ]\n\nLUCENE-5969: assert -> check ",
            "date": "2014-09-27T10:55:14+0000"
        },
        {
            "id": "comment-14150535",
            "author": "ASF subversion and git services",
            "content": "Commit 1627954 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1627954 ]\n\nLUCENE-5969: assert -> check ",
            "date": "2014-09-27T11:15:25+0000"
        },
        {
            "id": "comment-14150801",
            "author": "ASF subversion and git services",
            "content": "Commit 1628019 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1628019 ]\n\nLUCENE-5969: copy over cruft for back compat ",
            "date": "2014-09-27T22:44:46+0000"
        },
        {
            "id": "comment-14150807",
            "author": "ASF subversion and git services",
            "content": "Commit 1628024 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1628024 ]\n\nLUCENE-5969: remove some cruft, header -> segmentHeader ",
            "date": "2014-09-27T23:18:36+0000"
        },
        {
            "id": "comment-14150820",
            "author": "ASF subversion and git services",
            "content": "Commit 1628026 from Michael McCandless in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1628026 ]\n\nLUCENE-5969: cutover all merge implementations away from LeafReader[] to individual low-level producers ",
            "date": "2014-09-27T23:54:30+0000"
        },
        {
            "id": "comment-14151116",
            "author": "ASF subversion and git services",
            "content": "Commit 1628070 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1628070 ]\n\nLUCENE-5969: fix compile/javadocs, tighten up backwards codecs, add more safety to 5.x fields/vectors ",
            "date": "2014-09-28T14:36:03+0000"
        },
        {
            "id": "comment-14151120",
            "author": "ASF subversion and git services",
            "content": "Commit 1628073 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1628073 ]\n\nLUCENE-5969: add merge api ",
            "date": "2014-09-28T15:01:50+0000"
        },
        {
            "id": "comment-14151131",
            "author": "ASF subversion and git services",
            "content": "Commit 1628077 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1628077 ]\n\nLUCENE-5969: add missing checkIntegrity() calls for segments that cannot be bulk-merged ",
            "date": "2014-09-28T15:45:41+0000"
        },
        {
            "id": "comment-14153017",
            "author": "ASF subversion and git services",
            "content": "Commit 1628382 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1628382 ]\n\nLUCENE-5969: current state for dv/norms ",
            "date": "2014-09-30T09:37:53+0000"
        },
        {
            "id": "comment-14153046",
            "author": "ASF subversion and git services",
            "content": "Commit 1628386 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1628386 ]\n\nLUCENE-5969: add segment suffix safety ",
            "date": "2014-09-30T10:32:29+0000"
        },
        {
            "id": "comment-14153156",
            "author": "ASF subversion and git services",
            "content": "Commit 1628439 from Michael McCandless in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1628439 ]\n\nLUCENE-5969: fix nocommit ",
            "date": "2014-09-30T13:28:20+0000"
        },
        {
            "id": "comment-14154701",
            "author": "ASF subversion and git services",
            "content": "Commit 1628679 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1628679 ]\n\nLUCENE-5969: clean up unnecessary back compat and add segment header ",
            "date": "2014-10-01T11:54:06+0000"
        },
        {
            "id": "comment-14154713",
            "author": "ASF subversion and git services",
            "content": "Commit 1628684 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1628684 ]\n\nLUCENE-5969: clean up unnecessary back compat and add segment header ",
            "date": "2014-10-01T12:03:41+0000"
        },
        {
            "id": "comment-14154740",
            "author": "ASF subversion and git services",
            "content": "Commit 1628688 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1628688 ]\n\nLUCENE-5969: clean up unnecessary back compat and add segment header ",
            "date": "2014-10-01T12:27:12+0000"
        },
        {
            "id": "comment-14154758",
            "author": "ASF subversion and git services",
            "content": "Commit 1628692 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1628692 ]\n\nLUCENE-5969: more cleanups ",
            "date": "2014-10-01T12:50:04+0000"
        },
        {
            "id": "comment-14154771",
            "author": "ASF subversion and git services",
            "content": "Commit 1628697 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1628697 ]\n\nLUCENE-5969: give remaining codecs segment headers and cleanups ",
            "date": "2014-10-01T13:14:42+0000"
        },
        {
            "id": "comment-14154866",
            "author": "ASF subversion and git services",
            "content": "Commit 1628714 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1628714 ]\n\nLUCENE-5969: fix formats ",
            "date": "2014-10-01T14:30:14+0000"
        },
        {
            "id": "comment-14156130",
            "author": "ASF subversion and git services",
            "content": "Commit 1628889 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1628889 ]\n\nLUCENE-5969: start improving CFSDir ",
            "date": "2014-10-02T06:34:12+0000"
        },
        {
            "id": "comment-14156666",
            "author": "ASF subversion and git services",
            "content": "Commit 1628996 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1628996 ]\n\nLUCENE-5969: move CFS to codec ",
            "date": "2014-10-02T15:27:15+0000"
        },
        {
            "id": "comment-14156675",
            "author": "ASF subversion and git services",
            "content": "Commit 1629001 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1629001 ]\n\nLUCENE-5969: remove back compat ",
            "date": "2014-10-02T15:38:17+0000"
        },
        {
            "id": "comment-14156697",
            "author": "ASF subversion and git services",
            "content": "Commit 1629008 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1629008 ]\n\nLUCENE-5969: simplify cfs for 5.0 ",
            "date": "2014-10-02T16:09:14+0000"
        },
        {
            "id": "comment-14157618",
            "author": "ASF subversion and git services",
            "content": "Commit 1629105 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1629105 ]\n\nLUCENE-5969: don't use indexfilenames in these codecs ",
            "date": "2014-10-03T02:46:24+0000"
        },
        {
            "id": "comment-14157633",
            "author": "ASF subversion and git services",
            "content": "Commit 1629106 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1629106 ]\n\nLUCENE-5969: clear nocommit ",
            "date": "2014-10-03T03:17:57+0000"
        },
        {
            "id": "comment-14158029",
            "author": "ASF subversion and git services",
            "content": "Commit 1629207 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1629207 ]\n\nLUCENE-5969: add cfs to TestIWExceptions2 ",
            "date": "2014-10-03T14:24:23+0000"
        },
        {
            "id": "comment-14158247",
            "author": "ASF subversion and git services",
            "content": "Commit 1629272 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1629272 ]\n\nLUCENE-5969: start porting over tests to BaseCompoundFormatTestCase ",
            "date": "2014-10-03T17:55:54+0000"
        },
        {
            "id": "comment-14158370",
            "author": "ASF subversion and git services",
            "content": "Commit 1629288 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1629288 ]\n\nLUCENE-5969: add/port more tests ",
            "date": "2014-10-03T18:56:42+0000"
        },
        {
            "id": "comment-14158460",
            "author": "ASF subversion and git services",
            "content": "Commit 1629303 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1629303 ]\n\nLUCENE-5969: port two remaining TestCompoundFile tests ",
            "date": "2014-10-03T20:12:01+0000"
        },
        {
            "id": "comment-14158484",
            "author": "ASF subversion and git services",
            "content": "Commit 1629313 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1629313 ]\n\nLUCENE-5969: port remaining tests ",
            "date": "2014-10-03T20:30:18+0000"
        },
        {
            "id": "comment-14159104",
            "author": "ASF subversion and git services",
            "content": "Commit 1629380 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1629380 ]\n\nLUCENE-5969: don't open the cfs file twice ",
            "date": "2014-10-04T12:41:55+0000"
        },
        {
            "id": "comment-14159128",
            "author": "ASF subversion and git services",
            "content": "Commit 1629397 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1629397 ]\n\nLUCENE-5969: add SimpleText cfs ",
            "date": "2014-10-04T14:12:59+0000"
        },
        {
            "id": "comment-14159148",
            "author": "ASF subversion and git services",
            "content": "Commit 1629400 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1629400 ]\n\nLUCENE-5969: fix false fails from tests that look for exact file names ",
            "date": "2014-10-04T14:42:42+0000"
        },
        {
            "id": "comment-14159150",
            "author": "ASF subversion and git services",
            "content": "Commit 1629401 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1629401 ]\n\nLUCENE-5969: fix test to not rely upon filename count ",
            "date": "2014-10-04T14:55:08+0000"
        },
        {
            "id": "comment-14159172",
            "author": "ASF subversion and git services",
            "content": "Commit 1629404 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1629404 ]\n\nLUCENE-5969: improved exceptions for ancient codec ",
            "date": "2014-10-04T15:18:06+0000"
        },
        {
            "id": "comment-14159175",
            "author": "ASF subversion and git services",
            "content": "Commit 1629405 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1629405 ]\n\nLUCENE-5969: improve memory pf ",
            "date": "2014-10-04T15:29:01+0000"
        },
        {
            "id": "comment-14159179",
            "author": "ASF subversion and git services",
            "content": "Commit 1629406 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1629406 ]\n\nLUCENE-5969: javadocs ",
            "date": "2014-10-04T15:51:33+0000"
        },
        {
            "id": "comment-14159191",
            "author": "ASF subversion and git services",
            "content": "Commit 1629408 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1629408 ]\n\nLUCENE-5969: add changes and test ",
            "date": "2014-10-04T16:27:04+0000"
        },
        {
            "id": "comment-14159210",
            "author": "Robert Muir",
            "content": "I think the branch is currently in a good state to do an intermediate merge. Then we can tackle postings and docvalues.\nThis patch can be applied, but its large because of lots of svn moves.\n\n\n\tAll per-segment files are moved to write/checkSegmentHeader , and they also verify segment suffix/generation to fully detect mismatched files. I fixed all 5.0 (except dv/postings, still TODO) and all of codecs/ to do this.\n\tAll 5.0 init methods (except dv/postings, and a couple guys in codecs/: still TODO) use the new checkFooter(in, Throwable) to append suppressed checksum status if they hit corruption on open.\n\tCFS is moved to the codec API, with a write method that handles all files at once, and a read method that returns read-only directory view. Added a new simpler impl for 5.0, and a simpletext impl. Moved all CFS tests to BaseCompoundFormatTestCase which they all use. SegmentReader no longer opens the CFS file twice.\n\tMerging uses codec producer APIs instead of readers. This leads to more optimized merging: checksum computation is per-segment/per-producer, and norms and docvalues don't pile up unused fields into RAM during merge. If the fields are already loaded, they use them, but otherwise they load the field, but don't cache it. This is important not just for \"abuse\" cases, but should really improve use cases like offline indexing. I fixed all codecs (5.0, codecs/, backwards/) to not waste RAM like this.\n\t5.0 norms have a new indirect encoding for sparse fields. Currently this is very conservative as 1/31 to ensure its more efficient in terms of both space (maximum possible packedints bloat) and time (v log v < maxdoc).\n\tBackwards codecs are more contained: I tried to reduce visibility, make them as read-only as possible, ensure all files are deprecated, etc.\n\n ",
            "date": "2014-10-04T16:58:13+0000"
        },
        {
            "id": "comment-14159484",
            "author": "Michael McCandless",
            "content": "+1 to merge branch back, patch looks awesome. ",
            "date": "2014-10-05T09:23:23+0000"
        },
        {
            "id": "comment-14159496",
            "author": "Uwe Schindler",
            "content": "Cool! Very nice! I also checked how the \"conventional\" merging with a dumb foreign (filter) reader is wrapped and if its tested correctly  ",
            "date": "2014-10-05T10:10:46+0000"
        },
        {
            "id": "comment-14159529",
            "author": "ASF subversion and git services",
            "content": "Commit 1629499 from Robert Muir in branch 'dev/trunk'\n[ https://svn.apache.org/r1629499 ]\n\nLUCENE-5969: Lucene 5.0 codec, round two ",
            "date": "2014-10-05T14:01:15+0000"
        },
        {
            "id": "comment-14159543",
            "author": "ASF subversion and git services",
            "content": "Commit 1629501 from Robert Muir in branch 'dev/branches/branch_5x'\n[ https://svn.apache.org/r1629501 ]\n\nLUCENE-5969: Lucene 5.0 codec, round two ",
            "date": "2014-10-05T14:43:49+0000"
        },
        {
            "id": "comment-14159545",
            "author": "ASF subversion and git services",
            "content": "Commit 1629503 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1629503 ]\n\nLUCENE-5969: recreate branch for phase 3 ",
            "date": "2014-10-05T14:44:37+0000"
        },
        {
            "id": "comment-14173203",
            "author": "ASF subversion and git services",
            "content": "Commit 1632200 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1632200 ]\n\nLUCENE-5969: add 5.10 dv with segment header, CONST optimization, and missingBits ghostbuster ",
            "date": "2014-10-16T01:21:00+0000"
        },
        {
            "id": "comment-14173620",
            "author": "ASF subversion and git services",
            "content": "Commit 1632273 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1632273 ]\n\nLUCENE-5969: add tests ",
            "date": "2014-10-16T11:03:10+0000"
        },
        {
            "id": "comment-14175227",
            "author": "ASF subversion and git services",
            "content": "Commit 1632631 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1632631 ]\n\nLUCENE-5969: use sparsebitset to expand sparse encoding to cover more absurd cases ",
            "date": "2014-10-17T16:49:26+0000"
        },
        {
            "id": "comment-14175742",
            "author": "ASF subversion and git services",
            "content": "Commit 1632706 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1632706 ]\n\nLUCENE-5969: fix tests ",
            "date": "2014-10-18T00:19:31+0000"
        },
        {
            "id": "comment-14177251",
            "author": "ASF subversion and git services",
            "content": "Commit 1633196 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1633196 ]\n\nLUCENE-5969: move old postings back compat to backward-codecs, cleanup PBF related stuff, add segment headers, etc ",
            "date": "2014-10-20T18:25:53+0000"
        },
        {
            "id": "comment-14177376",
            "author": "ASF subversion and git services",
            "content": "Commit 1633211 from Michael McCandless in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1633211 ]\n\nLUCENE-5969: correct TODOs ",
            "date": "2014-10-20T19:47:35+0000"
        },
        {
            "id": "comment-14177378",
            "author": "ASF subversion and git services",
            "content": "Commit 1633212 from Michael McCandless in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1633212 ]\n\nLUCENE-5969: woops, revert ",
            "date": "2014-10-20T19:48:45+0000"
        },
        {
            "id": "comment-14177382",
            "author": "ASF subversion and git services",
            "content": "Commit 1633213 from Michael McCandless in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1633213 ]\n\nLUCENE-5969: correct TODOs ",
            "date": "2014-10-20T19:49:22+0000"
        },
        {
            "id": "comment-14178443",
            "author": "ASF subversion and git services",
            "content": "Commit 1633385 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1633385 ]\n\nLUCENE-5969: clean up constants ",
            "date": "2014-10-21T14:08:05+0000"
        },
        {
            "id": "comment-14178771",
            "author": "ASF subversion and git services",
            "content": "Commit 1633429 from Ryan Ernst in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1633429 ]\n\nLUCENE-5969: Copy block tree to backward codecs for 4.0-4.10, remove conditionals in 50 version, add getStats() TermsEnum API to remove need to expose Stats impl ",
            "date": "2014-10-21T18:15:33+0000"
        },
        {
            "id": "comment-14178930",
            "author": "ASF subversion and git services",
            "content": "Commit 1633441 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1633441 ]\n\nLUCENE-5969: move blocktree stats -> stats api ",
            "date": "2014-10-21T19:49:25+0000"
        },
        {
            "id": "comment-14178934",
            "author": "ASF subversion and git services",
            "content": "Commit 1633442 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1633442 ]\n\nLUCENE-5969: add missing @Override ",
            "date": "2014-10-21T19:51:10+0000"
        },
        {
            "id": "comment-14179033",
            "author": "ASF subversion and git services",
            "content": "Commit 1633451 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1633451 ]\n\nLUCENE-5969: fail precommit on typo'ed TODO ",
            "date": "2014-10-21T20:32:17+0000"
        },
        {
            "id": "comment-14179052",
            "author": "ASF subversion and git services",
            "content": "Commit 1633453 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1633453 ]\n\nLUCENE-5969: fix TOODs and add missing license header ",
            "date": "2014-10-21T20:38:59+0000"
        },
        {
            "id": "comment-14179109",
            "author": "ASF subversion and git services",
            "content": "Commit 1633465 from Ryan Ernst in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1633465 ]\n\nLUCENE-5969: Move bwc blocktree writer to test module, update 50 writer to use new header reading/writing ",
            "date": "2014-10-21T21:11:31+0000"
        },
        {
            "id": "comment-14179167",
            "author": "ASF subversion and git services",
            "content": "Commit 1633471 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1633471 ]\n\nLUCENE-5969: test that default codec uses segmentheader for all files. change .si to write its ID the same way for consistency ",
            "date": "2014-10-21T21:40:03+0000"
        },
        {
            "id": "comment-14179556",
            "author": "ASF subversion and git services",
            "content": "Commit 1633514 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1633514 ]\n\nLUCENE-5969: segmentHeader -> indexHeader, cut over segments_N, detect mismatched .si, consistency of encoding elsewhere ",
            "date": "2014-10-22T04:21:04+0000"
        },
        {
            "id": "comment-14179595",
            "author": "ASF subversion and git services",
            "content": "Commit 1633526 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1633526 ]\n\nLUCENE-5969: fix precommit, improve file format docs ",
            "date": "2014-10-22T05:13:53+0000"
        },
        {
            "id": "comment-14179859",
            "author": "ASF subversion and git services",
            "content": "Commit 1633607 from Robert Muir in branch 'dev/branches/lucene5969'\n[ https://svn.apache.org/r1633607 ]\n\nLUCENE-5969: tidy up format names to be consistent, add missing file formats doc ",
            "date": "2014-10-22T12:41:44+0000"
        },
        {
            "id": "comment-14179887",
            "author": "Robert Muir",
            "content": "Here is a patch for part 3. I think its ready, we should close the issue after this.\nOther improvements can be separate issues from here.\nAlso after resolving this issue and backporting, we can do further cleanups in trunk, and remove all the 4.x support in backwards-codecs and further cleanups in SegmentInfos. \n\nPatch finishes adding all safety (docvalues, terms, postings, commit points). CodecUtil \"segmentHeader\" is renamed to \"indexHeader\", as its used for all index files (including commit points). \n\nBlockTree doesn't \"backdoor\" via checkindex to return stats, there is a dead simple API for this.\n\nNorms sparse encoding is further improved with PATCHED strategy.\n\nThere is an API change for SegmentInfos for safety, instead of instance methods for reading read into \"mutable\" SIS:\n\nSegmentInfos.read(Dir);\nSegmentInfos.read(Dir, file);\n\n\n\nthese are now static methods that return a clean instance (and named readCommit and readLatestCommit respectively, to not be fragile on upgrade).\n\nThere is more to fix here, IMO SIS \"tries to take on too much\" (mutable state by IndexWriter, tracking of counters etc by IndexWriter, reading/writing commits, tries to be a \"low level user-friendly\" and too much publicly exposed dangers. This is all for a heavily versioned important file with conditional logic. But thats a bigger problem. ",
            "date": "2014-10-22T13:24:58+0000"
        },
        {
            "id": "comment-14179937",
            "author": "Michael McCandless",
            "content": "+1, looks great.  Wonderful to have full ID cross checking, and TOOD-banning. ",
            "date": "2014-10-22T14:14:04+0000"
        },
        {
            "id": "comment-14182347",
            "author": "ASF subversion and git services",
            "content": "Commit 1633991 from Robert Muir in branch 'dev/trunk'\n[ https://svn.apache.org/r1633991 ]\n\nLUCENE-5969: finish porting rest of codec to 5.0 features ",
            "date": "2014-10-24T02:43:44+0000"
        },
        {
            "id": "comment-14182378",
            "author": "ASF subversion and git services",
            "content": "Commit 1633993 from Robert Muir in branch 'dev/branches/branch_5x'\n[ https://svn.apache.org/r1633993 ]\n\nLUCENE-5969: finish porting rest of codec to 5.0 features ",
            "date": "2014-10-24T03:29:36+0000"
        },
        {
            "id": "comment-14182432",
            "author": "ASF subversion and git services",
            "content": "Commit 1633998 from Robert Muir in branch 'dev/trunk'\n[ https://svn.apache.org/r1633998 ]\n\nLUCENE-5969: remove 4.x back compat ",
            "date": "2014-10-24T04:48:16+0000"
        },
        {
            "id": "comment-14182831",
            "author": "ASF subversion and git services",
            "content": "Commit 1634064 from Robert Muir in branch 'dev/branches/branch_5x'\n[ https://svn.apache.org/r1634064 ]\n\nuse correct constants/javadocs refs (backport from LUCENE-5969) ",
            "date": "2014-10-24T14:27:59+0000"
        },
        {
            "id": "comment-14332689",
            "author": "Anshum Gupta",
            "content": "Bulk close after 5.0 release. ",
            "date": "2015-02-23T05:01:21+0000"
        }
    ]
}