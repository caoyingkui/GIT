{
    "id": "SOLR-12589",
    "title": "metrics name should not contains \"/\" path seperator while using SolrGangliaReporter",
    "details": {
        "labels": "",
        "priority": "Minor",
        "components": [
            "metrics"
        ],
        "type": "Bug",
        "fix_versions": [
            "master (8.0)"
        ],
        "affect_versions": "7.3.1,                                            7.4,                                            master (8.0)",
        "resolution": "Unresolved",
        "status": "Patch Available"
    },
    "description": "As I was using  SolrGangliaReporter,  default metrics names will contains \"/\", which is \noffen used in FileSystem as an seperator, than it encounters  ERROR cause creating \nmetrics data file failed,  bellow is the Exception in  /var/log/messages:\n\nJul 25 15:01:37 hb-bp1tg6t003y04p201-001 gmetad: Unable to write meta data for metric solr.node.QUERY.httpShardHandler.http_//hb-bp1tg6t003y04p201-003.hbase.rds.aliyuncs.com_8983/solr/admin/cores.post.requests.p999 to RRD\nJul 25 15:01:37 hb-bp1tg6t003y04p201-001 gmetad: RRD_create: creating '/var/lib/ganglia/rrds/_SummaryInfo_/solr.node.ADMIN./admin/cores.requestTimes.p999.rrd': No such file or directory\nJul 25 15:01:37 hb-bp1tg6t003y04p201-001 gmetad: Unable to write meta data for metric solr.node.ADMIN./admin/cores.requestTimes.p999 to RRD\nJul 25 15:01:37 localhost gmetad: RRD_create: creating '/var/lib/ganglia/rrds/_SummaryInfo_/solr.node.ADMIN./admin/collections.requestTimes.min.rrd': No such file or directory\nJul 25 15:01:37 localhost gmetad: Unable to write meta data for metric solr.node.ADMIN./admin/collections.requestTimes.min to RRD\nJul 25 15:01:37 localhost gmetad: RRD_create: creating '/var/lib/ganglia/rrds/_SummaryInfo_/solr.node.ADMIN./admin/authorization.requestTimes.stddev.rrd': No such file or directory\nJul 25 15:01:37 localhost gmetad: Unable to write meta data for metric solr.node.ADMIN./admin/authorization.requestTimes.stddev to RRD\nJul 25 15:01:37 localhost gmetad: RRD_create: creating '/var/lib/ganglia/rrds/_SummaryInfo_/solr.node.ADMIN./admin/autoscaling/history.requestTimes.p99.rrd': No such file or directory\nJul 25 15:01:37 localhost gmetad: Unable to write meta data for metric solr.node.ADMIN./admin/autoscaling/history.requestTimes.p99 to RRD\nJul 25 15:01:37 localhost gmetad: RRD_create: creating '/var/lib/ganglia/rrds/_SummaryInfo_/solr.node.QUERY./admin/autoscaling.timeouts.m1_rate.rrd': No such file or directory\n\n\nI think the metrics name should be normalized for different  reporter\uff0csuch as SolrGangliaReport.\nSome times other normalization is used for other reason\uff0cbut now\uff0cfor ganglia\uff0cIt must\nreplace the \"/\" .",
    "attachments": {
        "SOLR-12589-2.diff": "https://issues.apache.org/jira/secure/attachment/12933303/SOLR-12589-2.diff",
        "SOLR-12589-1.diff": "https://issues.apache.org/jira/secure/attachment/12933024/SOLR-12589-1.diff",
        "SOLR-12589-3.diff": "https://issues.apache.org/jira/secure/attachment/12933304/SOLR-12589-3.diff"
    },
    "issue_links": {},
    "comments": [
        {
            "date": "2018-07-25T22:18:57+0000",
            "content": "\n\n\n  -1 overall \n\n\n\n\n\n\n\n\n\n Vote \n Subsystem \n Runtime \n Comment \n\n\n 0 \n  patch  \n   0m  3s \n  The patch file was not named according to SOLR's naming conventions. Please see https://wiki.apache.org/solr/HowToContribute#Creating_the_patch_file for instructions.  \n\n\n\u00a0\n\u00a0\n\u00a0\n  Prechecks  \n\n\n -1 \n  test4tests  \n   0m  0s \n  The patch doesn't appear to include any new or modified tests. Please justify why no new tests are needed for this patch. Also please list what manual steps were performed to verify this patch.  \n\n\n\u00a0\n\u00a0\n\u00a0\n  master Compile Tests  \n\n\n +1 \n  compile  \n   3m 25s \n  master passed  \n\n\n\u00a0\n\u00a0\n\u00a0\n  Patch Compile Tests  \n\n\n +1 \n  compile  \n   3m  3s \n  the patch passed  \n\n\n +1 \n  javac  \n   3m  3s \n  the patch passed  \n\n\n +1 \n  Release audit (RAT)  \n   3m  3s \n  the patch passed  \n\n\n +1 \n  Check forbidden APIs  \n   3m  3s \n  the patch passed  \n\n\n +1 \n  Validate source patterns  \n   3m  3s \n  the patch passed  \n\n\n\u00a0\n\u00a0\n\u00a0\n  Other Tests  \n\n\n -1 \n  unit  \n  76m 54s \n  core in the patch failed.  \n\n\n  \n   \n  86m 59s \n   \n\n\n\n\n\n\n\n\n\n Reason \n Tests \n\n\n Failed junit tests \n solr.cloud.autoscaling.MetricTriggerTest \n\n\n\u00a0\n solr.servlet.HttpSolrCallGetCoreTest \n\n\n\u00a0\n solr.handler.admin.SegmentsInfoRequestHandlerTest \n\n\n\u00a0\n solr.cloud.autoscaling.SearchRateTriggerIntegrationTest \n\n\n\u00a0\n solr.cloud.DistribCursorPagingTest \n\n\n\u00a0\n solr.handler.admin.MetricsHandlerTest \n\n\n\u00a0\n solr.handler.admin.MBeansHandlerTest \n\n\n\u00a0\n solr.metrics.reporters.solr.SolrCloudReportersTest \n\n\n\u00a0\n solr.metrics.reporters.solr.SolrShardReporterTest \n\n\n\u00a0\n solr.cloud.autoscaling.TestPolicyCloud \n\n\n\u00a0\n solr.cloud.autoscaling.sim.TestTriggerIntegration \n\n\n\u00a0\n solr.core.RequestHandlersTest \n\n\n\u00a0\n solr.cloud.autoscaling.SearchRateTriggerTest \n\n\n\n\n\n\n\n\n\n Subsystem \n Report/Notes \n\n\n JIRA Issue \n SOLR-12589 \n\n\n JIRA Patch URL \n https://issues.apache.org/jira/secure/attachment/12933024/SOLR-12589-1.diff \n\n\n Optional Tests \n  compile  javac  unit  ratsources  checkforbiddenapis  validatesourcepatterns  \n\n\n uname \n Linux lucene2-us-west.apache.org 4.4.0-112-generic #135-Ubuntu SMP Fri Jan 19 11:48:36 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux \n\n\n Build tool \n ant \n\n\n Personality \n /home/jenkins/jenkins-slave/workspace/PreCommit-SOLR-Build/sourcedir/dev-tools/test-patch/lucene-solr-yetus-personality.sh \n\n\n git revision \n master / 71c0bdd \n\n\n ant \n version: Apache Ant(TM) version 1.9.6 compiled on July 20 2018 \n\n\n Default Java \n 1.8.0_172 \n\n\n unit \n https://builds.apache.org/job/PreCommit-SOLR-Build/151/artifact/out/patch-unit-solr_core.txt \n\n\n  Test Results \n https://builds.apache.org/job/PreCommit-SOLR-Build/151/testReport/ \n\n\n modules \n C: solr/core U: solr/core \n\n\n Console output \n https://builds.apache.org/job/PreCommit-SOLR-Build/151/console \n\n\n Powered by \n Apache Yetus 0.7.0   http://yetus.apache.org \n\n\n\n\n\n\nThis message was automatically generated.\n ",
            "author": "Lucene/Solr QA",
            "id": "comment-16556351"
        }
    ]
}