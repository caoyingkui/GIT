{
    "id": "SOLR-5724",
    "title": "Two node, one shard solr instance intermittently going offline",
    "details": {
        "affect_versions": "4.6.1",
        "status": "Closed",
        "fix_versions": [],
        "components": [],
        "type": "Bug",
        "priority": "Major",
        "labels": "",
        "resolution": "Incomplete"
    },
    "description": "One server is stuck in state \"recovering\" while the other is stuck in state \"down\". After waiting 45 minutes or so for the cluster to recover, the statuses were the same. \n\nLog messages on the \"recovering\" server: (Just the individual errors for brevity, I can provide full stack traces if that is helpful)\n\nWe are not the leader\nClusterState says we are the leader, but locally we don't think so\ncancelElection did not find election node to remove\nWe are not the leader\nNo registered leader was found, collection:listsC slice:shard1\nNo registered leader was found, collection:listsC slice:shard1\nOn the \"down\" server at the same timeframe:\n\norg.apache.solr.common.SolrException; forwarding update to http://10.0.2.48:8983/solr/listsC/ failed - retrying ... retries: 3\norg.apache.solr.update.StreamingSolrServers$1; error\nError while trying to recover. core=listsC:org.apache.solr.client.solrj.impl.HttpSolrServer$RemoteSolrException: We are not the leader\nRecovery failed - trying again... (0) core=listsC\nStopping recovery for zkNodeName=core_node2core=listsC\norg.apache.solr.update.StreamingSolrServers$1; error\norg.apache.solr.common.SolrException: Service Unavailable\nI am not sure what is causing this, however it has happened a 3 times in the past week. If there are any additional logs I can provide, or if there is anything I can do to try to figure this out myself I will gladly try to help.",
    "attachments": {},
    "issue_links": {},
    "comments": [
        {
            "author": "Yago Riveiro",
            "id": "comment-13900513",
            "date": "2014-02-13T17:17:59+0000",
            "content": "I have this issue too, the only way that I found to recover from this was restart the nodes. "
        },
        {
            "author": "Mark Miller",
            "id": "comment-13900598",
            "date": "2014-02-13T18:54:45+0000",
            "content": "I think more detailed log info would def help. "
        },
        {
            "author": "Joseph Duchesne",
            "id": "comment-13901543",
            "date": "2014-02-14T15:25:46+0000",
            "content": "Here are the logs from replica 1:\n\nERROR - 2014-02-13 13:39:01.159; org.apache.solr.common.SolrException; forwarding update to http://10.0.2.48:8983/solr/listsC/ failed - retrying ... retries: 12\nERROR - 2014-02-13 13:39:01.175; org.apache.solr.common.SolrException; Error while trying to recover. core=listsC:org.apache.solr.client.solrj.impl.HttpSolrServer$RemoteSolrException: We are not the leader\n        at org.apache.solr.client.solrj.impl.HttpSolrServer.request(HttpSolrServer.java:495)\n        at org.apache.solr.client.solrj.impl.HttpSolrServer.request(HttpSolrServer.java:199)\n        at org.apache.solr.cloud.RecoveryStrategy.sendPrepRecoveryCmd(RecoveryStrategy.java:224)\n        at org.apache.solr.cloud.RecoveryStrategy.doRecovery(RecoveryStrategy.java:371)\n        at org.apache.solr.cloud.RecoveryStrategy.run(RecoveryStrategy.java:247)\n\nERROR - 2014-02-13 13:39:01.175; org.apache.solr.cloud.RecoveryStrategy; Recovery failed - trying again... (0) core=listsC\nWARN  - 2014-02-13 13:39:01.180; org.apache.solr.cloud.RecoveryStrategy; Stopping recovery for zkNodeName=core_node2core=listsC\nERROR - 2014-02-13 13:39:01.183; org.apache.solr.update.StreamingSolrServers$1; error\norg.apache.solr.common.SolrException: Service Unavailable\n\n\n\nrequest: http://10.0.2.48:8983/solr/ABC/update?update.distrib=TOLEADER&distrib.from=http%3A%2F%2F10.0.0.156%3A8983%2Fsolr%2FABC%2F&wt=javabin&version=2\n        at org.apache.solr.client.solrj.impl.ConcurrentUpdateSolrServer$Runner.run(ConcurrentUpdateSolrServer.java:240)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:744)\nERROR - 2014-02-13 13:39:01.183; org.apache.solr.common.SolrException; forwarding update to http://10.0.2.48:8983/solr/ABC/ failed - retrying ... retries: 11\nERROR - 2014-02-13 13:39:01.271; org.apache.solr.update.StreamingSolrServers$1; error\norg.apache.solr.common.SolrException: Service Unavailable\n\n\n\nrequest: http://10.0.2.48:8983/solr/ABC/update?update.distrib=TOLEADER&distrib.from=http%3A%2F%2F10.0.0.156%3A8983%2Fsolr%2FABC%2F&wt=javabin&version=2\n        at org.apache.solr.client.solrj.impl.ConcurrentUpdateSolrServer$Runner.run(ConcurrentUpdateSolrServer.java:240)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:744)\nERROR - 2014-02-13 13:39:01.271; org.apache.solr.common.SolrException; forwarding update to http://10.0.2.48:8983/solr/ABC/ failed - retrying ... retries: 4\nERROR - 2014-02-13 13:39:01.340; org.apache.solr.update.StreamingSolrServers$1; error\norg.apache.solr.common.SolrException: Service Unavailable\n\n\n\nrequest: http://10.0.2.48:8983/solr/listsC/update?update.distrib=TOLEADER&distrib.from=http%3A%2F%2F10.0.0.156%3A8983%2Fsolr%2FlistsC%2F&wt=javabin&version=2\n        at org.apache.solr.client.solrj.impl.ConcurrentUpdateSolrServer$Runner.run(ConcurrentUpdateSolrServer.java:240)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:744)\nERROR - 2014-02-13 13:39:01.340; org.apache.solr.common.SolrException; forwarding update to http://10.0.2.48:8983/solr/listsC/ failed - retrying ... retries: 1\nERROR - 2014-02-13 13:39:01.409; org.apache.solr.update.StreamingSolrServers$1; error\norg.apache.solr.common.SolrException: Service Unavailable\n\n\n\nrequest: http://10.0.2.48:8983/solr/listsC/update?update.distrib=TOLEADER&distrib.from=http%3A%2F%2F10.0.0.156%3A8983%2Fsolr%2FlistsC%2F&wt=javabin&version=2\n        at org.apache.solr.client.solrj.impl.ConcurrentUpdateSolrServer$Runner.run(ConcurrentUpdateSolrServer.java:240)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:744)\nERROR - 2014-02-13 13:39:01.409; org.apache.solr.common.SolrException; forwarding update to http://10.0.2.48:8983/solr/listsC/ failed - retrying ... retries: 6\nERROR - 2014-02-13 13:39:01.648; org.apache.solr.update.StreamingSolrServers$1; error\norg.apache.solr.common.SolrException: Service Unavailable\n\n\n\nrequest: http://10.0.2.48:8983/solr/listsC/update?update.distrib=TOLEADER&distrib.from=http%3A%2F%2F10.0.0.156%3A8983%2Fsolr%2FlistsC%2F&wt=javabin&version=2\n        at org.apache.solr.client.solrj.impl.ConcurrentUpdateSolrServer$Runner.run(ConcurrentUpdateSolrServer.java:240)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:744)\nERROR - 2014-02-13 13:39:01.648; org.apache.solr.update.StreamingSolrServers$1; error\norg.apache.solr.common.SolrException: Service Unavailable\n\n\n\nrequest: http://10.0.2.48:8983/solr/listsC/update?update.distrib=TOLEADER&distrib.from=http%3A%2F%2F10.0.0.156%3A8983%2Fsolr%2FlistsC%2F&wt=javabin&version=2\n        at org.apache.solr.client.solrj.impl.ConcurrentUpdateSolrServer$Runner.run(ConcurrentUpdateSolrServer.java:240)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:744)\nERROR - 2014-02-13 13:39:01.648; org.apache.solr.common.SolrException; forwarding update to http://10.0.2.48:8983/solr/listsC/ failed - retrying ... retries: 2\nERROR - 2014-02-13 13:39:01.648; org.apache.solr.common.SolrException; forwarding update to http://10.0.2.48:8983/solr/listsC/ failed - retrying ... retries: 2\nERROR - 2014-02-13 13:39:01.663; org.apache.solr.update.StreamingSolrServers$1; error\norg.apache.solr.common.SolrException: Service Unavailable\n\n\n\nrequest: http://10.0.2.48:8983/solr/listsC/update?update.distrib=TOLEADER&distrib.from=http%3A%2F%2F10.0.0.156%3A8983%2Fsolr%2FlistsC%2F&wt=javabin&version=2\n        at org.apache.solr.client.solrj.impl.ConcurrentUpdateSolrServer$Runner.run(ConcurrentUpdateSolrServer.java:240)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:744)\nERROR - 2014-02-13 13:39:01.663; org.apache.solr.common.SolrException; forwarding update to http://10.0.2.48:8983/solr/listsC/ failed - retrying ... retries: 13\nERROR - 2014-02-13 13:39:01.687; org.apache.solr.update.StreamingSolrServers$1; error\norg.apache.solr.common.SolrException: Service Unavailable\n\n\n\nrequest: http://10.0.2.48:8983/solr/ABC/update?update.distrib=TOLEADER&distrib.from=http%3A%2F%2F10.0.0.156%3A8983%2Fsolr%2FABC%2F&wt=javabin&version=2\n        at org.apache.solr.client.solrj.impl.ConcurrentUpdateSolrServer$Runner.run(ConcurrentUpdateSolrServer.java:240)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:744)\nERROR - 2014-02-13 13:39:01.688; org.apache.solr.common.SolrException; forwarding update to http://10.0.2.48:8983/solr/ABC/ failed - retrying ... retries: 12\nERROR - 2014-02-13 13:39:01.776; org.apache.solr.update.StreamingSolrServers$1; error\norg.apache.solr.common.SolrException: Service Unavailable\n\n\n\nrequest: http://10.0.2.48:8983/solr/ABC/update?update.distrib=TOLEADER&distrib.from=http%3A%2F%2F10.0.0.156%3A8983%2Fsolr%2FABC%2F&wt=javabin&version=2\n        at org.apache.solr.client.solrj.impl.ConcurrentUpdateSolrServer$Runner.run(ConcurrentUpdateSolrServer.java:240)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:744)\nERROR - 2014-02-13 13:39:01.776; org.apache.solr.common.SolrException; forwarding update to http://10.0.2.48:8983/solr/ABC/ failed - retrying ... retries: 5\nERROR - 2014-02-13 13:39:01.845; org.apache.solr.update.StreamingSolrServers$1; error\norg.apache.solr.common.SolrException: Service Unavailable\n\n\n\nrequest: http://10.0.2.48:8983/solr/listsC/update?update.distrib=TOLEADER&distrib.from=http%3A%2F%2F10.0.0.156%3A8983%2Fsolr%2FlistsC%2F&wt=javabin&version=2\n        at org.apache.solr.client.solrj.impl.ConcurrentUpdateSolrServer$Runner.run(ConcurrentUpdateSolrServer.java:240)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:744)\nERROR - 2014-02-13 13:39:01.845; org.apache.solr.common.SolrException; forwarding update to http://10.0.2.48:8983/solr/listsC/ failed - retrying ... retries: 2\nERROR - 2014-02-13 13:39:01.913; org.apache.solr.update.StreamingSolrServers$1; error\norg.apache.solr.common.SolrException: Service Unavailable\n\n\n\nrequest: http://10.0.2.48:8983/solr/listsC/update?update.distrib=TOLEADER&distrib.from=http%3A%2F%2F10.0.0.156%3A8983%2Fsolr%2FlistsC%2F&wt=javabin&version=2\n        at org.apache.solr.client.solrj.impl.ConcurrentUpdateSolrServer$Runner.run(ConcurrentUpdateSolrServer.java:240)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:744)\nERROR - 2014-02-13 13:39:01.914; org.apache.solr.common.SolrException; forwarding update to http://10.0.2.48:8983/solr/listsC/ failed - retrying ... retries: 7\nERROR - 2014-02-13 13:39:02.153; org.apache.solr.update.StreamingSolrServers$1; error\norg.apache.solr.common.SolrException: Service Unavailable\n\n\n\nrequest: http://10.0.2.48:8983/solr/listsC/update?update.distrib=TOLEADER&distrib.from=http%3A%2F%2F10.0.0.156%3A8983%2Fsolr%2FlistsC%2F&wt=javabin&version=2\n        at org.apache.solr.client.solrj.impl.ConcurrentUpdateSolrServer$Runner.run(ConcurrentUpdateSolrServer.java:240)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:744)\nERROR - 2014-02-13 13:39:02.153; org.apache.solr.update.StreamingSolrServers$1; error\norg.apache.solr.common.SolrException: Service Unavailable\n\nAnd replica 2:\n\nERROR - 2014-02-13 13:39:01.143; org.apache.solr.common.SolrException; forwarding update to http://10.0.2.48:8983/solr/listsC/ failed - retrying ... retries: 1\nERROR - 2014-02-13 13:39:01.158; org.apache.solr.update.StreamingSolrServers$1; error\norg.apache.solr.common.SolrException: Service Unavailable\n\n\n\nrequest: http://10.0.2.48:8983/solr/listsC/update?update.distrib=TOLEADER&distrib.from=http%3A%2F%2F10.0.0.156%3A8983%2Fsolr%2FlistsC%2F&wt=javabin&version=2\n        at org.apache.solr.client.solrj.impl.ConcurrentUpdateSolrServer$Runner.run(ConcurrentUpdateSolrServer.java:240)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:744)\nERROR - 2014-02-13 13:39:01.159; org.apache.solr.common.SolrException; forwarding update to http://10.0.2.48:8983/solr/listsC/ failed - retrying ... retries: 12\nERROR - 2014-02-13 13:39:01.175; org.apache.solr.common.SolrException; Error while trying to recover. core=listsC:org.apache.solr.client.solrj.impl.HttpSolrServer$RemoteSolrException: We are not the leader\n        at org.apache.solr.client.solrj.impl.HttpSolrServer.request(HttpSolrServer.java:495)\n        at org.apache.solr.client.solrj.impl.HttpSolrServer.request(HttpSolrServer.java:199)\n        at org.apache.solr.cloud.RecoveryStrategy.sendPrepRecoveryCmd(RecoveryStrategy.java:224)\n        at org.apache.solr.cloud.RecoveryStrategy.doRecovery(RecoveryStrategy.java:371)\n        at org.apache.solr.cloud.RecoveryStrategy.run(RecoveryStrategy.java:247)\n\nERROR - 2014-02-13 13:39:01.175; org.apache.solr.cloud.RecoveryStrategy; Recovery failed - trying again... (0) core=listsC\nWARN  - 2014-02-13 13:39:01.180; org.apache.solr.cloud.RecoveryStrategy; Stopping recovery for zkNodeName=core_node2core=listsC\nERROR - 2014-02-13 13:39:01.183; org.apache.solr.update.StreamingSolrServers$1; error\norg.apache.solr.common.SolrException: Service Unavailable\n\n\n\nrequest: http://10.0.2.48:8983/solr/ABC/update?update.distrib=TOLEADER&distrib.from=http%3A%2F%2F10.0.0.156%3A8983%2Fsolr%2FABC%2F&wt=javabin&version=2\n        at org.apache.solr.client.solrj.impl.ConcurrentUpdateSolrServer$Runner.run(ConcurrentUpdateSolrServer.java:240)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:744)\nERROR - 2014-02-13 13:39:01.183; org.apache.solr.common.SolrException; forwarding update to http://10.0.2.48:8983/solr/ABC/ failed - retrying ... retries: 11\nERROR - 2014-02-13 13:39:01.271; org.apache.solr.update.StreamingSolrServers$1; error\norg.apache.solr.common.SolrException: Service Unavailable\n\n\n\nrequest: http://10.0.2.48:8983/solr/ABC/update?update.distrib=TOLEADER&distrib.from=http%3A%2F%2F10.0.0.156%3A8983%2Fsolr%2FABC%2F&wt=javabin&version=2\n        at org.apache.solr.client.solrj.impl.ConcurrentUpdateSolrServer$Runner.run(ConcurrentUpdateSolrServer.java:240)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:744)\nERROR - 2014-02-13 13:39:01.271; org.apache.solr.common.SolrException; forwarding update to http://10.0.2.48:8983/solr/ABC/ failed - retrying ... retries: 4\nERROR - 2014-02-13 13:39:01.340; org.apache.solr.update.StreamingSolrServers$1; error\norg.apache.solr.common.SolrException: Service Unavailable\n\n\n\nrequest: http://10.0.2.48:8983/solr/listsC/update?update.distrib=TOLEADER&distrib.from=http%3A%2F%2F10.0.0.156%3A8983%2Fsolr%2FlistsC%2F&wt=javabin&version=2\n        at org.apache.solr.client.solrj.impl.ConcurrentUpdateSolrServer$Runner.run(ConcurrentUpdateSolrServer.java:240)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:744)\nERROR - 2014-02-13 13:39:01.340; org.apache.solr.common.SolrException; forwarding update to http://10.0.2.48:8983/solr/listsC/ failed - retrying ... retries: 1\nERROR - 2014-02-13 13:39:01.409; org.apache.solr.update.StreamingSolrServers$1; error\norg.apache.solr.common.SolrException: Service Unavailable\n\n\n\nrequest: http://10.0.2.48:8983/solr/listsC/update?update.distrib=TOLEADER&distrib.from=http%3A%2F%2F10.0.0.156%3A8983%2Fsolr%2FlistsC%2F&wt=javabin&version=2\n        at org.apache.solr.client.solrj.impl.ConcurrentUpdateSolrServer$Runner.run(ConcurrentUpdateSolrServer.java:240)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:744)\nERROR - 2014-02-13 13:39:01.409; org.apache.solr.common.SolrException; forwarding update to http://10.0.2.48:8983/solr/listsC/ failed - retrying ... retries: 6\nERROR - 2014-02-13 13:39:01.648; org.apache.solr.update.StreamingSolrServers$1; error\norg.apache.solr.common.SolrException: Service Unavailable\n\n\n\nrequest: http://10.0.2.48:8983/solr/listsC/update?update.distrib=TOLEADER&distrib.from=http%3A%2F%2F10.0.0.156%3A8983%2Fsolr%2FlistsC%2F&wt=javabin&version=2\n        at org.apache.solr.client.solrj.impl.ConcurrentUpdateSolrServer$Runner.run(ConcurrentUpdateSolrServer.java:240)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:744)\nERROR - 2014-02-13 13:39:01.648; org.apache.solr.update.StreamingSolrServers$1; error\norg.apache.solr.common.SolrException: Service Unavailable\n\n\n\nrequest: http://10.0.2.48:8983/solr/listsC/update?update.distrib=TOLEADER&distrib.from=http%3A%2F%2F10.0.0.156%3A8983%2Fsolr%2FlistsC%2F&wt=javabin&version=2\n        at org.apache.solr.client.solrj.impl.ConcurrentUpdateSolrServer$Runner.run(ConcurrentUpdateSolrServer.java:240)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:744)\nERROR - 2014-02-13 13:39:01.648; org.apache.solr.common.SolrException; forwarding update to http://10.0.2.48:8983/solr/listsC/ failed - retrying ... retries: 2\nERROR - 2014-02-13 13:39:01.648; org.apache.solr.common.SolrException; forwarding update to http://10.0.2.48:8983/solr/listsC/ failed - retrying ... retries: 2\nERROR - 2014-02-13 13:39:01.663; org.apache.solr.update.StreamingSolrServers$1; error\norg.apache.solr.common.SolrException: Service Unavailable\n\n\n\nrequest: http://10.0.2.48:8983/solr/listsC/update?update.distrib=TOLEADER&distrib.from=http%3A%2F%2F10.0.0.156%3A8983%2Fsolr%2FlistsC%2F&wt=javabin&version=2\n        at org.apache.solr.client.solrj.impl.ConcurrentUpdateSolrServer$Runner.run(ConcurrentUpdateSolrServer.java:240)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:744)\nERROR - 2014-02-13 13:39:01.663; org.apache.solr.common.SolrException; forwarding update to http://10.0.2.48:8983/solr/listsC/ failed - retrying ... retries: 13\nERROR - 2014-02-13 13:39:01.687; org.apache.solr.update.StreamingSolrServers$1; error\norg.apache.solr.common.SolrException: Service Unavailable\n\n\n\nrequest: http://10.0.2.48:8983/solr/ABC/update?update.distrib=TOLEADER&distrib.from=http%3A%2F%2F10.0.0.156%3A8983%2Fsolr%2FABC%2F&wt=javabin&version=2\n        at org.apache.solr.client.solrj.impl.ConcurrentUpdateSolrServer$Runner.run(ConcurrentUpdateSolrServer.java:240)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:744)\nERROR - 2014-02-13 13:39:01.688; org.apache.solr.common.SolrException; forwarding update to http://10.0.2.48:8983/solr/ABC/ failed - retrying ... retries: 12\nERROR - 2014-02-13 13:39:01.776; org.apache.solr.update.StreamingSolrServers$1; error\norg.apache.solr.common.SolrException: Service Unavailable\n\n\n\nrequest: http://10.0.2.48:8983/solr/ABC/update?update.distrib=TOLEADER&distrib.from=http%3A%2F%2F10.0.0.156%3A8983%2Fsolr%2FABC%2F&wt=javabin&version=2\n        at org.apache.solr.client.solrj.impl.ConcurrentUpdateSolrServer$Runner.run(ConcurrentUpdateSolrServer.java:240)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:744)\nERROR - 2014-02-13 13:39:01.776; org.apache.solr.common.SolrException; forwarding update to http://10.0.2.48:8983/solr/ABC/ failed - retrying ... retries: 5\nERROR - 2014-02-13 13:39:01.845; org.apache.solr.update.StreamingSolrServers$1; error\norg.apache.solr.common.SolrException: Service Unavailable\n\n\n\nrequest: http://10.0.2.48:8983/solr/listsC/update?update.distrib=TOLEADER&distrib.from=http%3A%2F%2F10.0.0.156%3A8983%2Fsolr%2FlistsC%2F&wt=javabin&version=2\n        at org.apache.solr.client.solrj.impl.ConcurrentUpdateSolrServer$Runner.run(ConcurrentUpdateSolrServer.java:240)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:744)\nERROR - 2014-02-13 13:39:01.845; org.apache.solr.common.SolrException; forwarding update to http://10.0.2.48:8983/solr/listsC/ failed - retrying ... retries: 2\nERROR - 2014-02-13 13:39:01.913; org.apache.solr.update.StreamingSolrServers$1; error\norg.apache.solr.common.SolrException: Service Unavailable\n\n\n\nrequest: http://10.0.2.48:8983/solr/listsC/update?update.distrib=TOLEADER&distrib.from=http%3A%2F%2F10.0.0.156%3A8983%2Fsolr%2FlistsC%2F&wt=javabin&version=2\n        at org.apache.solr.client.solrj.impl.ConcurrentUpdateSolrServer$Runner.run(ConcurrentUpdateSolrServer.java:240)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:744)\nERROR - 2014-02-13 13:39:01.914; org.apache.solr.common.SolrException; forwarding update to http://10.0.2.48:8983/solr/listsC/ failed - retrying ... retries: 7\nERROR - 2014-02-13 13:39:02.153; org.apache.solr.update.StreamingSolrServers$1; error\norg.apache.solr.common.SolrException: Service Unavailable\n\n\n\nrequest: http://10.0.2.48:8983/solr/listsC/update?update.distrib=TOLEADER&distrib.from=http%3A%2F%2F10.0.0.156%3A8983%2Fsolr%2FlistsC%2F&wt=javabin&version=2\n        at org.apache.solr.client.solrj.impl.ConcurrentUpdateSolrServer$Runner.run(ConcurrentUpdateSolrServer.java:240)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:744)\nERROR - 2014-02-13 13:39:02.153; org.apache.solr.update.StreamingSolrServers$1; error\norg.apache.solr.common.SolrException: Service Unavailable\n\n\n\nrequest: http://10.0.2.48:8983/solr/listsC/update?update.distrib=TOLEADER&distrib.from=http%3A%2F%2F10.0.0.156%3A8983%2Fsolr%2FlistsC%2F&wt=javabin&version=2\n        at org.apache.solr.client.solrj.impl.ConcurrentUpdateSolrServer$Runner.run(ConcurrentUpdateSolrServer.java:240)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:744)\nERROR - 2014-02-13 13:39:02.153; org.apache.solr.common.SolrException; forwarding update to http://10.0.2.48:8983/solr/listsC/ failed - retrying ... retries: 3\nERROR - 2014-02-13 13:39:02.153; org.apache.solr.common.SolrException; forwarding update to http://10.0.2.48:8983/solr/listsC/ failed - retrying ... retries: 3\nERROR - 2014-02-13 13:39:02.167; org.apache.solr.update.StreamingSolrServers$1; error\norg.apache.solr.common.SolrException: Service Unavailable\n\n\n\nI have saved the full log files, but they're over 4MB each. "
        },
        {
            "author": "Mark Miller",
            "id": "comment-13901564",
            "date": "2014-02-14T15:39:20+0000",
            "content": "Anyway you could share them with me? Via Gmail or something? "
        },
        {
            "author": "Joseph Duchesne",
            "id": "comment-13901574",
            "date": "2014-02-14T15:55:55+0000",
            "content": "I just emailed you the log files (via your posted gmail). "
        },
        {
            "author": "haedrig",
            "id": "comment-15273752",
            "date": "2016-05-06T07:28:52+0000",
            "content": "Hello, I have encountered the same problem, I would like to ask you to solve it? Solr 4.7.2 "
        },
        {
            "author": "Shawn Heisey",
            "id": "comment-15274153",
            "date": "2016-05-06T14:50:17+0000",
            "content": "With the recent release of 6.0.0, 4.x is effectively dead.\n\nOnly major security issues and showstopper problems without a workaround will receive any attention ... and even those might not actually be fixed in 4.x.  Only 5.x (on a limited basis) and 6.x are likely to get changes now.  If any fixes do happen in 4.x, they will only happen in 4.10.x, not 4.7.x. "
        },
        {
            "author": "Forest Soup",
            "id": "comment-15434430",
            "date": "2016-08-24T08:00:21+0000",
            "content": "I found the similar issue in Solr v5.3.2 -  \nWe have a solrcloud with 3 solr nodes, 80 collections are created on them with replicateFactor=1, and shardNum=1 for each collection.\n\nAfter the collections creation, all cores are active, we start first batch of index with SolrJ client. But we found issues on all collections of one of the 3 solr nodes, and index failure due to HTTP 503:\n\n2016-08-16 20:02:05.660 ERROR (qtp208437930-70) [c:collection4 s:shard1 r:core_node1 x:collection4_shard1_replica1] o.a.s.u.p.DistributedUpdateProcessor ClusterState says we are the leader, but locally we don't think so\n2016-08-16 20:02:05.667 ERROR (qtp208437930-70) [c:collection4 s:shard1 r:core_node1 x:collection4_shard1_replica1] o.a.s.c.SolrCore org.apache.solr.common.SolrException: ClusterState says we are the leader (https://host1.domain1:8983/solr/collection4_shard1_replica1), but locally we don't think so. Request came from null\n\tat org.apache.solr.update.processor.DistributedUpdateProcessor.doDefensiveChecks(DistributedUpdateProcessor.java:619)\n\tat org.apache.solr.update.processor.DistributedUpdateProcessor.setupRequest(DistributedUpdateProcessor.java:381)\n\tat org.apache.solr.update.processor.DistributedUpdateProcessor.setupRequest(DistributedUpdateProcessor.java:314)\n\tat org.apache.solr.update.processor.DistributedUpdateProcessor.processAdd(DistributedUpdateProcessor.java:665)\n\tat org.apache.solr.handler.loader.JsonLoader$SingleThreadedJsonLoader.processUpdate(JsonLoader.java:143)\n\tat org.apache.solr.handler.loader.JsonLoader$SingleThreadedJsonLoader.load(JsonLoader.java:113)\n\tat org.apache.solr.handler.loader.JsonLoader.load(JsonLoader.java:76)\n\tat org.apache.solr.handler.UpdateRequestHandler$1.load(UpdateRequestHandler.java:98)\n\tat org.apache.solr.handler.ContentStreamHandlerBase.handleRequestBody(ContentStreamHandlerBase.java:74)\n\tat org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:143)\n\tat org.apache.solr.core.SolrCore.execute(SolrCore.java:2068)\n\tat org.apache.solr.servlet.HttpSolrCall.execute(HttpSolrCall.java:672)\n\tat org.apache.solr.servlet.HttpSolrCall.call(HttpSolrCall.java:463)\n\tat org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:235)\n\tat org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:199)\n\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)\n\tat org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:585)\n\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)\n\tat org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:577)\n\tat org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:223)\n\tat org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1127)\n\tat org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:515)\n\tat org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)\n\tat org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1061)\n\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)\n\tat org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:215)\n\tat org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:110)\n\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:97)\n\tat org.eclipse.jetty.server.Server.handle(Server.java:499)\n\tat org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:310)\n\tat org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:257)\n\tat org.eclipse.jetty.io.AbstractConnection$2.run(AbstractConnection.java:540)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:635)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:555)\n\tat java.lang.Thread.run(Thread.java:745)\n\nThe collections on the other 2 solr nodes works fine and index succeeded. "
        },
        {
            "author": "Jan H\u00f8ydahl",
            "id": "comment-15434555",
            "date": "2016-08-24T09:12:30+0000",
            "content": "Closing this issue as \"Incomplete\", as this is not the right channel to report general production problems, and there is not enough information provided to say that it is a bug.\n\nPlease start a mail thread on the solr-user mailing list and provide more detailed information about your setup, OS, memory, network details, configuration, logs etc, and then if we later believe this is due to a new bug, we'll open a more targeted JIRA. "
        }
    ]
}