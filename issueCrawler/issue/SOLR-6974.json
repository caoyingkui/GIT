{
    "id": "SOLR-6974",
    "title": "Rare DistribCursorPagingTest fail.",
    "details": {
        "components": [],
        "type": "Test",
        "labels": "",
        "fix_versions": [],
        "affect_versions": "None",
        "status": "Open",
        "resolution": "Unresolved",
        "priority": "Major"
    },
    "description": "[junit4] FAILURE 20.6s J1 | DistribCursorPagingTest.testDistribSearch <<<\n   [junit4]    > Throwable #1: java.lang.AssertionError: Expected 175 docs but got 174. sort=date asc, id asc. Missing doc(s): {id=24, int=1333046113, int_last=1333046113, int_first=1333046113, int_dv=1333046113, int_dv_last=1333046113, int_dv_first=1333046113, long=-7383857586581720524, long_last=-7383857586581720524, long_first=-7383857586581720524, long_dv=-7383857586581720524, long_dv_last=-7383857586581720524, long_dv_first=-7383857586581720524, float=-1.42734605E9, float_last=-1.42734605E9, float_first=-1.42734605E9, float_dv=-1.42734605E9, float_dv_last=-1.42734605E9, float_dv_first=-1.42734605E9, double=9.341152841954268E8, double_last=9.341152841954268E8, double_first=9.341152841954268E8, double_dv=9.341152841954268E8, double_dv_last=9.341152841954268E8, double_dv_first=9.341152841954268E8, str=\u174d\u175f\u1752\u175d\u1743\u1748\u175f\u1754\u1743, str_last=\u174d\u175f\u1752\u175d\u1743\u1748\u175f\u1754\u1743, str_first=\u174d\u175f\u1752\u175d\u1743\u1748\u175f\u1754\u1743, str_dv=\u174d\u175f\u1752\u175d\u1743\u1748\u175f\u1754\u1743, str_dv_last=\u174d\u175f\u1752\u175d\u1743\u1748\u175f\u1754\u1743, str_dv_first=\u174d\u175f\u1752\u175d\u1743\u1748\u175f\u1754\u1743, collation_en_primary_last=\u174d\u175f\u1752\u175d\u1743\u1748\u175f\u1754\u1743, collation_en_primary_first=\u174d\u175f\u1752\u175d\u1743\u1748\u175f\u1754\u1743, collation_en_primary_dv=\u174d\u175f\u1752\u175d\u1743\u1748\u175f\u1754\u1743, collation_en_primary_dv_last=\u174d\u175f\u1752\u175d\u1743\u1748\u175f\u1754\u1743, collation_en_primary_dv_first=\u174d\u175f\u1752\u175d\u1743\u1748\u175f\u1754\u1743, icu_collation_en_primary_last=\u174d\u175f\u1752\u175d\u1743\u1748\u175f\u1754\u1743, icu_collation_en_primary_first=\u174d\u175f\u1752\u175d\u1743\u1748\u175f\u1754\u1743, icu_collation_en_primary_dv=\u174d\u175f\u1752\u175d\u1743\u1748\u175f\u1754\u1743, icu_collation_en_primary_dv_last=\u174d\u175f\u1752\u175d\u1743\u1748\u175f\u1754\u1743, icu_collation_en_primary_dv_first=\u174d\u175f\u1752\u175d\u1743\u1748\u175f\u1754\u1743, bin=GAl49bogqVc2azE3jET0ZiKX6RguTCn2Zfj3, bin_last=GAl49bogqVc2azE3jET0ZiKX6RguTCn2Zfj3, bin_first=GAl49bogqVc2azE3jET0ZiKX6RguTCn2Zfj3, bin_dv=GAl49bogqVc2azE3jET0ZiKX6RguTCn2Zfj3, bin_dv_last=GAl49bogqVc2azE3jET0ZiKX6RguTCn2Zfj3, bin_dv_first=GAl49bogqVc2azE3jET0ZiKX6RguTCn2Zfj3, date=Sun Nov 12 13:09:05 AST 26752152, date_last=Sun Nov 12 13:09:05 AST 26752152, date_first=Sun Nov 12 13:09:05 AST 26752152, date_dv=Sun Nov 12 13:09:05 AST 26752152, date_dv_last=Sun Nov 12 13:09:05 AST 26752152, date_dv_first=Sun Nov 12 13:09:05 AST 26752152, uuid=87c177fc-0bc6-4bca-a77d-6039a90f47a5, uuid_last=87c177fc-0bc6-4bca-a77d-6039a90f47a5, uuid_first=87c177fc-0bc6-4bca-a77d-6039a90f47a5, uuid_dv=87c177fc-0bc6-4bca-a77d-6039a90f47a5, uuid_dv_last=87c177fc-0bc6-4bca-a77d-6039a90f47a5, uuid_dv_first=87c177fc-0bc6-4bca-a77d-6039a90f47a5, currency=5424307.49,NOK, currency_last=5424307.49,NOK, currency_first=5424307.49,NOK, bool=false, bool_last=false, bool_first=false, enum=Critical, enum_last=Critical, enum_first=Critical, _version_=1490217383853293568}; \n   [junit4]    > \tat __randomizedtesting.SeedInfo.seed([F7E227163CF214D3:7604A90E4BAD74EF]:0)\n   [junit4]    > \tat org.apache.solr.cloud.DistribCursorPagingTest.doRandomSortsOnLargeIndex(DistribCursorPagingTest.java:563)\n   [junit4]    > \tat org.apache.solr.cloud.DistribCursorPagingTest.doTest(DistribCursorPagingTest.java:87)\n   [junit4]    > \tat org.apache.solr.BaseDistributedSearchTestCase.testDistribSearch(BaseDistributedSearchTestCase.java:868)\n   [junit4]    > \tat java.lang.Thread.run(Thread.java:745)",
    "attachments": {
        "fail.log": "https://issues.apache.org/jira/secure/attachment/12692042/fail.log",
        "fail2.log": "https://issues.apache.org/jira/secure/attachment/12749661/fail2.log"
    },
    "issue_links": {},
    "comments": [
        {
            "date": "2015-08-10T18:44:28+0000",
            "author": "Steve Rowe",
            "content": "My Jenkins had a DistribCursorPagingTest failure, different from the one Mark posted on this issue.  Posting here because I can't reproduce after 35 trials on OS X:\n\n\n   [junit4]   2> NOTE: reproduce with: ant test  -Dtestcase=DistribCursorPagingTest -Dtests.method=test -Dtests.seed=BD12F0C1B5AE89D3 -Dtests.slow=true -Dtests.locale=es_US -Dtests.timezone=MET -Dtests.asserts=true -Dtests.file.encoding=US-ASCII\n   [junit4] FAILURE 36.7s J1  | DistribCursorPagingTest.test <<<\n   [junit4]    > Throwable #1: java.lang.AssertionError: ({params(q=float%3A%5B0+TO+*%5D+int%3A7+id%3A6&rows=3&sort=score+desc%2C+id+desc),defaults(cursorMark=AoIIPdn6IEU%3D)}) walk already seen: 5, don't know why; q=id:5 gives: {responseHeader={status=0,QTime=15},response={numFound=1,start=0,maxScore=2.098612,docs=[SolrDocument{id=5, str=b, str_last=b, str_first=b, str_dv=b, str_dv_last=b, str_dv_first=b, collation_en_primary_last=b, collation_en_primary_first=b, collation_en_primary_dv=b, collation_en_primary_dv_last=b, collation_en_primary_dv_first=b, icu_collation_en_primary_last=b, icu_collation_en_primary_first=b, icu_collation_en_primary_dv=b, icu_collation_en_primary_dv_last=b, icu_collation_en_primary_dv_first=b, float=64.5, float_last=64.5, float_first=64.5, float_dv=64.5, float_dv_last=64.5, float_dv_first=64.5, int=2001, int_last=2001, int_first=2001, int_dv=2001, int_dv_last=2001, int_dv_first=2001, _version_=1509136007691239424}]}}\n   [junit4]    > \tat __randomizedtesting.SeedInfo.seed([BD12F0C1B5AE89D3:3546CF1B1B52E42B]:0)\n   [junit4]    > \tat org.apache.solr.cloud.DistribCursorPagingTest.assertFullWalkNoDups(DistribCursorPagingTest.java:743)\n   [junit4]    > \tat org.apache.solr.cloud.DistribCursorPagingTest.doSimpleTest(DistribCursorPagingTest.java:464)\n   [junit4]    > \tat org.apache.solr.cloud.DistribCursorPagingTest.test(DistribCursorPagingTest.java:89)\n   [junit4]    > \tat org.apache.solr.BaseDistributedSearchTestCase$ShardsRepeatRule$ShardsFixedStatement.callStatement(BaseDistributedSearchTestCase.java:963)\n   [junit4]    > \tat org.apache.solr.BaseDistributedSearchTestCase$ShardsRepeatRule$ShardsStatement.evaluate(BaseDistributedSearchTestCase.java:938)\n   [junit4]    > \tat java.lang.Thread.run(Thread.java:745)\n\n ",
            "id": "comment-14680540"
        },
        {
            "date": "2015-09-08T20:59:20+0000",
            "author": "Steve Rowe",
            "content": "Yet another, different, fail on ASF Jenkins https://builds.apache.org/job/Lucene-Solr-Tests-trunk-Java8/377/, again does not reproduce for me on OS X:\n\n\n   [junit4]   2> NOTE: reproduce with: ant test  -Dtestcase=DistribCursorPagingTest -Dtests.method=test -Dtests.seed=3A0D3EFE9E0FFC60 -Dtests.multiplier=2 -Dtests.slow=true -Dtests.locale= -Dtests.timezone=Europe/Belfast -Dtests.asserts=true -Dtests.file.encoding=US-ASCII\n   [junit4] FAILURE 55.0s J1 | DistribCursorPagingTest.test <<<\n   [junit4]    > Throwable #1: java.lang.AssertionError: expected:<1264> but was:<902>\n   [junit4]    > \tat __randomizedtesting.SeedInfo.seed([3A0D3EFE9E0FFC60:B259012430F39198]:0)\n   [junit4]    > \tat org.apache.solr.cloud.DistribCursorPagingTest.doRandomSortsOnLargeIndex(DistribCursorPagingTest.java:599)\n   [junit4]    > \tat org.apache.solr.cloud.DistribCursorPagingTest.test(DistribCursorPagingTest.java:93)\n   [junit4]    > \tat org.apache.solr.BaseDistributedSearchTestCase$ShardsRepeatRule$ShardsFixedStatement.callStatement(BaseDistributedSearchTestCase.java:963)\n   [junit4]    > \tat org.apache.solr.BaseDistributedSearchTestCase$ShardsRepeatRule$ShardsStatement.evaluate(BaseDistributedSearchTestCase.java:938)\n   [junit4]    > \tat java.lang.Thread.run(Thread.java:745)\n   [junit4]   2> 168568 INFO  (SUITE-DistribCursorPagingTest-seed#[3A0D3EFE9E0FFC60]-worker) [n:127.0.0.1:56660_ c:collection1 s:shard1 r:core_node4 x:collection1] o.a.s.SolrTestCaseJ4 ###deleteCore\n   [junit4]   2> NOTE: leaving temporary files on disk at: /x1/jenkins/jenkins-slave/workspace/Lucene-Solr-Tests-trunk-Java8/solr/build/solr-core/test/J1/temp/solr.cloud.DistribCursorPagingTest_3A0D3EFE9E0FFC60-001\n   [junit4]   2> Sep 08, 2015 3:03:00 PM com.carrotsearch.randomizedtesting.ThreadLeakControl checkThreadLeaks\n   [junit4]   2> WARNING: Will linger awaiting termination of 1 leaked thread(s).\n   [junit4]   2> 169769 WARN  (OverseerStateUpdate-94485802195484690-127.0.0.1:56660_-n_0000000004) [n:127.0.0.1:56660_    ] o.a.s.c.Overseer Solr cannot talk to ZK, exiting Overseer main queue loop\n   [junit4]   2> org.apache.zookeeper.KeeperException$SessionExpiredException: KeeperErrorCode = Session expired for /overseer/queue/qn-0000000024\n   [junit4]   2> \tat org.apache.zookeeper.KeeperException.create(KeeperException.java:127)\n   [junit4]   2> \tat org.apache.zookeeper.KeeperException.create(KeeperException.java:51)\n   [junit4]   2> \tat org.apache.zookeeper.ZooKeeper.getData(ZooKeeper.java:1155)\n   [junit4]   2> \tat org.apache.solr.common.cloud.SolrZkClient$7.execute(SolrZkClient.java:353)\n   [junit4]   2> \tat org.apache.solr.common.cloud.SolrZkClient$7.execute(SolrZkClient.java:350)\n   [junit4]   2> \tat org.apache.solr.common.cloud.ZkCmdExecutor.retryOperation(ZkCmdExecutor.java:61)\n   [junit4]   2> \tat org.apache.solr.common.cloud.SolrZkClient.getData(SolrZkClient.java:350)\n   [junit4]   2> \tat org.apache.solr.cloud.DistributedQueue.removeFirst(DistributedQueue.java:384)\n   [junit4]   2> \tat org.apache.solr.cloud.DistributedQueue.poll(DistributedQueue.java:187)\n   [junit4]   2> \tat org.apache.solr.cloud.Overseer$ClusterStateUpdater.run(Overseer.java:229)\n   [junit4]   2> \tat java.lang.Thread.run(Thread.java:745)\n   [junit4]   2> 169770 INFO  (OverseerStateUpdate-94485802195484690-127.0.0.1:56660_-n_0000000004) [n:127.0.0.1:56660_    ] o.a.s.c.Overseer Overseer Loop exiting : 127.0.0.1:56660_\n   [junit4]   2> NOTE: test params are: codec=CheapBastard, sim=DefaultSimilarity, locale=, timezone=Europe/Belfast\n   [junit4]   2> NOTE: Linux 3.13.0-52-generic amd64/Oracle Corporation 1.8.0_45 (64-bit)/cpus=4,threads=1,free=186141504,total=382730240\n   [junit4]   2> NOTE: All tests run in this JVM: [BufferStoreTest, CachingDirectoryFactoryTest, PreAnalyzedFieldTest, TestDistributedGrouping, HdfsLockFactoryTest, RuleEngineTest, TestTrie, TestClusterStateMutator, TestSurroundQueryParser, SliceStateTest, BaseCdcrDistributedZkTest, SSLMigrationTest, DistributedExpandComponentTest, TestMissingGroups, VMParamsZkACLAndCredentialsProvidersTest, DistribCursorPagingTest]\n\n ",
            "id": "comment-14735601"
        }
    ]
}