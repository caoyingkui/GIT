{
    "id": "LUCENE-7845",
    "title": "spatial RPT optimization when query by point or common date range",
    "details": {
        "labels": "",
        "priority": "Major",
        "resolution": "Fixed",
        "affect_versions": "None",
        "status": "Resolved",
        "type": "Improvement",
        "components": [
            "modules/spatial-extras"
        ],
        "fix_versions": [
            "7.0"
        ]
    },
    "description": "If the query to an RPT index is a 2D point, or if using NumerBrangePrefixTreeStrategy / DateRangePrefixTree (Solr DateRangeField) if the query is a grid cell (a common date range unit like some particular day), then we can do some optimizations, especially if the data is pointsOnly.  If the data is pointsOnly the strategy can return a TermQuery, if the data isn't then we can at least tweak the prefixGridScanLevel.  This is motivated by two scenarios:\n\n\tindexing polygons and doing lookups by a point (AKA reverse geocoding)\n\tindexing date instances and doing date range faceting. Solr's code for this has a fast path for a TermQuery, although more is needed beyond this issue to get there.\n\n\n\nThis development was funded by the Harvard Center for Geographic Analysis as part of the HHypermap project",
    "attachments": {
        "LUCENE_7845_query_by_point_optimization.patch": "https://issues.apache.org/jira/secure/attachment/12869333/LUCENE_7845_query_by_point_optimization.patch"
    },
    "issue_links": {},
    "comments": [
        {
            "id": "comment-16026752",
            "date": "2017-05-26T20:00:54+0000",
            "content": "Commit d4f87b4a36ca50c4361d7ec4e0858b18d9eaebe8 in lucene-solr's branch refs/heads/master from David Smiley\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=d4f87b4 ]\n\nLUCENE-7845: RPT query by point (or simple date interval) optimization ",
            "author": "ASF subversion and git services"
        },
        {
            "id": "comment-16027421",
            "date": "2017-05-27T13:17:53+0000",
            "content": "My Jenkins found a reproducing failure that git bisect blames on commit d4f87b4a36, on this issue:\n\n\nChecking out Revision bc973ecdcfacf39440da06b86139c77935e1e92e (refs/remotes/origin/master)\n[...]\n   [junit4] Suite: org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest\n   [junit4]   2> m\u00e1j. 27, 2017 5:12:44 DE org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: RecursivePrefixTreeStrategy(SPG:(QuadPrefixTree(maxLevels:3,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)})),pruneLeafyBranches)\n   [junit4]   2> m\u00e1j. 27, 2017 5:12:44 DE org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: RecursivePrefixTreeStrategy(SPG:(PackedQuadPrefixTree(maxLevels:5,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)},prune:false)))\n   [junit4]   2> m\u00e1j. 27, 2017 5:12:44 DE org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: RecursivePrefixTreeStrategy(SPG:(GeohashPrefixTree(maxLevels:3,ctx:SpatialContext.GEO)))\n   [junit4]   2> m\u00e1j. 27, 2017 5:12:44 DE org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: RecursivePrefixTreeStrategy(SPG:(GeohashPrefixTree(maxLevels:2,ctx:SpatialContext.GEO)),pruneLeafyBranches)\n   [junit4]   2> m\u00e1j. 27, 2017 5:12:44 DE org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: RecursivePrefixTreeStrategy(SPG:(GeohashPrefixTree(maxLevels:2,ctx:SpatialContext.GEO)),pruneLeafyBranches)\n   [junit4]   2> m\u00e1j. 27, 2017 5:12:45 DE org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: RecursivePrefixTreeStrategy(SPG:(GeohashPrefixTree(maxLevels:2,ctx:SpatialContext.GEO)))\n   [junit4]   2> m\u00e1j. 27, 2017 5:12:45 DE org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: RecursivePrefixTreeStrategy(SPG:(PackedQuadPrefixTree(maxLevels:1,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)},prune:true)))\n   [junit4]   2> m\u00e1j. 27, 2017 5:12:45 DE org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: RecursivePrefixTreeStrategy(SPG:(PackedQuadPrefixTree(maxLevels:8,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)},prune:true)))\n   [junit4]   2> m\u00e1j. 27, 2017 5:12:45 DE org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: RecursivePrefixTreeStrategy(SPG:(GeohashPrefixTree(maxLevels:1,ctx:SpatialContext.GEO)),pointsOnly)\n   [junit4]   2> m\u00e1j. 27, 2017 5:12:45 DE org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: RecursivePrefixTreeStrategy(SPG:(QuadPrefixTree(maxLevels:8,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)})))\n   [junit4]   2> m\u00e1j. 27, 2017 5:12:45 DE org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: RecursivePrefixTreeStrategy(SPG:(QuadPrefixTree(maxLevels:1,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)})),pruneLeafyBranches)\n   [junit4]   2> m\u00e1j. 27, 2017 5:12:45 DE org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: RecursivePrefixTreeStrategy(SPG:(GeohashPrefixTree(maxLevels:2,ctx:SpatialContext.GEO)))\n   [junit4]   2> m\u00e1j. 27, 2017 5:12:45 DE org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: RecursivePrefixTreeStrategy(SPG:(GeohashPrefixTree(maxLevels:3,ctx:SpatialContext.GEO)))\n   [junit4]   2> m\u00e1j. 27, 2017 5:12:45 DE org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: RecursivePrefixTreeStrategy(SPG:(PackedQuadPrefixTree(maxLevels:3,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)},prune:true)),pruneLeafyBranches)\n   [junit4]   2> m\u00e1j. 27, 2017 5:12:45 DE org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: RecursivePrefixTreeStrategy(SPG:(GeohashPrefixTree(maxLevels:3,ctx:SpatialContext.GEO)),pruneLeafyBranches)\n   [junit4]   2> m\u00e1j. 27, 2017 5:12:46 DE org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: RecursivePrefixTreeStrategy(SPG:(GeohashPrefixTree(maxLevels:1,ctx:SpatialContext.GEO)))\n   [junit4]   2> m\u00e1j. 27, 2017 5:12:46 DE org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: RecursivePrefixTreeStrategy(SPG:(GeohashPrefixTree(maxLevels:1,ctx:SpatialContext.GEO)),pointsOnly,pruneLeafyBranches)\n   [junit4]   2> m\u00e1j. 27, 2017 5:12:46 DE org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: RecursivePrefixTreeStrategy(SPG:(PackedQuadPrefixTree(maxLevels:1,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)},prune:false)),pruneLeafyBranches)\n   [junit4]   2> m\u00e1j. 27, 2017 5:12:46 DE org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: RecursivePrefixTreeStrategy(SPG:(GeohashPrefixTree(maxLevels:2,ctx:SpatialContext.GEO)))\n   [junit4]   2> m\u00e1j. 27, 2017 5:12:46 DE org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: RecursivePrefixTreeStrategy(SPG:(GeohashPrefixTree(maxLevels:2,ctx:SpatialContext.GEO)),pruneLeafyBranches)\n   [junit4]   2> m\u00e1j. 27, 2017 5:12:46 DE org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: RecursivePrefixTreeStrategy(SPG:(GeohashPrefixTree(maxLevels:2,ctx:SpatialContext.GEO)),pruneLeafyBranches)\n   [junit4]   2> m\u00e1j. 27, 2017 5:12:46 DE org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: RecursivePrefixTreeStrategy(SPG:(GeohashPrefixTree(maxLevels:2,ctx:SpatialContext.GEO)))\n   [junit4]   2> m\u00e1j. 27, 2017 5:12:46 DE org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: RecursivePrefixTreeStrategy(SPG:(GeohashPrefixTree(maxLevels:1,ctx:SpatialContext.GEO)),pruneLeafyBranches)\n   [junit4]   2> m\u00e1j. 27, 2017 5:12:46 DE org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: RecursivePrefixTreeStrategy(SPG:(PackedQuadPrefixTree(maxLevels:1,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)},prune:false)),pointsOnly,pruneLeafyBranches)\n   [junit4]   2> Ig:Rect(minX=128.0,maxX=256.0,minY=0.0,maxY=128.0) Qg:Rect(minX=128.0,maxX=256.0,minY=0.0,maxY=128.0)\n   [junit4]   2> NOTE: download the large Jenkins line-docs file by running 'ant get-jenkins-line-docs' in the lucene directory.\n   [junit4]   2> NOTE: reproduce with: ant test  -Dtestcase=RandomSpatialOpFuzzyPrefixTreeTest -Dtests.method=testIntersects -Dtests.seed=F4FA997B1727B3C9 -Dtests.multiplier=2 -Dtests.nightly=true -Dtests.slow=true -Dtests.linedocsfile=/home/jenkins/lucene-data/enwiki.random.lines.txt -Dtests.locale=hu-HU -Dtests.timezone=Europe/Tirane -Dtests.asserts=true -Dtests.file.encoding=ISO-8859-1\n   [junit4] FAILURE 0.05s J5 | RandomSpatialOpFuzzyPrefixTreeTest.testIntersects { seed=[F4FA997B1727B3C9:8990A22D10916476]} <<<\n   [junit4]    > Throwable #1: java.lang.AssertionError: Should have matched I#0:Pt(x=209.0,y=63.0) Q:Pt(x=209.0,y=63.0)\n   [junit4]    > \tat __randomizedtesting.SeedInfo.seed([F4FA997B1727B3C9:8990A22D10916476]:0)\n   [junit4]    > \tat org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest.fail(RandomSpatialOpFuzzyPrefixTreeTest.java:399)\n   [junit4]    > \tat org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest.doTest(RandomSpatialOpFuzzyPrefixTreeTest.java:386)\n   [junit4]    > \tat org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest.testIntersects(RandomSpatialOpFuzzyPrefixTreeTest.java:138)\n   [junit4]    > \tat java.lang.Thread.run(Thread.java:745)\n   [junit4]   2> m\u00e1j. 27, 2017 5:12:46 DE org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: RecursivePrefixTreeStrategy(SPG:(PackedQuadPrefixTree(maxLevels:5,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)},prune:true)),pointsOnly,pruneLeafyBranches)\n   [junit4]   2> m\u00e1j. 27, 2017 5:12:46 DE org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: RecursivePrefixTreeStrategy(SPG:(QuadPrefixTree(maxLevels:3,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)})))\n   [junit4]   2> m\u00e1j. 27, 2017 5:12:46 DE org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: RecursivePrefixTreeStrategy(SPG:(PackedQuadPrefixTree(maxLevels:5,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)},prune:true)),pruneLeafyBranches)\n   [junit4]   2> m\u00e1j. 27, 2017 5:12:46 DE org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: RecursivePrefixTreeStrategy(SPG:(GeohashPrefixTree(maxLevels:2,ctx:SpatialContext.GEO)))\n   [junit4]   2> m\u00e1j. 27, 2017 5:12:47 DE org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: RecursivePrefixTreeStrategy(SPG:(QuadPrefixTree(maxLevels:5,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)})))\n   [junit4]   2> m\u00e1j. 27, 2017 5:12:47 DE org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: RecursivePrefixTreeStrategy(SPG:(GeohashPrefixTree(maxLevels:1,ctx:SpatialContext.GEO)),pruneLeafyBranches)\n   [junit4]   2> NOTE: leaving temporary files on disk at: /var/lib/jenkins/jobs/Lucene-Solr-Nightly-master/workspace/lucene/build/spatial-extras/test/J5/temp/lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest_F4FA997B1727B3C9-001\n   [junit4]   2> NOTE: test params are: codec=Lucene70, sim=RandomSimilarity(queryNorm=false): {RandomSpatialOpFuzzyPrefixTreeTest=DFR I(ne)2}, locale=hu-HU, timezone=Europe/Tirane\n   [junit4]   2> NOTE: Linux 4.1.0-custom2-amd64 amd64/Oracle Corporation 1.8.0_77 (64-bit)/cpus=16,threads=1,free=387737760,total=514850816\n   [junit4]   2> NOTE: All tests run in this JVM: [RandomSpatialOpFuzzyPrefixTreeTest]\n   [junit4] Completed [6/23 (1!)] on J5 in 3.30s, 34 tests, 1 failure <<< FAILURES!\n\n ",
            "author": "Steve Rowe"
        },
        {
            "id": "comment-16030182",
            "date": "2017-05-30T21:40:12+0000",
            "content": "I've reproduced this and boiled it down to a trivial test that fails \u2013 index a point, search by the same point.  There appears to be a bug in PackedQuadPrefixTree... I haven't precisely determined the exact bug but I suspect it's a bad assumption about mutability of the passed BytesRef; as some of its methods about it I find highly suspect.  I'm tempted to redo most of PackedQuadPrefixTree.PackedQuadCell so that it doesn't even retain/cache the byte[]; instead it can compute it only when needed \u2013 in some cases it won't ever be (thus a performance win). ",
            "author": "David Smiley"
        },
        {
            "id": "comment-16032459",
            "date": "2017-06-01T05:16:55+0000",
            "content": "I found and fixed and committed the bug fix: LUCENE-7859\nI also beast-ed that for a bit. ",
            "author": "David Smiley"
        },
        {
            "id": "comment-16037094",
            "date": "2017-06-05T15:32:05+0000",
            "content": "My Jenkins found a reproducing seed for RandomSpatialOpFuzzyPrefixTreeTest.testIntersects() and RandomSpatialOpFuzzyPrefixTree50Test.testIntersects failures - git bisect for the former again blames commit d4f87b4a36 on this issue:\n\n\nChecking out Revision db2b19f6ba7766cf42bde668f8ec4e7b237e6007 (refs/remotes/origin/master)\n[...]\n   [junit4] Suite: org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest\n   [junit4]   2> Jun 04, 2017 4:43:55 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFORMATION: Strategy: RecursivePrefixTreeStrategy(SPG:(PackedQuadPrefixTree(maxLevels:7,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)},prune:true)),pruneLeafyBranches)\n   [junit4]   2> Jun 04, 2017 4:43:56 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFORMATION: Strategy: RecursivePrefixTreeStrategy(SPG:(PackedQuadPrefixTree(maxLevels:6,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)},prune:false)),pruneLeafyBranches)\n   [junit4]   2> Jun 04, 2017 4:43:56 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFORMATION: Strategy: RecursivePrefixTreeStrategy(SPG:(GeohashPrefixTree(maxLevels:2,ctx:SpatialContext.GEO)),pruneLeafyBranches)\n   [junit4]   2> Jun 04, 2017 4:43:56 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFORMATION: Strategy: RecursivePrefixTreeStrategy(SPG:(PackedQuadPrefixTree(maxLevels:8,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)},prune:true)),pointsOnly)\n   [junit4]   2> Jun 04, 2017 4:43:56 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFORMATION: Strategy: RecursivePrefixTreeStrategy(SPG:(GeohashPrefixTree(maxLevels:3,ctx:SpatialContext.GEO)))\n   [junit4]   2> Jun 04, 2017 4:43:56 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFORMATION: Strategy: RecursivePrefixTreeStrategy(SPG:(QuadPrefixTree(maxLevels:5,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)})))\n   [junit4]   2> Jun 04, 2017 4:43:56 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFORMATION: Strategy: RecursivePrefixTreeStrategy(SPG:(PackedQuadPrefixTree(maxLevels:3,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)},prune:false)),pruneLeafyBranches)\n   [junit4]   2> Jun 04, 2017 4:43:56 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFORMATION: Strategy: RecursivePrefixTreeStrategy(SPG:(QuadPrefixTree(maxLevels:4,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)})),pointsOnly,pruneLeafyBranches)\n   [junit4]   2> Jun 04, 2017 4:43:56 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFORMATION: Strategy: RecursivePrefixTreeStrategy(SPG:(GeohashPrefixTree(maxLevels:3,ctx:SpatialContext.GEO)))\n   [junit4]   2> Jun 04, 2017 4:43:57 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFORMATION: Strategy: RecursivePrefixTreeStrategy(SPG:(QuadPrefixTree(maxLevels:8,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)})),pointsOnly,pruneLeafyBranches)\n   [junit4]   2> NOTE: download the large Jenkins line-docs file by running 'ant get-jenkins-line-docs' in the lucene directory.\n   [junit4]   2> NOTE: reproduce with: ant test  -Dtestcase=RandomSpatialOpFuzzyPrefixTreeTest -Dtests.method=testIntersects -Dtests.seed=B53BB247360E8564 -Dtests.multiplier=2 -Dtests.nightly=true -Dtests.slow=true -Dtests.linedocsfile=/home/jenkins/lucene-data/enwiki.random.lines.txt -Dtests.locale=de-CH -Dtests.timezone=Europe/Madrid -Dtests.asserts=true -Dtests.file.encoding=US-ASCII\n   [junit4] FAILURE 0.07s J5 | RandomSpatialOpFuzzyPrefixTreeTest.testIntersects { seed=[B53BB247360E8564:522092CBCFB47BC0]} <<<\n   [junit4]    > Throwable #1: java.lang.AssertionError\n   [junit4]    > \tat __randomizedtesting.SeedInfo.seed([B53BB247360E8564:522092CBCFB47BC0]:0)\n   [junit4]    > \tat org.apache.lucene.spatial.prefix.RecursivePrefixTreeStrategy.makeGridShapeIntersectsQuery(RecursivePrefixTreeStrategy.java:217)\n   [junit4]    > \tat org.apache.lucene.spatial.prefix.RecursivePrefixTreeStrategy.makeQuery(RecursivePrefixTreeStrategy.java:182)\n   [junit4]    > \tat org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest.doTest(RandomSpatialOpFuzzyPrefixTreeTest.java:384)\n   [junit4]    > \tat org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest.testIntersects(RandomSpatialOpFuzzyPrefixTreeTest.java:138)\n   [junit4]    > \tat java.lang.Thread.run(Thread.java:745)\n   [junit4]   2> Jun 04, 2017 4:43:57 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFORMATION: Strategy: RecursivePrefixTreeStrategy(SPG:(GeohashPrefixTree(maxLevels:3,ctx:SpatialContext.GEO)),pruneLeafyBranches)\n   [junit4]   2> Jun 04, 2017 4:43:57 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFORMATION: Strategy: RecursivePrefixTreeStrategy(SPG:(GeohashPrefixTree(maxLevels:3,ctx:SpatialContext.GEO)),pruneLeafyBranches)\n   [junit4]   2> Jun 04, 2017 4:43:57 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFORMATION: Strategy: RecursivePrefixTreeStrategy(SPG:(GeohashPrefixTree(maxLevels:2,ctx:SpatialContext.GEO)),pruneLeafyBranches)\n   [junit4]   2> Jun 04, 2017 4:43:57 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFORMATION: Strategy: RecursivePrefixTreeStrategy(SPG:(PackedQuadPrefixTree(maxLevels:2,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)},prune:true)))\n   [junit4]   2> Jun 04, 2017 4:43:57 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFORMATION: Strategy: RecursivePrefixTreeStrategy(SPG:(QuadPrefixTree(maxLevels:5,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)})),pruneLeafyBranches)\n   [junit4]   2> Jun 04, 2017 4:43:57 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFORMATION: Strategy: RecursivePrefixTreeStrategy(SPG:(PackedQuadPrefixTree(maxLevels:6,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)},prune:true)),pruneLeafyBranches)\n   [junit4]   2> Jun 04, 2017 4:43:57 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFORMATION: Strategy: RecursivePrefixTreeStrategy(SPG:(GeohashPrefixTree(maxLevels:3,ctx:SpatialContext.GEO)),pruneLeafyBranches)\n   [junit4]   2> Jun 04, 2017 4:43:57 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFORMATION: Strategy: RecursivePrefixTreeStrategy(SPG:(GeohashPrefixTree(maxLevels:1,ctx:SpatialContext.GEO)),pruneLeafyBranches)\n   [junit4]   2> Jun 04, 2017 4:43:58 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFORMATION: Strategy: RecursivePrefixTreeStrategy(SPG:(GeohashPrefixTree(maxLevels:1,ctx:SpatialContext.GEO)),pruneLeafyBranches)\n   [junit4]   2> Jun 04, 2017 4:43:58 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFORMATION: Strategy: RecursivePrefixTreeStrategy(SPG:(PackedQuadPrefixTree(maxLevels:5,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)},prune:true)),pointsOnly,pruneLeafyBranches)\n   [junit4]   2> Jun 04, 2017 4:43:58 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFORMATION: Strategy: RecursivePrefixTreeStrategy(SPG:(QuadPrefixTree(maxLevels:7,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)})))\n   [junit4]   2> Jun 04, 2017 4:43:58 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFORMATION: Strategy: RecursivePrefixTreeStrategy(SPG:(PackedQuadPrefixTree(maxLevels:7,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)},prune:false)),pruneLeafyBranches)\n   [junit4]   2> Jun 04, 2017 4:43:58 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFORMATION: Strategy: RecursivePrefixTreeStrategy(SPG:(QuadPrefixTree(maxLevels:1,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)})))\n   [junit4]   2> Jun 04, 2017 4:43:58 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFORMATION: Strategy: RecursivePrefixTreeStrategy(SPG:(QuadPrefixTree(maxLevels:2,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)})))\n   [junit4]   2> Jun 04, 2017 4:43:58 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFORMATION: Strategy: RecursivePrefixTreeStrategy(SPG:(GeohashPrefixTree(maxLevels:2,ctx:SpatialContext.GEO)))\n   [junit4]   2> Jun 04, 2017 4:43:58 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFORMATION: Strategy: RecursivePrefixTreeStrategy(SPG:(GeohashPrefixTree(maxLevels:1,ctx:SpatialContext.GEO)))\n   [junit4]   2> Jun 04, 2017 4:43:58 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFORMATION: Strategy: RecursivePrefixTreeStrategy(SPG:(GeohashPrefixTree(maxLevels:3,ctx:SpatialContext.GEO)),pruneLeafyBranches)\n   [junit4]   2> Jun 04, 2017 4:43:58 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFORMATION: Strategy: RecursivePrefixTreeStrategy(SPG:(GeohashPrefixTree(maxLevels:1,ctx:SpatialContext.GEO)),pruneLeafyBranches)\n   [junit4]   2> Jun 04, 2017 4:43:58 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFORMATION: Strategy: RecursivePrefixTreeStrategy(SPG:(GeohashPrefixTree(maxLevels:1,ctx:SpatialContext.GEO)),pruneLeafyBranches)\n   [junit4]   2> Jun 04, 2017 4:43:58 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFORMATION: Strategy: RecursivePrefixTreeStrategy(SPG:(GeohashPrefixTree(maxLevels:3,ctx:SpatialContext.GEO)),pruneLeafyBranches)\n   [junit4]   2> NOTE: leaving temporary files on disk at: /var/lib/jenkins/jobs/Lucene-Solr-Nightly-master/workspace/lucene/build/spatial-extras/test/J5/temp/lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest_B53BB247360E8564-001\n   [junit4]   2> NOTE: test params are: codec=FastCompressingStoredFields(storedFieldsFormat=CompressingStoredFieldsFormat(compressionMode=FAST, chunkSize=4, maxDocsPerChunk=6, blockSize=340), termVectorsFormat=CompressingTermVectorsFormat(compressionMode=FAST, chunkSize=4, blockSize=340)), sim=RandomSimilarity(queryNorm=true): {RandomSpatialOpFuzzyPrefixTreeTest=DFR GB3(800.0)}, locale=de-CH, timezone=Europe/Madrid\n   [junit4]   2> NOTE: Linux 4.1.0-custom2-amd64 amd64/Oracle Corporation 1.8.0_77 (64-bit)/cpus=16,threads=1,free=455100144,total=514850816\n   [junit4]   2> NOTE: All tests run in this JVM: [SpatialArgsParserTest, TestTermQueryPrefixGridStrategy, DistanceStrategyTest, RandomSpatialOpFuzzyPrefixTreeTest]\n   [junit4] Completed [14/23 (1!)] on J5 in 2.77s, 35 tests, 1 failure <<< FAILURES!\n\n\n\n\n   [junit4] Suite: org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTree50Test\n   [junit4]   2> jun 04, 2017 12:43:59 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: (SPG:(PackedQuadPrefixTree(maxLevels:7,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)},prune:true)),pruneLeafyBranches)\n   [junit4]   2> jun 04, 2017 12:43:59 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: (SPG:(PackedQuadPrefixTree(maxLevels:6,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)},prune:false)),pruneLeafyBranches)\n   [junit4]   2> jun 04, 2017 12:43:59 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: (SPG:(GeohashPrefixTree(maxLevels:2,ctx:SpatialContext.GEO)),pruneLeafyBranches)\n   [junit4]   2> jun 04, 2017 12:43:59 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: (SPG:(PackedQuadPrefixTree(maxLevels:8,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)},prune:true)),pointsOnly)\n   [junit4]   2> jun 04, 2017 12:43:59 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: (SPG:(GeohashPrefixTree(maxLevels:3,ctx:SpatialContext.GEO)))\n   [junit4]   2> jun 04, 2017 12:44:00 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: (SPG:(QuadPrefixTree(maxLevels:5,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)})))\n   [junit4]   2> jun 04, 2017 12:44:00 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: (SPG:(PackedQuadPrefixTree(maxLevels:3,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)},prune:false)),pruneLeafyBranches)\n   [junit4]   2> jun 04, 2017 12:44:00 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: (SPG:(QuadPrefixTree(maxLevels:4,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)})),pointsOnly,pruneLeafyBranches)\n   [junit4]   2> jun 04, 2017 12:44:00 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: (SPG:(GeohashPrefixTree(maxLevels:3,ctx:SpatialContext.GEO)))\n   [junit4]   2> jun 04, 2017 12:44:00 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: (SPG:(QuadPrefixTree(maxLevels:8,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)})),pointsOnly,pruneLeafyBranches)\n   [junit4]   2> NOTE: download the large Jenkins line-docs file by running 'ant get-jenkins-line-docs' in the lucene directory.\n   [junit4]   2> NOTE: reproduce with: ant test  -Dtestcase=RandomSpatialOpFuzzyPrefixTree50Test -Dtests.method=testIntersects -Dtests.seed=B53BB247360E8564 -Dtests.multiplier=2 -Dtests.nightly=true -Dtests.slow=true -Dtests.linedocsfile=/home/jenkins/lucene-data/enwiki.random.lines.txt -Dtests.locale=no -Dtests.timezone=America/Miquelon -Dtests.asserts=true -Dtests.file.encoding=US-ASCII\n   [junit4] FAILURE 0.10s J3 | RandomSpatialOpFuzzyPrefixTree50Test.testIntersects { seed=[B53BB247360E8564:522092CBCFB47BC0]} <<<\n   [junit4]    > Throwable #1: java.lang.AssertionError\n   [junit4]    > \tat __randomizedtesting.SeedInfo.seed([B53BB247360E8564:522092CBCFB47BC0]:0)\n   [junit4]    > \tat org.apache.lucene.spatial.prefix.RecursivePrefixTreeStrategy.makeGridShapeIntersectsQuery(RecursivePrefixTreeStrategy.java:217)\n   [junit4]    > \tat org.apache.lucene.spatial.prefix.RecursivePrefixTreeStrategy.makeQuery(RecursivePrefixTreeStrategy.java:182)\n   [junit4]    > \tat org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest.doTest(RandomSpatialOpFuzzyPrefixTreeTest.java:384)\n   [junit4]    > \tat org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest.testIntersects(RandomSpatialOpFuzzyPrefixTreeTest.java:138)\n   [junit4]    > \tat java.lang.Thread.run(Thread.java:745)\n   [junit4]   2> jun 04, 2017 12:44:01 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: (SPG:(GeohashPrefixTree(maxLevels:3,ctx:SpatialContext.GEO)),pruneLeafyBranches)\n   [junit4]   2> jun 04, 2017 12:44:01 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: (SPG:(GeohashPrefixTree(maxLevels:3,ctx:SpatialContext.GEO)),pruneLeafyBranches)\n   [junit4]   2> jun 04, 2017 12:44:01 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: (SPG:(GeohashPrefixTree(maxLevels:2,ctx:SpatialContext.GEO)),pruneLeafyBranches)\n   [junit4]   2> jun 04, 2017 12:44:01 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: (SPG:(PackedQuadPrefixTree(maxLevels:2,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)},prune:true)))\n   [junit4]   2> jun 04, 2017 12:44:01 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: (SPG:(QuadPrefixTree(maxLevels:5,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)})),pruneLeafyBranches)\n   [junit4]   2> jun 04, 2017 12:44:01 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: (SPG:(PackedQuadPrefixTree(maxLevels:6,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)},prune:true)),pruneLeafyBranches)\n   [junit4]   2> jun 04, 2017 12:44:01 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: (SPG:(GeohashPrefixTree(maxLevels:3,ctx:SpatialContext.GEO)),pruneLeafyBranches)\n   [junit4]   2> jun 04, 2017 12:44:01 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: (SPG:(GeohashPrefixTree(maxLevels:1,ctx:SpatialContext.GEO)),pruneLeafyBranches)\n   [junit4]   2> jun 04, 2017 12:44:01 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: (SPG:(GeohashPrefixTree(maxLevels:1,ctx:SpatialContext.GEO)),pruneLeafyBranches)\n   [junit4]   2> jun 04, 2017 12:44:01 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: (SPG:(PackedQuadPrefixTree(maxLevels:5,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)},prune:true)),pointsOnly,pruneLeafyBranches)\n   [junit4]   2> jun 04, 2017 12:44:01 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: (SPG:(QuadPrefixTree(maxLevels:7,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)})))\n   [junit4]   2> jun 04, 2017 12:44:02 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: (SPG:(PackedQuadPrefixTree(maxLevels:7,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)},prune:false)),pruneLeafyBranches)\n   [junit4]   2> jun 04, 2017 12:44:02 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: (SPG:(QuadPrefixTree(maxLevels:1,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)})))\n   [junit4]   2> jun 04, 2017 12:44:02 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: (SPG:(QuadPrefixTree(maxLevels:2,ctx:SpatialContext{geo=false, calculator=CartesianDistCalc, worldBounds=Rect(minX=0.0,maxX=256.0,minY=-128.0,maxY=128.0)})))\n   [junit4]   2> jun 04, 2017 12:44:02 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: (SPG:(GeohashPrefixTree(maxLevels:2,ctx:SpatialContext.GEO)))\n   [junit4]   2> jun 04, 2017 12:44:02 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: (SPG:(GeohashPrefixTree(maxLevels:1,ctx:SpatialContext.GEO)))\n   [junit4]   2> jun 04, 2017 12:44:02 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: (SPG:(GeohashPrefixTree(maxLevels:3,ctx:SpatialContext.GEO)),pruneLeafyBranches)\n   [junit4]   2> jun 04, 2017 12:44:02 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: (SPG:(GeohashPrefixTree(maxLevels:1,ctx:SpatialContext.GEO)),pruneLeafyBranches)\n   [junit4]   2> jun 04, 2017 12:44:02 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: (SPG:(GeohashPrefixTree(maxLevels:1,ctx:SpatialContext.GEO)),pruneLeafyBranches)\n   [junit4]   2> jun 04, 2017 12:44:02 AM org.apache.lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTreeTest setupGrid\n   [junit4]   2> INFO: Strategy: (SPG:(GeohashPrefixTree(maxLevels:3,ctx:SpatialContext.GEO)),pruneLeafyBranches)\n   [junit4]   2> NOTE: leaving temporary files on disk at: /var/lib/jenkins/jobs/Lucene-Solr-Nightly-master/workspace/lucene/build/spatial-extras/test/J3/temp/lucene.spatial.prefix.RandomSpatialOpFuzzyPrefixTree50Test_B53BB247360E8564-001\n   [junit4]   2> NOTE: test params are: codec=Asserting(Lucene70): {RandomSpatialOpFuzzyPrefixTree50Test=PostingsFormat(name=MockRandom), id=TestBloomFilteredLucenePostings(BloomFilteringPostingsFormat(Lucene50(blocksize=128)))}, docValues:{}, maxPointsInLeafNode=1970, maxMBSortInHeap=5.790390751225127, sim=RandomSimilarity(queryNorm=false): {RandomSpatialOpFuzzyPrefixTree50Test=IB SPL-D2}, locale=no, timezone=America/Miquelon\n   [junit4]   2> NOTE: Linux 4.1.0-custom2-amd64 amd64/Oracle Corporation 1.8.0_77 (64-bit)/cpus=16,threads=1,free=412214296,total=511705088\n   [junit4]   2> NOTE: All tests run in this JVM: [Geo3dShapeSphereModelRectRelationTest, PortedSolr3Test, RandomSpatialOpFuzzyPrefixTree50Test]\n   [junit4] Completed [21/23 (2!)] on J3 in 3.38s, 35 tests, 1 failure <<< FAILURES!\n\n ",
            "author": "Steve Rowe"
        },
        {
            "id": "comment-16037101",
            "date": "2017-06-05T15:38:17+0000",
            "content": "Thanks Steve Rowe! I'll investigate.  It seems you're pretty good at uncovering failing seeds  ",
            "author": "David Smiley"
        },
        {
            "id": "comment-16037194",
            "date": "2017-06-05T16:45:45+0000",
            "content": "Commit 6b022c98f9a1f69de17445004ce8464ee936e51c in lucene-solr's branch refs/heads/master from David Smiley\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=6b022c9 ]\n\nLUCENE-7845: spatial-extras undo optimize; don't consider any rect or circle to be a point ",
            "author": "ASF subversion and git services"
        },
        {
            "id": "comment-16037197",
            "date": "2017-06-05T16:47:23+0000",
            "content": "In the original optimization I had considered degenerate circles and rectangles to be a point.  But they aren't quite identical to a point, so I rolled back that aspect. ",
            "author": "David Smiley"
        }
    ]
}