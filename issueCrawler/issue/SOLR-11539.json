{
    "id": "SOLR-11539",
    "title": "autogenerated pdf-main-body.adoc should use explicit anchors for each included page",
    "details": {
        "labels": "",
        "priority": "Major",
        "components": [
            "documentation"
        ],
        "type": "Sub-task",
        "fix_versions": [
            "7.1",
            "7.2",
            "master (8.0)"
        ],
        "affect_versions": "None",
        "resolution": "Fixed",
        "status": "Closed"
    },
    "description": "see parent task for a discussion of why/how we currently have broken links/anchors in the PDF due to relying on the auto-generated \"section\" IDs for each included page and how nothing currently enforces that those auto-generated IDs (from the page titles) match the page-shortname used in the HTML pages where we do link validation.",
    "attachments": {
        "SOLR-11539.patch": "https://issues.apache.org/jira/secure/attachment/12893780/SOLR-11539.patch"
    },
    "issue_links": {},
    "comments": [
        {
            "date": "2017-10-24T18:06:42+0000",
            "content": "Here's a patch which updates BuildNavAndPDFBody to:\n\n\n\tvalidate that the page-shortname and page-permalink of all *.adoc files is consistent with the basefilename (no files currently fail this check, but it's important to catch future mistakes like this moving forward untill we can eliminate these attributes)\n\tadds explicit anchors using the page-shortname before each include:: declaration in the generated pdf-main-body.adoc file\n\n\n\nThis should fix all of the broken \"section\" links mentioned in the parent issue where a page title doesn't \"match\" the filename/shortname...\n\n\n...we have existing *.adoc files with titles that don't match...\n\n\n     [java] Building up tree of all known pages\n     [java] /home/hossman/lucene/dev/solr/build/solr-ref-guide/content/solrcloud-autoscaling-overview.adoc has a mismatched title: Overview of SolrCloud Autoscaling => overview-of-solrcloud-autoscaling\n     [java] /home/hossman/lucene/dev/solr/build/solr-ref-guide/content/the-extended-dismax-query-parser.adoc has a mismatched title: The Extended DisMax (eDismax) Query Parser => the-extended-dismax-edismax-query-parser\n     [java] /home/hossman/lucene/dev/solr/build/solr-ref-guide/content/solrcloud-autoscaling-auto-add-replicas.adoc has a mismatched title: SolrCloud AutoScaling Automatically Adding Replicas => solrcloud-autoscaling-automatically-adding-replicas\n     [java] /home/hossman/lucene/dev/solr/build/solr-ref-guide/content/how-to-contribute.adoc has a mismatched title: How to Contribute to Solr Documentation => how-to-contribute-to-solr-documentation\n     [java] /home/hossman/lucene/dev/solr/build/solr-ref-guide/content/solrcloud-autoscaling-api.adoc has a mismatched title: Autoscaling API => autoscaling-api\n     [java] /home/hossman/lucene/dev/solr/build/solr-ref-guide/content/index.adoc has a mismatched title: Apache Solr Reference Guide => apache-solr-reference-guide\n     [java] /home/hossman/lucene/dev/solr/build/solr-ref-guide/content/solrcloud-autoscaling-policy-preferences.adoc has a mismatched title: Autoscaling Policy and Preferences => autoscaling-policy-and-preferences\n     [java] /home/hossman/lucene/dev/solr/build/solr-ref-guide/content/cross-data-center-replication-cdcr.adoc has a mismatched title: Cross Data Center Replication (CDCR) => cross-data-center-replication-cdcr-\n\n\n...\n\nA few concrete Examples that are easy to \"find\" in the PDF:\n\n\tAll links with the text \"The Extended DisMax Query Parser\" from the sections generated by query-screen.adoc, query-syntax-and-parsing.adoc, and searching.adoc\n\tlink text \"Overview of Autoscaling in SolrCloud\" from solrcloud-autoscaling.adoc\n\n\n\n\n\n...and will mean that moving forward, we should be free to change the \"title\" of pages all we want w/o breaking any links.\n\n\n\nI think this patch is good to go, and should probably be backported to branch_7_1 before the 7.1 ref guide ... but it would be good to get more eyeballs on the generate PDF to verify that it doesn't break anything ",
            "author": "Hoss Man",
            "id": "comment-16217380"
        },
        {
            "date": "2017-10-24T18:50:46+0000",
            "content": "I applied this patch locally and generated a PDF from master then compared that to the PDF that was released for 7.0. All of the currently broken links are fixed with this patch. I wasn't sure what else to look for so I tried to click as many links as I could - whether they were broken or not  - and I could not find any examples of broken links.\n\nSo, unless you can think of something else to check, +1 to commit. ",
            "author": "Cassandra Targett",
            "id": "comment-16217445"
        },
        {
            "date": "2017-10-24T19:07:14+0000",
            "content": "Commit 2d8c34b316c3ec655e073daab812644c24a09d0b in lucene-solr's branch refs/heads/branch_7_1 from Chris Hostetter\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=2d8c34b ]\n\nSOLR-11539: use page shortnames as explicit anchors in generated pdf-main-body.adoc\n\n(cherry picked from commit ab388fa3a723ec59c80567c3c0448e16b985d20b) ",
            "author": "ASF subversion and git services",
            "id": "comment-16217483"
        },
        {
            "date": "2017-10-24T19:07:17+0000",
            "content": "Commit 1225c9dcc610c2bce55e6f8c09308c6af378fe66 in lucene-solr's branch refs/heads/branch_7x from Chris Hostetter\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=1225c9d ]\n\nSOLR-11539: use page shortnames as explicit anchors in generated pdf-main-body.adoc\n\n(cherry picked from commit ab388fa3a723ec59c80567c3c0448e16b985d20b) ",
            "author": "ASF subversion and git services",
            "id": "comment-16217484"
        },
        {
            "date": "2017-10-24T19:07:19+0000",
            "content": "Commit ab388fa3a723ec59c80567c3c0448e16b985d20b in lucene-solr's branch refs/heads/master from Chris Hostetter\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=ab388fa ]\n\nSOLR-11539: use page shortnames as explicit anchors in generated pdf-main-body.adoc ",
            "author": "ASF subversion and git services",
            "id": "comment-16217485"
        }
    ]
}