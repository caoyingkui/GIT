{
    "id": "SOLR-9390",
    "title": "LeaderFailoverAfterPartitionTest failures: Connection refused, too few active replicas, and no registered leader",
    "details": {
        "components": [],
        "type": "Bug",
        "labels": "",
        "fix_versions": [],
        "affect_versions": "None",
        "status": "Open",
        "resolution": "Unresolved",
        "priority": "Major"
    },
    "description": "In manual testing, I've seen LeaderFailoverAfterPartitionTest fail a couple times, and the seeds reproduce for me:\n\n\n  [junit4]   2> NOTE: reproduce with: ant test  -Dtestcase=LeaderFailoverAfterPartitionTest -Dtests.method=test -Dtests.seed=49939C8CF78131E7 -Dtests.slow=true -Dtests.linedocsfile=/home/jenkins/lucene-data/enwiki.random.lines.txt -Dtests.locale=en-AU -Dtests.timezone=America/Port-au-Prince -Dtests.asserts=true -Dtests.file.encoding=UTF-8\n   [junit4] ERROR   65.8s | LeaderFailoverAfterPartitionTest.test <<<\n   [junit4]    > Throwable #1: org.apache.solr.client.solrj.SolrServerException: org.apache.solr.client.solrj.SolrServerException: No live SolrServers available to handle this request:[http://127.0.0.1:60401/c8n_1x3_lf_shard1_replica3]\n   [junit4]    >        at __randomizedtesting.SeedInfo.seed([49939C8CF78131E7:C1C7A356597D5C1F]:0)\n   [junit4]    >        at org.apache.solr.client.solrj.impl.CloudSolrClient.directUpdate(CloudSolrClient.java:774)\n   [junit4]    >        at org.apache.solr.client.solrj.impl.CloudSolrClient.sendRequest(CloudSolrClient.java:1172)\n   [junit4]    >        at org.apache.solr.client.solrj.impl.CloudSolrClient.requestWithRetryOnStaleState(CloudSolrClient.java:1061)\n   [junit4]    >        at org.apache.solr.client.solrj.impl.CloudSolrClient.request(CloudSolrClient.java:997)\n   [junit4]    >        at org.apache.solr.cloud.AbstractFullDistribZkTestBase.sendDocsWithRetry(AbstractFullDistribZkTestBase.java:753)\n   [junit4]    >        at org.apache.solr.cloud.AbstractFullDistribZkTestBase.sendDocsWithRetry(AbstractFullDistribZkTestBase.java:741)\n   [junit4]    >        at org.apache.solr.cloud.LeaderFailoverAfterPartitionTest.testRf3WithLeaderFailover(LeaderFailoverAfterPartitionTest.java:178)\n   [junit4]    >        at org.apache.solr.cloud.LeaderFailoverAfterPartitionTest.test(LeaderFailoverAfterPartitionTest.java:57)\n   [junit4]    >        at org.apache.solr.BaseDistributedSearchTestCase$ShardsRepeatRule$ShardsFixedStatement.callStatement(BaseDistributedSearchTestCase.java:985)\n   [junit4]    >        at org.apache.solr.BaseDistributedSearchTestCase$ShardsRepeatRule$ShardsStatement.evaluate(BaseDistributedSearchTestCase.java:960)\n   [junit4]    >        at java.lang.Thread.run(Thread.java:745)\n   [junit4]    > Caused by: org.apache.solr.client.solrj.SolrServerException: No live SolrServers available to handle this request:[http://127.0.0.1:60401/c8n_1x3_lf_shard1_replica3]\n   [junit4]    >        at org.apache.solr.client.solrj.impl.LBHttpSolrClient.request(LBHttpSolrClient.java:393)\n   [junit4]    >        at org.apache.solr.client.solrj.impl.CloudSolrClient.directUpdate(CloudSolrClient.java:768)\n   [junit4]    >        ... 48 more\n   [junit4]    > Caused by: org.apache.solr.client.solrj.SolrServerException: Server refused connection at: http://127.0.0.1:60401/c8n_1x3_lf_shard1_replica3\n   [junit4]    >        at org.apache.solr.client.solrj.impl.HttpSolrClient.executeMethod(HttpSolrClient.java:615)\n   [junit4]    >        at org.apache.solr.client.solrj.impl.HttpSolrClient.request(HttpSolrClient.java:261)\n   [junit4]    >        at org.apache.solr.client.solrj.impl.HttpSolrClient.request(HttpSolrClient.java:250)\n   [junit4]    >        at org.apache.solr.client.solrj.impl.LBHttpSolrClient.doRequest(LBHttpSolrClient.java:413)\n   [junit4]    >        at org.apache.solr.client.solrj.impl.LBHttpSolrClient.request(LBHttpSolrClient.java:382)\n   [junit4]    >        ... 49 more\n   [junit4]    > Caused by: org.apache.http.conn.HttpHostConnectException: Connect to 127.0.0.1:60401 [/127.0.0.1] failed: Connection refused\n   [junit4]    >        at org.apache.http.impl.conn.DefaultHttpClientConnectionOperator.connect(DefaultHttpClientConnectionOperator.java:151)\n   [junit4]    >        at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.connect(PoolingHttpClientConnectionManager.java:353)\n   [junit4]    >        at org.apache.http.impl.execchain.MainClientExec.establishRoute(MainClientExec.java:380)\n   [junit4]    >        at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:236)\n   [junit4]    >        at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:184)\n   [junit4]    >        at org.apache.http.impl.execchain.RetryExec.execute(RetryExec.java:88)\n   [junit4]    >        at org.apache.http.impl.execchain.RedirectExec.execute(RedirectExec.java:110)\n   [junit4]    >        at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:184)\n   [junit4]    >        at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:82)\n   [junit4]    >        at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:55)\n   [junit4]    >        at org.apache.solr.client.solrj.impl.HttpSolrClient.executeMethod(HttpSolrClient.java:513)\n   [junit4]    >        ... 53 more\n   [junit4]    > Caused by: java.net.ConnectException: Connection refused\n   [junit4]    >        at java.net.PlainSocketImpl.socketConnect(Native Method)\n   [junit4]    >        at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)\n   [junit4]    >        at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)\n   [junit4]    >        at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)\n   [junit4]    >        at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)\n   [junit4]    >        at java.net.Socket.connect(Socket.java:589)\n   [junit4]    >        at org.apache.http.conn.socket.PlainConnectionSocketFactory.connectSocket(PlainConnectionSocketFactory.java:74)\n   [junit4]    >        at org.apache.http.impl.conn.DefaultHttpClientConnectionOperator.connect(DefaultHttpClientConnectionOperator.java:134)\n   [junit4]    >        ... 63 more\n\n\n\n\n  [junit4]   2> NOTE: reproduce with: ant test  -Dtestcase=LeaderFailoverAfterPartitionTest -Dtests.method=test -Dtests.seed=FEC05A2EE85F1F0B -Dtests.slow=true -Dtests.linedocsfile=/home/jenkins/lucene-data/enwiki.random.lines.txt -Dtests.locale=sr-BA -Dtests.timezone=America/Argentina/Salta -Dtests.asserts=true -Dtests.file.encoding=UTF-8\n   [junit4] ERROR   71.2s | LeaderFailoverAfterPartitionTest.test <<<\n   [junit4]    > Throwable #1: org.apache.solr.client.solrj.SolrServerException: org.apache.solr.client.solrj.SolrServerException: No live SolrServers available to handle this request:[http://127.0.0.1:36121/c8n_1x3_lf_shard1_replica3]\n   [junit4]    >        at __randomizedtesting.SeedInfo.seed([FEC05A2EE85F1F0B:769465F446A372F3]:0)\n   [junit4]    >        at org.apache.solr.client.solrj.impl.CloudSolrClient.directUpdate(CloudSolrClient.java:774)\n   [junit4]    >        at org.apache.solr.client.solrj.impl.CloudSolrClient.sendRequest(CloudSolrClient.java:1172)\n   [junit4]    >        at org.apache.solr.client.solrj.impl.CloudSolrClient.requestWithRetryOnStaleState(CloudSolrClient.java:1061)\n   [junit4]    >        at org.apache.solr.client.solrj.impl.CloudSolrClient.request(CloudSolrClient.java:997)\n   [junit4]    >        at org.apache.solr.cloud.AbstractFullDistribZkTestBase.sendDocsWithRetry(AbstractFullDistribZkTestBase.java:753)\n   [junit4]    >        at org.apache.solr.cloud.AbstractFullDistribZkTestBase.sendDocsWithRetry(AbstractFullDistribZkTestBase.java:741)\n   [junit4]    >        at org.apache.solr.cloud.LeaderFailoverAfterPartitionTest.testRf3WithLeaderFailover(LeaderFailoverAfterPartitionTest.java:178)\n   [junit4]    >        at org.apache.solr.cloud.LeaderFailoverAfterPartitionTest.test(LeaderFailoverAfterPartitionTest.java:57)\n   [junit4]    >        at org.apache.solr.BaseDistributedSearchTestCase$ShardsRepeatRule$ShardsFixedStatement.callStatement(BaseDistributedSearchTestCase.java:985)\n   [junit4]    >        at org.apache.solr.BaseDistributedSearchTestCase$ShardsRepeatRule$ShardsStatement.evaluate(BaseDistributedSearchTestCase.java:960)\n   [junit4]    >        at java.lang.Thread.run(Thread.java:745)\n   [junit4]    > Caused by: org.apache.solr.client.solrj.SolrServerException: No live SolrServers available to handle this request:[http://127.0.0.1:36121/c8n_1x3_lf_shard1_replica3]\n   [junit4]    >        at org.apache.solr.client.solrj.impl.LBHttpSolrClient.request(LBHttpSolrClient.java:393)\n   [junit4]    >        at org.apache.solr.client.solrj.impl.CloudSolrClient.directUpdate(CloudSolrClient.java:768)\n   [junit4]    >        ... 48 more\n   [junit4]    > Caused by: org.apache.solr.client.solrj.SolrServerException: Server refused connection at: http://127.0.0.1:36121/c8n_1x3_lf_shard1_replica3\n   [junit4]    >        at org.apache.solr.client.solrj.impl.HttpSolrClient.executeMethod(HttpSolrClient.java:615)\n   [junit4]    >        at org.apache.solr.client.solrj.impl.HttpSolrClient.request(HttpSolrClient.java:261)\n   [junit4]    >        at org.apache.solr.client.solrj.impl.HttpSolrClient.request(HttpSolrClient.java:250)\n   [junit4]    >        at org.apache.solr.client.solrj.impl.LBHttpSolrClient.doRequest(LBHttpSolrClient.java:413)\n   [junit4]    >        at org.apache.solr.client.solrj.impl.LBHttpSolrClient.request(LBHttpSolrClient.java:382)\n   [junit4]    >        ... 49 more\n   [junit4]    > Caused by: org.apache.http.conn.HttpHostConnectException: Connect to 127.0.0.1:36121 [/127.0.0.1] failed: Connection refused\n   [junit4]    >        at org.apache.http.impl.conn.DefaultHttpClientConnectionOperator.connect(DefaultHttpClientConnectionOperator.java:151)\n   [junit4]    >        at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.connect(PoolingHttpClientConnectionManager.java:353)\n   [junit4]    >        at org.apache.http.impl.execchain.MainClientExec.establishRoute(MainClientExec.java:380)\n   [junit4]    >        at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:236)\n   [junit4]    >        at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:184)\n   [junit4]    >        at org.apache.http.impl.execchain.RetryExec.execute(RetryExec.java:88)\n   [junit4]    >        at org.apache.http.impl.execchain.RedirectExec.execute(RedirectExec.java:110)\n   [junit4]    >        at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:184)\n   [junit4]    >        at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:82)\n   [junit4]    >        at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:55)\n   [junit4]    >        at org.apache.solr.client.solrj.impl.HttpSolrClient.executeMethod(HttpSolrClient.java:513)\n   [junit4]    >        ... 53 more\n   [junit4]    > Caused by: java.net.ConnectException: Connection refused\n   [junit4]    >        at java.net.PlainSocketImpl.socketConnect(Native Method)\n   [junit4]    >        at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)\n   [junit4]    >        at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)\n   [junit4]    >        at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)\n   [junit4]    >        at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)\n   [junit4]    >        at java.net.Socket.connect(Socket.java:589)\n   [junit4]    >        at org.apache.http.conn.socket.PlainConnectionSocketFactory.connectSocket(PlainConnectionSocketFactory.java:74)\n   [junit4]    >        at org.apache.http.impl.conn.DefaultHttpClientConnectionOperator.connect(DefaultHttpClientConnectionOperator.java:134)\n   [junit4]    >        ... 63 more",
    "attachments": {},
    "issue_links": {},
    "comments": [
        {
            "date": "2016-08-08T23:10:40+0000",
            "author": "Steve Rowe",
            "content": "I was curious how frequently this test fails, so I ran 100 iterations on master using Miller's beasting script, and there were 8 failures, 4 of which look like the above 2: Connection refused.  All 4 seeds reproduce for me on the first attempt: \n\n\n   [junit4]   2> NOTE: reproduce with: ant test  -Dtestcase=LeaderFailoverAfterPartitionTest -Dtests.method=test -Dtests.seed=7066E32EB7F9257F -Dtests.slow=true -Dtests.linedocsfile=/home/jenkins/lucene-data/enwiki.random.lines.txt -Dtests.locale=hi-IN -Dtests.timezone=Europe/Copenhagen -Dtests.asserts=true -Dtests.file.encoding=UTF-8\n\n\n\n   [junit4]   2> NOTE: reproduce with: ant test  -Dtestcase=LeaderFailoverAfterPartitionTest -Dtests.method=test -Dtests.seed=6B668251972FCE31 -Dtests.slow=true -Dtests.linedocsfile=/home/jenkins/lucene-data/enwiki.random.lines.txt -Dtests.locale=bg -Dtests.timezone=Arctic/Longyearbyen -Dtests.asserts=true -Dtests.file.encoding=ISO-8859-1\n\n\n\n   [junit4]   2> NOTE: reproduce with: ant test  -Dtestcase=LeaderFailoverAfterPartitionTest -Dtests.method=test -Dtests.seed=A61C973A4E61B79D -Dtests.slow=true -Dtests.linedocsfile=/home/jenkins/lucene-data/enwiki.random.lines.txt -Dtests.locale=da -Dtests.timezone=Asia/Bahrain -Dtests.asserts=true -Dtests.file.encoding=US-ASCII\n\n\n\n   [junit4]   2> NOTE: reproduce with: ant test  -Dtestcase=LeaderFailoverAfterPartitionTest -Dtests.method=test -Dtests.seed=CA6D489202E270EB -Dtests.slow=true -Dtests.linedocsfile=/home/jenkins/lucene-data/enwiki.random.lines.txt -Dtests.locale=ja-JP -Dtests.timezone=Africa/Dar_es_Salaam -Dtests.asserts=true -Dtests.file.encoding=US-ASCII\n\n\n\n3 other failures are caused by too few active replicas - I've included the full output for the first but just the repro line for the other 2 - none of these reproduced for me on the first attempt:\n\n\n   [junit4]   2> NOTE: reproduce with: ant test  -Dtestcase=LeaderFailoverAfterPartitionTest -Dtests.method=test -Dtests.seed=27CA142284060548 -Dtests.slow=true -Dtests.linedocsfile=/home/jenkins/lucene-data/enwiki.random.lines.txt -Dtests.locale=sr-CS -Dtests.timezone=Australia/Broken_Hill -Dtests.asserts=true -Dtests.file.encoding=US-ASCII\n   [junit4] FAILURE  134s | LeaderFailoverAfterPartitionTest.test <<<\n   [junit4]    > Throwable #1: java.lang.AssertionError: Expected 2 of 3 replicas to be active but only found 1; [core_node2:{\"core\":\"c8n_1x3_lf_shard1_replica3\",\"base_url\":\"http://127.0.0.1:34970/g_/hc\",\"node_name\":\"127.0.0.1:34970_g_%2Fhc\",\"state\":\"active\",\"leader\":\"true\"}]; clusterState: DocCollection(c8n_1x3_lf//clusterstate.json/35)={\n   [junit4]    >   \"replicationFactor\":\"3\",\n   [junit4]    >   \"shards\":{\"shard1\":{\n   [junit4]    >       \"range\":\"80000000-7fffffff\",\n   [junit4]    >       \"state\":\"active\",\n   [junit4]    >       \"replicas\":{\n   [junit4]    >         \"core_node1\":{\n   [junit4]    >           \"state\":\"down\",\n   [junit4]    >           \"base_url\":\"http://127.0.0.1:42251/g_/hc\",\n   [junit4]    >           \"core\":\"c8n_1x3_lf_shard1_replica1\",\n   [junit4]    >           \"node_name\":\"127.0.0.1:42251_g_%2Fhc\"},\n   [junit4]    >         \"core_node2\":{\n   [junit4]    >           \"core\":\"c8n_1x3_lf_shard1_replica3\",\n   [junit4]    >           \"base_url\":\"http://127.0.0.1:34970/g_/hc\",\n   [junit4]    >           \"node_name\":\"127.0.0.1:34970_g_%2Fhc\",\n   [junit4]    >           \"state\":\"active\",\n   [junit4]    >           \"leader\":\"true\"},\n   [junit4]    >         \"core_node3\":{\n   [junit4]    >           \"core\":\"c8n_1x3_lf_shard1_replica2\",\n   [junit4]    >           \"base_url\":\"http://127.0.0.1:44171/g_/hc\",\n   [junit4]    >           \"node_name\":\"127.0.0.1:44171_g_%2Fhc\",\n   [junit4]    >           \"state\":\"down\"}}}},\n   [junit4]    >   \"router\":{\"name\":\"compositeId\"},\n   [junit4]    >   \"maxShardsPerNode\":\"1\",\n   [junit4]    >   \"autoAddReplicas\":\"false\"}\n   [junit4]    >    at __randomizedtesting.SeedInfo.seed([27CA142284060548:AF9E2BF82AFA68B0]:0)\n   [junit4]    >    at org.apache.solr.cloud.LeaderFailoverAfterPartitionTest.testRf3WithLeaderFailover(LeaderFailoverAfterPartitionTest.java:170)\n   [junit4]    >    at org.apache.solr.cloud.LeaderFailoverAfterPartitionTest.test(LeaderFailoverAfterPartitionTest.java:57)\n   [junit4]    >    at org.apache.solr.BaseDistributedSearchTestCase$ShardsRepeatRule$ShardsFixedStatement.callStatement(BaseDistributedSearchTestCase.java:985)\n   [junit4]    >    at org.apache.solr.BaseDistributedSearchTestCase$ShardsRepeatRule$ShardsStatement.evaluate(BaseDistributedSearchTestCase.java:960)\n   [junit4]    >    at java.lang.Thread.run(Thread.java:745)\n   [junit4]   2> 134247 INFO  (SUITE-LeaderFailoverAfterPartitionTest-seed#[27CA142284060548]-worker) [    ] o.a.s.SolrTestCaseJ4 ###deleteCore\n   [junit4]   2> NOTE: leaving temporary files on disk at: /home/sarowe/temp/beast-tmp/10/J0/temp/solr.cloud.LeaderFailoverAfterPartitionTest_27CA142284060548-001\n   [junit4]   2> NOTE: test params are: codec=Asserting(Lucene62): {range_facet_l_dv=PostingsFormat(name=Direct), _version_=PostingsFormat(name=Asserting), multiDefault=FST50, a_t=FST50, intDefault=PostingsFormat(name=Asserting), id=PostingsFormat(name=Direct), range_facet_i_dv=FST50, text=Lucene50(blocksize=128), range_facet_l=FST50, timestamp=FST50}, docValues:{range_facet_l_dv=DocValuesFormat(name=Asserting), range_facet_i_dv=DocValuesFormat(name=Memory), timestamp=DocValuesFormat(name=Memory)}, maxPointsInLeafNode=1656, maxMBSortInHeap=7.964906340293555, sim=RandomSimilarity(queryNorm=false): {}, locale=sr-CS, timezone=Australia/Broken_Hill\n   [junit4]   2> NOTE: Linux 4.1.0-custom2-amd64 amd64/Oracle Corporation 1.8.0_77 (64-bit)/cpus=16,threads=1,free=395881832,total=463470592\n   [junit4]   2> NOTE: All tests run in this JVM: [LeaderFailoverAfterPartitionTest]\n   [junit4] Completed [1/1 (1!)] in 135.58s, 1 test, 1 failure <<< FAILURES!\n\n\n\n   [junit4]   2> NOTE: reproduce with: ant test  -Dtestcase=LeaderFailoverAfterPartitionTest -Dtests.method=test -Dtests.seed=E9EB73FAC98EC50A -Dtests.slow=true -Dtests.linedocsfile=/home/jenkins/lucene-data/enwiki.random.lines.txt -Dtests.locale=nl-BE -Dtests.timezone=Pacific/Tarawa -Dtests.asserts=true -Dtests.file.encoding=UTF-8\n\n\n\n   [junit4]   2> NOTE: reproduce with: ant test  -Dtestcase=LeaderFailoverAfterPartitionTest -Dtests.method=test -Dtests.seed=A882897C68035FAB -Dtests.slow=true -Dtests.linedocsfile=/home/jenkins/lucene-data/enwiki.random.lines.txt -Dtests.locale=ar-YE -Dtests.timezone=Asia/Calcutta -Dtests.asserts=true -Dtests.file.encoding=UTF-8\n\n\n\nAnd finally, 1 failure resulted from no registered leader after waiting 60 seconds - this did not reproduce for me on the first attempt:\n\n\n   [junit4]   2> NOTE: reproduce with: ant test  -Dtestcase=LeaderFailoverAfterPartitionTest -Dtests.method=test -Dtests.seed=EE7CD84A6ED0B0DF -Dtests.slow=true -Dtests.linedocsfile=/home/jenkins/lucene-data/enwiki.random.lines.txt -Dtests.locale=cs -Dtests.timezone=Australia/Sydney -Dtests.asserts=true -Dtests.file.encoding=UTF-8\n   [junit4] ERROR    653s | LeaderFailoverAfterPartitionTest.test <<<\n   [junit4]    > Throwable #1: org.apache.solr.common.SolrException: No registered leader was found after waiting for 60000ms , collection: c8n_1x3_lf slice: shard1\n   [junit4]    >    at __randomizedtesting.SeedInfo.seed([EE7CD84A6ED0B0DF:6628E790C02CDD27]:0)\n   [junit4]    >    at org.apache.solr.common.cloud.ZkStateReader.getLeaderRetry(ZkStateReader.java:746)\n   [junit4]    >    at org.apache.solr.cloud.LeaderFailoverAfterPartitionTest.testRf3WithLeaderFailover(LeaderFailoverAfterPartitionTest.java:150)\n   [junit4]    >    at org.apache.solr.cloud.LeaderFailoverAfterPartitionTest.test(LeaderFailoverAfterPartitionTest.java:57)\n   [junit4]    >    at org.apache.solr.BaseDistributedSearchTestCase$ShardsRepeatRule$ShardsFixedStatement.callStatement(BaseDistributedSearchTestCase.java:985)\n   [junit4]    >    at org.apache.solr.BaseDistributedSearchTestCase$ShardsRepeatRule$ShardsStatement.evaluate(BaseDistributedSearchTestCase.java:960)\n   [junit4]    >    at java.lang.Thread.run(Thread.java:745)\n   [junit4]   2> 652978 INFO  (SUITE-LeaderFailoverAfterPartitionTest-seed#[EE7CD84A6ED0B0DF]-worker) [    ] o.a.s.SolrTestCaseJ4 ###deleteCore\n   [junit4]   2> NOTE: leaving temporary files on disk at: /home/sarowe/temp/beast-tmp/55/J0/temp/solr.cloud.LeaderFailoverAfterPartitionTest_EE7CD84A6ED0B0DF-001\n   [junit4]   2> Aug 08, 2016 11:41:05 AM com.carrotsearch.randomizedtesting.ThreadLeakControl checkThreadLeaks\n   [junit4]   2> WARNING: Will linger awaiting termination of 1 leaked thread(s).\n   [junit4]   2> NOTE: test params are: codec=Asserting(Lucene62): {range_facet_l_dv=PostingsFormat(name=Memory doPackFST= true), _version_=PostingsFormat(name=LuceneVarGapDocFreqInterval), multiDefault=PostingsFormat(name=Direct), a_t=PostingsFormat(name=Direct), intDefault=PostingsFormat(name=LuceneVarGapDocFreqInterval), id=PostingsFormat(name=Memory doPackFST= true), range_facet_i_dv=PostingsFormat(name=Direct), text=Lucene50(blocksize=128), range_facet_l=PostingsFormat(name=Direct), timestamp=PostingsFormat(name=Direct)}, docValues:{range_facet_l_dv=DocValuesFormat(name=Lucene54), range_facet_i_dv=DocValuesFormat(name=Memory), timestamp=DocValuesFormat(name=Memory)}, maxPointsInLeafNode=1380, maxMBSortInHeap=5.763846995834594, sim=ClassicSimilarity, locale=cs, timezone=Australia/Sydney\n   [junit4]   2> NOTE: Linux 4.1.0-custom2-amd64 amd64/Oracle Corporation 1.8.0_77 (64-bit)/cpus=16,threads=1,free=397427336,total=486014976\n   [junit4]   2> NOTE: All tests run in this JVM: [LeaderFailoverAfterPartitionTest]\n   [junit4] Completed [1/1 (1!)] in 654.19s, 1 test, 1 error <<< FAILURES!\n\n ",
            "id": "comment-15412628"
        },
        {
            "date": "2016-09-21T10:16:35+0000",
            "author": "ASF subversion and git services",
            "content": "Commit bae66f7cca8cff796d142eb19585d8e79fae34f8 in lucene-solr's branch refs/heads/branch_6x from Alan Woodward\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=bae66f7 ]\n\nSOLR-9305, SOLR-9390: Don't use directToLeaders updates in partition tests (see SOLR-9512) ",
            "id": "comment-15509482"
        },
        {
            "date": "2016-09-21T10:16:42+0000",
            "author": "ASF subversion and git services",
            "content": "Commit d326adc8bfa33432d50293402a39454d60e070e4 in lucene-solr's branch refs/heads/master from Alan Woodward\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=d326adc ]\n\nSOLR-9305, SOLR-9390: Don't use directToLeaders updates in partition tests (see SOLR-9512) ",
            "id": "comment-15509486"
        },
        {
            "date": "2016-09-22T12:22:06+0000",
            "author": "ASF subversion and git services",
            "content": "Commit 00035c85114bc09c24c9cc9c0364030cf621d374 in lucene-solr's branch refs/heads/branch_6x from Alan Woodward\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=00035c8 ]\n\nSOLR-9305, SOLR-9390: really dont' use directToLeaders ",
            "id": "comment-15513140"
        },
        {
            "date": "2016-09-22T12:22:09+0000",
            "author": "ASF subversion and git services",
            "content": "Commit a41dd86e3cbb7799c2a6937d7bc0a07ec3c6e1a8 in lucene-solr's branch refs/heads/master from Alan Woodward\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=a41dd86 ]\n\nSOLR-9305, SOLR-9390: really dont' use directToLeaders ",
            "id": "comment-15513142"
        },
        {
            "date": "2016-09-26T22:11:02+0000",
            "author": "Alan Woodward",
            "content": "The ConnectionRefused failures have been fixed by disabling directToLeaders updates, but we're still getting occasional failures.  I think https://jenkins.thetaphi.de/job/Lucene-Solr-master-MacOSX/3566/ is caused by SOLR-9555, which as it's a race would explain why the failures don't reproduce. ",
            "id": "comment-15524338"
        }
    ]
}