{
    "id": "SOLR-4290",
    "title": "NPE if main query has no match when enable debugQuery for mlt handler",
    "details": {
        "affect_versions": "4.0",
        "status": "Open",
        "fix_versions": [],
        "components": [
            "MoreLikeThis"
        ],
        "type": "Bug",
        "priority": "Minor",
        "labels": "",
        "resolution": "Unresolved"
    },
    "description": "http://localhost:8983/solr/mlt?q=name:aaaa&mlt.fl=name,address&mlt.mindf=1&mlt.mintf=1&fl=*,score&echoParams=ALL&rows=2&debugQuery=true\n\n\n<response>\n<lst name=\"responseHeader\">\n<int name=\"status\">0</int>\n<int name=\"QTime\">3</int>\n<lst name=\"params\">\n<str name=\"mlt.mindf\">1</str>\n<str name=\"mlt.fl\">name,address</str>\n<str name=\"fl\">*,score</str>\n<str name=\"echoParams\">ALL</str>\n<str name=\"debugQuery\">true</str>\n<str name=\"q\">name:aaaa</str>\n<str name=\"mlt.mintf\">1</str>\n<str name=\"rows\">2</str>\n</lst>\n</lst>\n<result name=\"match\" numFound=\"0\" start=\"0\" maxScore=\"0.0\"/>\n<null name=\"response\"/>\n<str name=\"exception_during_debug\">\njava.lang.RuntimeException: java.lang.NullPointerException at org.apache.solr.search.QueryParsing.toString(QueryParsing.java:575) at org.apache.solr.util.SolrPluginUtils.doStandardQueryDebug(SolrPluginUtils.java:263) at org.apache.solr.util.SolrPluginUtils.doStandardDebug(SolrPluginUtils.java:242) at org.apache.solr.handler.MoreLikeThisHandler.handleRequestBody(MoreLikeThisHandler.java:236) at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:129) at org.apache.solr.core.SolrCore.execute(SolrCore.java:1699) at org.apache.solr.servlet.SolrDispatchFilter.execute(SolrDispatchFilter.java:455) at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:276) at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1337) at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:484) at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:119) at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:524) at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:233) at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1065) at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:413) at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:192) at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:999) at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:117) at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:250) at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:149) at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:111) at org.eclipse.jetty.server.Server.handle(Server.java:351) at org.eclipse.jetty.server.AbstractHttpConnection.handleRequest(AbstractHttpConnection.java:454) at org.eclipse.jetty.server.BlockingHttpConnection.handleRequest(BlockingHttpConnection.java:47) at org.eclipse.jetty.server.AbstractHttpConnection.headerComplete(AbstractHttpConnection.java:890) at org.eclipse.jetty.server.AbstractHttpConnection$RequestHandler.headerComplete(AbstractHttpConnection.java:944) at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:634) at org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:230) at org.eclipse.jetty.server.BlockingHttpConnection.handle(BlockingHttpConnection.java:66) at org.eclipse.jetty.server.bio.SocketConnector$ConnectorEndPoint.run(SocketConnector.java:254) at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:599) at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:534) at java.lang.Thread.run(Thread.java:680) Caused by: java.lang.NullPointerException at org.apache.solr.search.QueryParsing.toString(QueryParsing.java:544) at org.apache.solr.search.QueryParsing.toString(QueryParsing.java:572) ... 32 more\n</str>",
    "attachments": {},
    "issue_links": {},
    "comments": []
}