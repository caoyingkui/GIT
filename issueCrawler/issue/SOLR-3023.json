{
    "id": "SOLR-3023",
    "title": "IndexOutOfBoundsException after disk full on replication",
    "details": {
        "affect_versions": "3.5",
        "status": "Open",
        "fix_versions": [],
        "components": [
            "replication (java)"
        ],
        "type": "Bug",
        "priority": "Major",
        "labels": "",
        "resolution": "Unresolved"
    },
    "description": "I am running Solr 3.5 with a master/slave configuration. Master instance handles indexing; slave handles queries. I was investigating why changes to schema.xml were not propogating to production servers (specifically, implementing index-time synonyms) and saw that my EBS volume was full (15GB). After freeing some space by deleting an old Solr 3.4 installation that was no longer being used, I began seeing the following errors from the slave:\n\nJan 10, 2012 6:57:33 PM org.apache.solr.common.SolrException log\nSEVERE: java.lang.IndexOutOfBoundsException: Index: 108, Size: 40\n\tat java.util.ArrayList.RangeCheck(ArrayList.java:547)\n\tat java.util.ArrayList.get(ArrayList.java:322)\n\tat org.apache.lucene.index.FieldInfos.fieldInfo(FieldInfos.java:299)\n\tat org.apache.lucene.index.FieldsReader.doc(FieldsReader.java:238)\n\tat org.apache.lucene.index.SegmentReader.document(SegmentReader.java:477)\n\tat org.apache.lucene.index.DirectoryReader.document(DirectoryReader.java:583)\n\tat org.apache.solr.search.SolrIndexReader.document(SolrIndexReader.java:260)\n\tat org.apache.solr.search.SolrIndexSearcher.doc(SolrIndexSearcher.java:452)\n\tat org.apache.solr.util.SolrPluginUtils.optimizePreFetchDocs(SolrPluginUtils.java:271)\n\tat org.apache.solr.handler.component.QueryComponent.doPrefetch(QueryComponent.java:478)\n\tat org.apache.solr.handler.component.QueryComponent.process(QueryComponent.java:385)\n\tat org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:194)\n\tat org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:129)\n\tat org.apache.solr.core.SolrCore.execute(SolrCore.java:1372)\n\tat org.apache.solr.servlet.SolrDispatchFilter.execute(SolrDispatchFilter.java:356)\n\tat org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:252)\n\tat org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1212)\n\tat org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:399)\n\tat org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)\n\tat org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)\n\tat org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:766)\n\tat org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:450)\n\tat org.mortbay.jetty.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:230)\n\tat org.mortbay.jetty.handler.HandlerCollection.handle(HandlerCollection.java:114)\n\tat org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)\n\tat org.mortbay.jetty.Server.handle(Server.java:326)\n\tat org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)\n\tat org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:928)\n\tat org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:549)\n\tat org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:212)\n\tat org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)\n\tat org.mortbay.jetty.bio.SocketConnector$Connection.run(SocketConnector.java:228)\n\tat org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582)\n\nThis was happening inconsistently. That is, some queries would be handled, some would not. For instance, the page at http://att-veterans.jobs would NOT render, but e.g. http://lockheedmartin.jobs would. Restarting the Jetty server did not alleviate the problem. I diverted all queries to my master instance, which ran fine with no errors.\n\nUltimately I solved the issue by deleting the index files and replicating, then put the slave back into service.",
    "attachments": {},
    "issue_links": {},
    "comments": []
}