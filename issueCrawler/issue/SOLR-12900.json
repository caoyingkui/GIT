{
    "id": "SOLR-12900",
    "title": "NPE in OneComparatorFieldValueHitQueue.lessThan while indexing",
    "details": {
        "type": "Bug",
        "status": "Open",
        "labels": "",
        "fix_versions": [],
        "components": [
            "search"
        ],
        "priority": "Major",
        "resolution": "Unresolved",
        "affect_versions": "6.6.1"
    },
    "description": "I get occasionally this NPE while searching and the Solr process finishes.\n\n\u00a0\n\n23-oct-2018 15:04:50 INFO: [Products] webapp=/solr path=/select params={q=:&facet.limit=10000&spellcheck.maxResultsForSuggest=0&spellcheck=true&fl=ID,LAST_MODIFIED,INDEXED&start=2300000&facet.mincount=1&sort=ID+asc&rows=100000&facet.sort=index} hits=4598058 status=0 QTime=6958\n23-oct-2018 15:04:56 SEVERE: java.lang.NullPointerException\n at org.apache.lucene.search.FieldValueHitQueue$OneComparatorFieldValueHitQueue.lessThan(FieldValueHitQueue.java:56)\n at org.apache.lucene.util.PriorityQueue.downHeap(PriorityQueue.java:284)\n at org.apache.lucene.util.PriorityQueue.pop(PriorityQueue.java:184)\n at org.apache.lucene.search.TopFieldCollector.populateResults(TopFieldCollector.java:425)\n at org.apache.lucene.search.TopDocsCollector.topDocs(TopDocsCollector.java:156)\n at org.apache.solr.search.SolrIndexSearcher.getDocListNC(SolrIndexSearcher.java:1585)\n at org.apache.solr.search.SolrIndexSearcher.getDocListC(SolrIndexSearcher.java:1399)\n at org.apache.solr.search.SolrIndexSearcher.search(SolrIndexSearcher.java:566)\n at org.apache.solr.handler.component.QueryComponent.process(QueryComponent.java:545)\n at org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:296)\n at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:173)\n at org.apache.solr.core.SolrCore.execute(SolrCore.java:2477)\n at org.apache.solr.servlet.HttpSolrCall.execute(HttpSolrCall.java:723)\n at org.apache.solr.servlet.HttpSolrCall.call(HttpSolrCall.java:529)\n at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:361)\n at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:305)\n at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1691)\n at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:582)\n at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)\n at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:548)\n at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:226)\n at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1180)\n at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:512)\n at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)\n at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1112)\n at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)\n at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:213)\n at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:119)\n at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:134)\n at org.eclipse.jetty.server.Server.handle(Server.java:534)\n at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:320)\n at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:251)\n at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:273)\n at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:95)\n at org.eclipse.jetty.io.SelectChannelEndPoint$2.run(SelectChannelEndPoint.java:93)\n at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.executeProduceConsume(ExecuteProduceConsume.java:303)\n at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.produceConsume(ExecuteProduceConsume.java:148)\n at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.run(ExecuteProduceConsume.java:136)\n at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:671)\n at org.eclipse.jetty.util.thread.QueuedThreadPool$2.run(QueuedThreadPool.java:589)\n at java.lang.Thread.run(Thread.java:745)",
    "attachments": {},
    "issue_links": {},
    "comments": []
}