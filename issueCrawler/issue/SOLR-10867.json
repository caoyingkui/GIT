{
    "id": "SOLR-10867",
    "title": "Make ClassificationUpdateProcessorFactory as Runtime URP; take params(s) with request",
    "details": {
        "labels": "",
        "priority": "Minor",
        "components": [
            "update"
        ],
        "type": "Sub-task",
        "fix_versions": [],
        "affect_versions": "None",
        "resolution": "Unresolved",
        "status": "Open"
    },
    "description": "We are trying to get rid of processor definitions in SolrConfig for all URPs and take parameters in the request itself.\n\nClassificationUpdateProcessorFactory will be able to execute by sample curl like below:\n\n\ncurl -X POST -H Content-Type: application/json  http://localhost:8983/solr/test/update/json/docs?processor=Classification&classification.fieldName=url_s&classification.classField=training&commit=true --data-binary { \"id\" : \"1\" , \"url_s\" : \"http://www.example.com/subroot\" }\n\n\n\nAll the param(s) for this URP available can be passed as request handler param(s).\n\nConfiguration for ClassificationUpdateProcessorFactory in solrconfig.xml is optional.",
    "attachments": {
        "error_test": "https://issues.apache.org/jira/secure/attachment/12872704/error_test",
        "SOLR-10867.patch": "https://issues.apache.org/jira/secure/attachment/12872450/SOLR-10867.patch"
    },
    "issue_links": {},
    "comments": [
        {
            "date": "2017-06-10T18:47:22+0000",
            "content": "Initial patch uploaded. \n\nClassificationUpdateProcessorFactoryTest is failing miserably right now as all the test methods verify init for the config param(s). Will fix them and update shortly. ",
            "author": "Amrit Sarkar",
            "id": "comment-16045651"
        },
        {
            "date": "2017-06-11T21:09:01+0000",
            "content": "Got everything in order, revamped all the tests but running into temp_index & cache directories error while deleting and thread leaks all over the place.\n\nerror attached ::\n\n\n   [junit4]   2> 40694 INFO  (coreCloseExecutor-34-thread-1) [    x:collection1] o.a.s.c.SolrCore [collection1]  CLOSING SolrCore org.apache.solr.core.SolrCore@3db54c55\n   [junit4]   2> 40705 INFO  (coreCloseExecutor-34-thread-1) [    x:collection1] o.a.s.m.SolrMetricManager Closing metric reporters for registry=solr.core.collection1, tag=1035291733\n   [junit4]   2> 53230 ERROR (coreCloseExecutor-34-thread-1) [    x:collection1] o.a.s.c.CachingDirectoryFactory Timeout waiting for all directory ref counts to be released - gave up waiting on CachedDir<<refCount=1;path=/Users/amritsarkar/git_space/solr-june/lucene-solr/solr/build/solr-core/test/J0/temp/solr.update.processor.ClassificationUpdateProcessorFactoryTest_CB3D76759FFD28BA-001/init-core-data-001/index;done=false>>\n   [junit4]   2> 53231 ERROR (coreCloseExecutor-34-thread-1) [    x:collection1] o.a.s.c.CachingDirectoryFactory Error closing directory:org.apache.solr.common.SolrException: Timeout waiting for all directory ref counts to be released - gave up waiting on CachedDir<<refCount=1;path=/Users/amritsarkar/git_space/solr-june/lucene-solr/solr/build/solr-core/test/J0/temp/solr.update.processor.ClassificationUpdateProcessorFactoryTest_CB3D76759FFD28BA-001/init-core-data-001/index;done=false>>\n   [junit4]   2> \tat org.apache.solr.core.CachingDirectoryFactory.close(CachingDirectoryFactory.java:177)\n   [junit4]   2> \tat org.apache.solr.core.SolrCore.close(SolrCore.java:1617)\n   [junit4]   2> \tat org.apache.solr.core.SolrCores.lambda$close$0(SolrCores.java:132)\n   [junit4]   2> \tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\n   [junit4]   2> \tat org.apache.solr.common.util.ExecutorUtil$MDCAwareThreadPoolExecutor.lambda$execute$0(ExecutorUtil.java:188)\n   [junit4]   2> \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n   [junit4]   2> \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n   [junit4]   2> \tat java.lang.Thread.run(Thread.java:745)\n   [junit4]   2> \n   [junit4]   2> 53233 ERROR (coreCloseExecutor-34-thread-1) [    x:collection1] o.a.s.c.SolrCore java.lang.AssertionError: 1\n   [junit4]   2> \tat org.apache.solr.core.CachingDirectoryFactory.close(CachingDirectoryFactory.java:191)\n   [junit4]   2> \tat org.apache.solr.core.SolrCore.close(SolrCore.java:1617)\n   [junit4]   2> \tat org.apache.solr.core.SolrCores.lambda$close$0(SolrCores.java:132)\n   [junit4]   2> \tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\n   [junit4]   2> \tat org.apache.solr.common.util.ExecutorUtil$MDCAwareThreadPoolExecutor.lambda$execute$0(ExecutorUtil.java:188)\n   [junit4]   2> \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n   [junit4]   2> \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n   [junit4]   2> \tat java.lang.Thread.run(Thread.java:745)\n   [junit4]   2> \n   [junit4]   2> 53233 ERROR (coreCloseExecutor-34-thread-1) [    x:collection1] o.a.s.c.SolrCores Error shutting down core:java.lang.AssertionError: 1\n   [junit4]   2> \tat org.apache.solr.core.CachingDirectoryFactory.close(CachingDirectoryFactory.java:191)\n   [junit4]   2> \tat org.apache.solr.core.SolrCore.close(SolrCore.java:1617)\n   [junit4]   2> \tat org.apache.solr.core.SolrCores.lambda$close$0(SolrCores.java:132)\n   [junit4]   2> \tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\n   [junit4]   2> \tat org.apache.solr.common.util.ExecutorUtil$MDCAwareThreadPoolExecutor.lambda$execute$0(ExecutorUtil.java:188)\n   [junit4]   2> \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n   [junit4]   2> \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n   [junit4]   2> \tat java.lang.Thread.run(Thread.java:745)\n   [junit4]   2> \n   [junit4]   2> NOTE: leaving temporary files on disk at: /Users/amritsarkar/git_space/solr-june/lucene-solr/solr/build/solr-core/test/J0/temp/solr.update.processor.ClassificationUpdateProcessorFactoryTest_CB3D76759FFD28BA-001\n   [junit4]   2> Jun 12, 2017 2:13:52 AM com.carrotsearch.randomizedtesting.ThreadLeakControl checkThreadLeaks\n   [junit4]   2> WARNING: Will linger awaiting termination of 8 leaked thread(s).\n   [junit4]   2> Jun 12, 2017 2:14:12 AM com.carrotsearch.randomizedtesting.ThreadLeakControl checkThreadLeaks\n   [junit4]   2> SEVERE: 8 threads leaked from SUITE scope at org.apache.solr.update.processor.ClassificationUpdateProcessorFactoryTest: \n   [junit4]   2>    1) Thread[id=16, name=Thread-1, state=WAITING, group=TGRP-ClassificationUpdateProcessorFactoryTest]\n   [junit4]   2>         at java.lang.Object.wait(Native Method)\n   [junit4]   2>         at java.lang.Object.wait(Object.java:502)\n   [junit4]   2>         at org.apache.solr.core.CloserThread.run(CoreContainer.java:1580)\n   [junit4]   2>    2) Thread[id=24, name=searcherExecutor-18-thread-1, state=WAITING, group=TGRP-ClassificationUpdateProcessorFactoryTest]\n   [junit4]   2>         at sun.misc.Unsafe.park(Native Method)\n   [junit4]   2>         at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175)\n   [junit4]   2>         at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2039)\n   [junit4]   2>         at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)\n   [junit4]   2>         at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1067)\n   [junit4]   2>         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1127)\n   [junit4]   2>         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n   [junit4]   2>         at java.lang.Thread.run(Thread.java:745)\n   [junit4]   2>    3) Thread[id=18, name=searcherExecutor-7-thread-1, state=WAITING, group=TGRP-ClassificationUpdateProcessorFactoryTest]\n   [junit4]   2>         at sun.misc.Unsafe.park(Native Method)\n   [junit4]   2>         at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175)\n   [junit4]   2>         at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2039)\n   [junit4]   2>         at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)\n   [junit4]   2>         at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1067)\n   [junit4]   2>         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1127)\n   [junit4]   2>         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n   [junit4]   2>         at java.lang.Thread.run(Thread.java:745)\n   [junit4]   2>    4) Thread[id=20, name=Connection evictor, state=TIMED_WAITING, group=TGRP-ClassificationUpdateProcessorFactoryTest]\n   [junit4]   2>         at java.lang.Thread.sleep(Native Method)\n   [junit4]   2>         at org.apache.http.impl.client.IdleConnectionEvictor$1.run(IdleConnectionEvictor.java:66)\n   [junit4]   2>         at java.lang.Thread.run(Thread.java:745)\n   [junit4]   2>    5) Thread[id=22, name=Thread-2, state=WAITING, group=TGRP-ClassificationUpdateProcessorFactoryTest]\n   [junit4]   2>         at java.lang.Object.wait(Native Method)\n   [junit4]   2>         at java.lang.Object.wait(Object.java:502)\n   [junit4]   2>         at org.apache.solr.core.CloserThread.run(CoreContainer.java:1580)\n   [junit4]   2>    6) Thread[id=13, name=Connection evictor, state=TIMED_WAITING, group=TGRP-ClassificationUpdateProcessorFactoryTest]\n   [junit4]   2>         at java.lang.Thread.sleep(Native Method)\n   [junit4]   2>         at org.apache.http.impl.client.IdleConnectionEvictor$1.run(IdleConnectionEvictor.java:66)\n   [junit4]   2>         at java.lang.Thread.run(Thread.java:745)\n   [junit4]   2>    7) Thread[id=14, name=Connection evictor, state=TIMED_WAITING, group=TGRP-ClassificationUpdateProcessorFactoryTest]\n   [junit4]   2>         at java.lang.Thread.sleep(Native Method)\n   [junit4]   2>         at org.apache.http.impl.client.IdleConnectionEvictor$1.run(IdleConnectionEvictor.java:66)\n   [junit4]   2>         at java.lang.Thread.run(Thread.java:745)\n   [junit4]   2>    8) Thread[id=19, name=Connection evictor, state=TIMED_WAITING, group=TGRP-ClassificationUpdateProcessorFactoryTest]\n   [junit4]   2>         at java.lang.Thread.sleep(Native Method)\n   [junit4]   2>         at org.apache.http.impl.client.IdleConnectionEvictor$1.run(IdleConnectionEvictor.java:66)\n   [junit4]   2>         at java.lang.Thread.run(Thread.java:745)\n   [junit4]   2> Jun 12, 2017 2:14:12 AM com.carrotsearch.randomizedtesting.ThreadLeakControl tryToInterruptAll\n   [junit4]   2> INFO: Starting to interrupt leaked threads:\n   [junit4]   2>    1) Thread[id=16, name=Thread-1, state=WAITING, group=TGRP-ClassificationUpdateProcessorFactoryTest]\n   [junit4]   2>    2) Thread[id=24, name=searcherExecutor-18-thread-1, state=WAITING, group=TGRP-ClassificationUpdateProcessorFactoryTest]\n   [junit4]   2>    3) Thread[id=18, name=searcherExecutor-7-thread-1, state=WAITING, group=TGRP-ClassificationUpdateProcessorFactoryTest]\n   [junit4]   2>    4) Thread[id=20, name=Connection evictor, state=TIMED_WAITING, group=TGRP-ClassificationUpdateProcessorFactoryTest]\n   [junit4]   2>    5) Thread[id=22, name=Thread-2, state=WAITING, group=TGRP-ClassificationUpdateProcessorFactoryTest]\n   [junit4]   2>    6) Thread[id=13, name=Connection evictor, state=TIMED_WAITING, group=TGRP-ClassificationUpdateProcessorFactoryTest]\n   [junit4]   2>    7) Thread[id=14, name=Connection evictor, state=TIMED_WAITING, group=TGRP-ClassificationUpdateProcessorFactoryTest]\n   [junit4]   2>    8) Thread[id=19, name=Connection evictor, state=TIMED_WAITING, group=TGRP-ClassificationUpdateProcessorFactoryTest]\n   [junit4]   2> Jun 12, 2017 2:14:15 AM com.carrotsearch.randomizedtesting.ThreadLeakControl tryToInterruptAll\n   [junit4]   2> SEVERE: There are still zombie threads that couldn't be terminated:\n   [junit4]   2>    1) Thread[id=16, name=Thread-1, state=WAITING, group=TGRP-ClassificationUpdateProcessorFactoryTest]\n   [junit4]   2>         at java.lang.Object.wait(Native Method)\n   [junit4]   2>         at java.lang.Object.wait(Object.java:502)\n   [junit4]   2>         at org.apache.solr.core.CloserThread.run(CoreContainer.java:1580)\n   [junit4]   2>    2) Thread[id=24, name=searcherExecutor-18-thread-1, state=WAITING, group=TGRP-ClassificationUpdateProcessorFactoryTest]\n   [junit4]   2>         at sun.misc.Unsafe.park(Native Method)\n   [junit4]   2>         at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175)\n   [junit4]   2>         at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2039)\n   [junit4]   2>         at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)\n   [junit4]   2>         at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1067)\n   [junit4]   2>         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1127)\n   [junit4]   2>         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n   [junit4]   2>         at java.lang.Thread.run(Thread.java:745)\n   [junit4]   2>    3) Thread[id=18, name=searcherExecutor-7-thread-1, state=WAITING, group=TGRP-ClassificationUpdateProcessorFactoryTest]\n   [junit4]   2>         at sun.misc.Unsafe.park(Native Method)\n   [junit4]   2>         at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175)\n   [junit4]   2>         at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2039)\n   [junit4]   2>         at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)\n   [junit4]   2>         at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1067)\n   [junit4]   2>         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1127)\n   [junit4]   2>         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n   [junit4]   2>         at java.lang.Thread.run(Thread.java:745)\n   [junit4]   2>    4) Thread[id=22, name=Thread-2, state=WAITING, group=TGRP-ClassificationUpdateProcessorFactoryTest]\n   [junit4]   2>         at java.lang.Object.wait(Native Method)\n   [junit4]   2>         at java.lang.Object.wait(Object.java:502)\n   [junit4]   2>         at org.apache.solr.core.CloserThread.run(CoreContainer.java:1580)\n   [junit4]   2> NOTE: test params are: codec=Asserting(Lucene70): {}, docValues:{}, maxPointsInLeafNode=1361, maxMBSortInHeap=6.604083401501194, sim=RandomSimilarity(queryNorm=false): {}, locale=en-AU, timezone=Europe/Ljubljana\n   [junit4]   2> NOTE: Mac OS X 10.12.5 x86_64/Oracle Corporation 1.8.0_102 (64-bit)/cpus=4,threads=5,free=195571224,total=226492416\n   [junit4]   2> NOTE: All tests run in this JVM: [ClassificationUpdateProcessorFactoryTest]\n   [junit4]   2> NOTE: reproduce with: ant test  -Dtestcase=ClassificationUpdateProcessorFactoryTest -Dtests.seed=CB3D76759FFD28BA -Dtests.slow=true -Dtests.locale=en-AU -Dtests.timezone=Europe/Ljubljana -Dtests.asserts=true -Dtests.file.encoding=UTF-8\n   [junit4] ERROR   0.00s | ClassificationUpdateProcessorFactoryTest (suite) <<<\n   [junit4]    > Throwable #1: com.carrotsearch.randomizedtesting.ThreadLeakError: 8 threads leaked from SUITE scope at org.apache.solr.update.processor.ClassificationUpdateProcessorFactoryTest: \n   [junit4]    >    1) Thread[id=16, name=Thread-1, state=WAITING, group=TGRP-ClassificationUpdateProcessorFactoryTest]\n   [junit4]    >         at java.lang.Object.wait(Native Method)\n   [junit4]    >         at java.lang.Object.wait(Object.java:502)\n   [junit4]    >         at org.apache.solr.core.CloserThread.run(CoreContainer.java:1580)\n   [junit4]    >    2) Thread[id=24, name=searcherExecutor-18-thread-1, state=WAITING, group=TGRP-ClassificationUpdateProcessorFactoryTest]\n   [junit4]    >         at sun.misc.Unsafe.park(Native Method)\n   [junit4]    >         at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175)\n   [junit4]    >         at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2039)\n   [junit4]    >         at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)\n   [junit4]    >         at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1067)\n   [junit4]    >         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1127)\n   [junit4]    >         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n   [junit4]    >         at java.lang.Thread.run(Thread.java:745)\n   [junit4]    >    3) Thread[id=18, name=searcherExecutor-7-thread-1, state=WAITING, group=TGRP-ClassificationUpdateProcessorFactoryTest]\n   [junit4]    >         at sun.misc.Unsafe.park(Native Method)\n   [junit4]    >         at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175)\n   [junit4]    >         at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2039)\n   [junit4]    >         at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)\n   [junit4]    >         at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1067)\n   [junit4]    >         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1127)\n   [junit4]    >         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n   [junit4]    >         at java.lang.Thread.run(Thread.java:745)\n   [junit4]    >    4) Thread[id=20, name=Connection evictor, state=TIMED_WAITING, group=TGRP-ClassificationUpdateProcessorFactoryTest]\n   [junit4]    >         at java.lang.Thread.sleep(Native Method)\n   [junit4]    >         at org.apache.http.impl.client.IdleConnectionEvictor$1.run(IdleConnectionEvictor.java:66)\n   [junit4]    >         at java.lang.Thread.run(Thread.java:745)\n   [junit4]    >    5) Thread[id=22, name=Thread-2, state=WAITING, group=TGRP-ClassificationUpdateProcessorFactoryTest]\n   [junit4]    >         at java.lang.Object.wait(Native Method)\n   [junit4]    >         at java.lang.Object.wait(Object.java:502)\n   [junit4]    >         at org.apache.solr.core.CloserThread.run(CoreContainer.java:1580)\n   [junit4]    >    6) Thread[id=13, name=Connection evictor, state=TIMED_WAITING, group=TGRP-ClassificationUpdateProcessorFactoryTest]\n   [junit4]    >         at java.lang.Thread.sleep(Native Method)\n   [junit4]    >         at org.apache.http.impl.client.IdleConnectionEvictor$1.run(IdleConnectionEvictor.java:66)\n   [junit4]    >         at java.lang.Thread.run(Thread.java:745)\n   [junit4]    >    7) Thread[id=14, name=Connection evictor, state=TIMED_WAITING, group=TGRP-ClassificationUpdateProcessorFactoryTest]\n   [junit4]    >         at java.lang.Thread.sleep(Native Method)\n   [junit4]    >         at org.apache.http.impl.client.IdleConnectionEvictor$1.run(IdleConnectionEvictor.java:66)\n   [junit4]    >         at java.lang.Thread.run(Thread.java:745)\n   [junit4]    >    8) Thread[id=19, name=Connection evictor, state=TIMED_WAITING, group=TGRP-ClassificationUpdateProcessorFactoryTest]\n   [junit4]    >         at java.lang.Thread.sleep(Native Method)\n   [junit4]    >         at org.apache.http.impl.client.IdleConnectionEvictor$1.run(IdleConnectionEvictor.java:66)\n   [junit4]    >         at java.lang.Thread.run(Thread.java:745)\n   [junit4]    > \tat __randomizedtesting.SeedInfo.seed([CB3D76759FFD28BA]:0)Throwable #2: com.carrotsearch.randomizedtesting.ThreadLeakError: There are still zombie threads that couldn't be terminated:\n   [junit4]    >    1) Thread[id=16, name=Thread-1, state=WAITING, group=TGRP-ClassificationUpdateProcessorFactoryTest]\n   [junit4]    >         at java.lang.Object.wait(Native Method)\n   [junit4]    >         at java.lang.Object.wait(Object.java:502)\n   [junit4]    >         at org.apache.solr.core.CloserThread.run(CoreContainer.java:1580)\n   [junit4]    >    2) Thread[id=24, name=searcherExecutor-18-thread-1, state=WAITING, group=TGRP-ClassificationUpdateProcessorFactoryTest]\n   [junit4]    >         at sun.misc.Unsafe.park(Native Method)\n   [junit4]    >         at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175)\n   [junit4]    >         at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2039)\n   [junit4]    >         at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)\n   [junit4]    >         at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1067)\n   [junit4]    >         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1127)\n   [junit4]    >         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n   [junit4]    >         at java.lang.Thread.run(Thread.java:745)\n   [junit4]    >    3) Thread[id=18, name=searcherExecutor-7-thread-1, state=WAITING, group=TGRP-ClassificationUpdateProcessorFactoryTest]\n   [junit4]    >         at sun.misc.Unsafe.park(Native Method)\n   [junit4]    >         at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175)\n   [junit4]    >         at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2039)\n   [junit4]    >         at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)\n   [junit4]    >         at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1067)\n   [junit4]    >         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1127)\n   [junit4]    >         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n   [junit4]    >         at java.lang.Thread.run(Thread.java:745)\n   [junit4]    >    4) Thread[id=22, name=Thread-2, state=WAITING, group=TGRP-ClassificationUpdateProcessorFactoryTest]\n   [junit4]    >         at java.lang.Object.wait(Native Method)\n   [junit4]    >         at java.lang.Object.wait(Object.java:502)\n   [junit4]    >         at org.apache.solr.core.CloserThread.run(CoreContainer.java:1580)\n   [junit4]    > \tat __randomizedtesting.SeedInfo.seed([CB3D76759FFD28BA]:0)\n   [junit4] Completed [1/1 (1!)] in 77.97s, 3 tests, 3 errors <<< FAILURES!\n   [junit4] \n   [junit4] \n   [junit4] Tests with failures [seed: CB3D76759FFD28BA]:\n   [junit4]   - org.apache.solr.update.processor.ClassificationUpdateProcessorFactoryTest.init_fullArgs_shouldInitFullClassificationParams\n   [junit4]   - org.apache.solr.update.processor.ClassificationUpdateProcessorFactoryTest (suite)\n\n\n\nWhat's wrong. ",
            "author": "Amrit Sarkar",
            "id": "comment-16046118"
        },
        {
            "date": "2017-06-12T11:31:57+0000",
            "content": "The initCore call is usually done in a BeforeClass static context. Maybe that's the reason? ",
            "author": "Shalin Shekhar Mangar",
            "id": "comment-16046459"
        },
        {
            "date": "2017-06-12T13:30:22+0000",
            "content": "Thanks Shalin Shekhar Mangar for the correction, I have to be more careful,  Well that rectified thread leaks rightfully as only one core is being created in the main thread, the temp index dir is still creating issue while getting removed at core destruction.\n\nUpdate patch and error:\n\n\n[junit4]   2> 28935 ERROR (coreCloseExecutor-12-thread-1) [    x:collection1] o.a.s.c.CachingDirectoryFactory Timeout waiting for all directory ref counts to be released - gave up waiting on CachedDir<<refCount=1;path=/Users/amritsarkar/git_space/solr-june/lucene-solr/solr/build/solr-core/test/J0/temp/solr.update.processor.ClassificationUpdateProcessorFactoryTest_57912E1D960F4206-001/init-core-data-001/index;done=false>>\n   [junit4]   2> 28936 ERROR (coreCloseExecutor-12-thread-1) [    x:collection1] o.a.s.c.CachingDirectoryFactory Error closing directory:org.apache.solr.common.SolrException: Timeout waiting for all directory ref counts to be released - gave up waiting on CachedDir<<refCount=1;path=/Users/amritsarkar/git_space/solr-june/lucene-solr/solr/build/solr-core/test/J0/temp/solr.update.processor.ClassificationUpdateProcessorFactoryTest_57912E1D960F4206-001/init-core-data-001/index;done=false>>\n   [junit4]   2> \tat org.apache.solr.core.CachingDirectoryFactory.close(CachingDirectoryFactory.java:177)\n   [junit4]   2> \tat org.apache.solr.core.SolrCore.close(SolrCore.java:1617)\n   [junit4]   2> \tat org.apache.solr.core.SolrCores.lambda$close$0(SolrCores.java:132)\n   [junit4]   2> \tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\n   [junit4]   2> \tat org.apache.solr.common.util.ExecutorUtil$MDCAwareThreadPoolExecutor.lambda$execute$0(ExecutorUtil.java:188)\n   [junit4]   2> \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n   [junit4]   2> \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n   [junit4]   2> \tat java.lang.Thread.run(Thread.java:745)\n   [junit4]   2> \n   [junit4]   2> 28936 ERROR (coreCloseExecutor-12-thread-1) [    x:collection1] o.a.s.c.SolrCore java.lang.AssertionError: 1\n   [junit4]   2> \tat org.apache.solr.core.CachingDirectoryFactory.close(CachingDirectoryFactory.java:191)\n   [junit4]   2> \tat org.apache.solr.core.SolrCore.close(SolrCore.java:1617)\n   [junit4]   2> \tat org.apache.solr.core.SolrCores.lambda$close$0(SolrCores.java:132)\n   [junit4]   2> \tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\n   [junit4]   2> \tat org.apache.solr.common.util.ExecutorUtil$MDCAwareThreadPoolExecutor.lambda$execute$0(ExecutorUtil.java:188)\n   [junit4]   2> \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n   [junit4]   2> \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n   [junit4]   2> \tat java.lang.Thread.run(Thread.java:745)\n   [junit4]   2> \n   [junit4]   2> 28937 ERROR (coreCloseExecutor-12-thread-1) [    x:collection1] o.a.s.c.SolrCores Error shutting down core:java.lang.AssertionError: 1\n   [junit4]   2> \tat org.apache.solr.core.CachingDirectoryFactory.close(CachingDirectoryFactory.java:191)\n   [junit4]   2> \tat org.apache.solr.core.SolrCore.close(SolrCore.java:1617)\n   [junit4]   2> \tat org.apache.solr.core.SolrCores.lambda$close$0(SolrCores.java:132)\n   [junit4]   2> \tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\n   [junit4]   2> \tat org.apache.solr.common.util.ExecutorUtil$MDCAwareThreadPoolExecutor.lambda$execute$0(ExecutorUtil.java:188)\n   [junit4]   2> \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n   [junit4]   2> \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n   [junit4]   2> \tat java.lang.Thread.run(Thread.java:745)\n   [junit4]   2> \n   [junit4]   2> NOTE: leaving temporary files on disk at: /Users/amritsarkar/git_space/solr-june/lucene-solr/solr/build/solr-core/test/J0/temp/solr.update.processor.ClassificationUpdateProcessorFactoryTest_57912E1D960F4206-001\n   [junit4]   2> NOTE: test params are: codec=Asserting(Lucene70): {}, docValues:{}, maxPointsInLeafNode=1994, maxMBSortInHeap=5.2024544371149295, sim=RandomSimilarity(queryNorm=true): {}, locale=fr, timezone=America/Yellowknife\n   [junit4]   2> NOTE: Mac OS X 10.12.5 x86_64/Oracle Corporation 1.8.0_102 (64-bit)/cpus=4,threads=1,free=48193632,total=220200960\n   [junit4]   2> NOTE: All tests run in this JVM: [ClassificationUpdateProcessorFactoryTest]\n   [junit4] Completed [1/1 (1!)] in 30.49s, 3 tests, 1 error <<< FAILURES!\n   [junit4] \n   [junit4] \n   [junit4] Tests with failures [seed: 57912E1D960F4206]:\n   [junit4]   - org.apache.solr.update.processor.ClassificationUpdateProcessorFactoryTest.init_fullArgs_shouldInitFullClassificationParams\n   [junit4] \n   [junit4] \n   [junit4] JVM J0:    15.50 ..    42.04 =    26.55s\n   [junit4] Execution time total: 42 seconds\n   [junit4] Tests summary: 1 suite, 3 tests, 1 error\n\n\n\nI have posted the entire ant -Dtestcase=ClassificationUpdateProcessorFactoryTest test log snippet. ",
            "author": "Amrit Sarkar",
            "id": "comment-16046556"
        },
        {
            "date": "2017-06-12T13:39:23+0000",
            "content": "I see a test failure in your logs because of which the resources are not being correctly released:\n\n   [junit4] ERROR   0.03s | ClassificationUpdateProcessorFactoryTest.init_fullArgs_shouldInitFullClassificationParams <<<\n   [junit4]    > Throwable #1: org.apache.solr.common.SolrException: Classification UpdateProcessor 'classField' can not be null\n   [junit4]    > \tat __randomizedtesting.SeedInfo.seed([72930463E0C8A2F7:A71DC99A39853BE1]:0)\n   [junit4]    > \tat org.apache.solr.update.processor.ClassificationUpdateProcessorFactory.checkNotNull(ClassificationUpdateProcessorFactory.java:115)\n   [junit4]    > \tat org.apache.solr.update.processor.ClassificationUpdateProcessorFactory.populateParams(ClassificationUpdateProcessorFactory.java:137)\n   [junit4]    > \tat org.apache.solr.update.processor.ClassificationUpdateProcessorFactory.getInstance(ClassificationUpdateProcessorFactory.java:225)\n   [junit4]    > \tat org.apache.solr.update.processor.ClassificationUpdateProcessorFactoryTest.init_fullArgs_shouldInitFullClassificationParams(ClassificationUpdateProcessorFactoryTest.java:86)\n\n ",
            "author": "Shalin Shekhar Mangar",
            "id": "comment-16046570"
        },
        {
            "date": "2017-06-12T14:10:57+0000",
            "content": "Shalin,\n\nSorry I uploaded old test-error-log and patch, uploaded new ones, object leaks etc. I will take some more time to understand what different I am doing from rest of the test cases in the project. Thank you for your help.\n\n\n   [junit4]   2> 28893 ERROR (coreCloseExecutor-12-thread-1) [    x:collection1] o.a.s.c.CachingDirectoryFactory Timeout waiting for all directory ref counts to be released - gave up waiting on CachedDir<<refCount=1;path=/Users/amritsarkar/git_space/solr-june/lucene-solr/solr/build/solr-core/test/J0/temp/solr.update.processor.ClassificationUpdateProcessorFactoryTest_27D2820C6C631FAD-001/init-core-data-001/index;done=false>>\n   [junit4]   2> 28894 ERROR (coreCloseExecutor-12-thread-1) [    x:collection1] o.a.s.c.CachingDirectoryFactory Error closing directory:org.apache.solr.common.SolrException: Timeout waiting for all directory ref counts to be released - gave up waiting on CachedDir<<refCount=1;path=/Users/amritsarkar/git_space/solr-june/lucene-solr/solr/build/solr-core/test/J0/temp/solr.update.processor.ClassificationUpdateProcessorFactoryTest_27D2820C6C631FAD-001/init-core-data-001/index;done=false>>\n   [junit4]   2> \tat org.apache.solr.core.CachingDirectoryFactory.close(CachingDirectoryFactory.java:177)\n   [junit4]   2> \tat org.apache.solr.core.SolrCore.close(SolrCore.java:1617)\n   [junit4]   2> \tat org.apache.solr.core.SolrCores.lambda$close$0(SolrCores.java:132)\n   [junit4]   2> \tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\n   [junit4]   2> \tat org.apache.solr.common.util.ExecutorUtil$MDCAwareThreadPoolExecutor.lambda$execute$0(ExecutorUtil.java:188)\n   [junit4]   2> \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n   [junit4]   2> \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n   [junit4]   2> \tat java.lang.Thread.run(Thread.java:745)\n   [junit4]   2> \n   [junit4]   2> 28895 ERROR (coreCloseExecutor-12-thread-1) [    x:collection1] o.a.s.c.SolrCore java.lang.AssertionError: 1\n   [junit4]   2> \tat org.apache.solr.core.CachingDirectoryFactory.close(CachingDirectoryFactory.java:191)\n   [junit4]   2> \tat org.apache.solr.core.SolrCore.close(SolrCore.java:1617)\n   [junit4]   2> \tat org.apache.solr.core.SolrCores.lambda$close$0(SolrCores.java:132)\n   [junit4]   2> \tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\n   [junit4]   2> \tat org.apache.solr.common.util.ExecutorUtil$MDCAwareThreadPoolExecutor.lambda$execute$0(ExecutorUtil.java:188)\n   [junit4]   2> \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n   [junit4]   2> \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n   [junit4]   2> \tat java.lang.Thread.run(Thread.java:745)\n   [junit4]   2> \n   [junit4]   2> 28896 ERROR (coreCloseExecutor-12-thread-1) [    x:collection1] o.a.s.c.SolrCores Error shutting down core:java.lang.AssertionError: 1\n   [junit4]   2> \tat org.apache.solr.core.CachingDirectoryFactory.close(CachingDirectoryFactory.java:191)\n   [junit4]   2> \tat org.apache.solr.core.SolrCore.close(SolrCore.java:1617)\n   [junit4]   2> \tat org.apache.solr.core.SolrCores.lambda$close$0(SolrCores.java:132)\n   [junit4]   2> \tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\n   [junit4]   2> \tat org.apache.solr.common.util.ExecutorUtil$MDCAwareThreadPoolExecutor.lambda$execute$0(ExecutorUtil.java:188)\n   [junit4]   2> \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n   [junit4]   2> \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n   [junit4]   2> \tat java.lang.Thread.run(Thread.java:745)\n   [junit4]   2> \n   [junit4]   2> 28898 INFO  (SUITE-ClassificationUpdateProcessorFactoryTest-seed#[27D2820C6C631FAD]-worker) [    ] o.a.s.SolrTestCaseJ4 Waiting for all tracked resources to be released\n   [junit4]   2> 38936 INFO  (SUITE-ClassificationUpdateProcessorFactoryTest-seed#[27D2820C6C631FAD]-worker) [    ] o.a.s.SolrTestCaseJ4 Waiting for all tracked resources to be released\n   [junit4]   2> 48965 INFO  (SUITE-ClassificationUpdateProcessorFactoryTest-seed#[27D2820C6C631FAD]-worker) [    ] o.a.s.SolrTestCaseJ4 Waiting for all tracked resources to be released\n   [junit4]   2> JUnit4-serializer-daemon:\n   [junit4]   2>     java.lang.Thread.sleep(Native Method)\n   [junit4]   2>     com.carrotsearch.ant.tasks.junit4.events.Serializer$1.run(Serializer.java:50)\n   [junit4]   2> \n   [junit4]   2> Signal Dispatcher:\n   [junit4]   2> \n   [junit4]   2> Finalizer:\n   [junit4]   2>     java.lang.Object.wait(Native Method)\n   [junit4]   2>     java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:143)\n   [junit4]   2>     java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:164)\n   [junit4]   2>     java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:209)\n   [junit4]   2> \n   [junit4]   2> SUITE-ClassificationUpdateProcessorFactoryTest-seed#[27D2820C6C631FAD]:\n   [junit4]   2>     java.lang.Object.wait(Native Method)\n   [junit4]   2>     java.lang.Thread.join(Thread.java:1257)\n   [junit4]   2>     [...com.carrotsearch.randomizedtesting.*]\n   [junit4]   2> \n   [junit4]   2> main:\n   [junit4]   2>     java.lang.Object.wait(Native Method)\n   [junit4]   2>     java.lang.Thread.join(Thread.java:1249)\n   [junit4]   2>     java.lang.Thread.join(Thread.java:1323)\n   [junit4]   2>     [...com.carrotsearch.randomizedtesting.*]\n   [junit4]   2>     com.carrotsearch.ant.tasks.junit4.slave.SlaveMain.execute(SlaveMain.java:244)\n   [junit4]   2>     com.carrotsearch.ant.tasks.junit4.slave.SlaveMain.main(SlaveMain.java:355)\n   [junit4]   2>     com.carrotsearch.ant.tasks.junit4.slave.SlaveMainSafe.main(SlaveMainSafe.java:13)\n   [junit4]   2> \n   [junit4]   2> Reference Handler:\n   [junit4]   2>     java.lang.Object.wait(Native Method)\n   [junit4]   2>     java.lang.Object.wait(Object.java:502)\n   [junit4]   2>     java.lang.ref.Reference.tryHandlePending(Reference.java:191)\n   [junit4]   2>     java.lang.ref.Reference$ReferenceHandler.run(Reference.java:153)\n   [junit4]   2> \n   [junit4]   2> SUITE-ClassificationUpdateProcessorFactoryTest-seed#[27D2820C6C631FAD]-worker:\n   [junit4]   2>     java.lang.Thread.dumpThreads(Native Method)\n   [junit4]   2>     java.lang.Thread.getAllStackTraces(Thread.java:1607)\n   [junit4]   2>     org.apache.solr.SolrTestCaseJ4.clearObjectTrackerAndCheckEmpty(SolrTestCaseJ4.java:350)\n   [junit4]   2>     org.apache.solr.SolrTestCaseJ4.teardownTestCases(SolrTestCaseJ4.java:294)\n   [junit4]   2>     [...sun.*, java.lang.reflect.*, com.carrotsearch.randomizedtesting.*]\n   [junit4]   2>     org.apache.lucene.util.AbstractBeforeAfterRule$1.evaluate(AbstractBeforeAfterRule.java:45)\n   [junit4]   2>     [...com.carrotsearch.randomizedtesting.*]\n   [junit4]   2>     org.apache.lucene.util.TestRuleStoreClassName$1.evaluate(TestRuleStoreClassName.java:41)\n   [junit4]   2>     [...com.carrotsearch.randomizedtesting.*]\n   [junit4]   2>     org.apache.lucene.util.TestRuleAssertionsRequired$1.evaluate(TestRuleAssertionsRequired.java:53)\n   [junit4]   2>     org.apache.lucene.util.TestRuleMarkFailure$1.evaluate(TestRuleMarkFailure.java:47)\n   [junit4]   2>     org.apache.lucene.util.TestRuleIgnoreAfterMaxFailures$1.evaluate(TestRuleIgnoreAfterMaxFailures.java:64)\n   [junit4]   2>     org.apache.lucene.util.TestRuleIgnoreTestSuites$1.evaluate(TestRuleIgnoreTestSuites.java:54)\n   [junit4]   2>     [...com.carrotsearch.randomizedtesting.*]\n   [junit4]   2>     java.lang.Thread.run(Thread.java:745)\n   [junit4]   2> \n   [junit4]   2> 49973 INFO  (SUITE-ClassificationUpdateProcessorFactoryTest-seed#[27D2820C6C631FAD]-worker) [    ] o.a.s.SolrTestCaseJ4 ------------------------------------------------------- Done waiting for tracked resources to be released\n   [junit4]   2> NOTE: test params are: codec=Asserting(Lucene70): {}, docValues:{}, maxPointsInLeafNode=730, maxMBSortInHeap=7.789755564495978, sim=RandomSimilarity(queryNorm=true): {}, locale=es-CL, timezone=Pacific/Samoa\n   [junit4]   2> NOTE: Mac OS X 10.12.5 x86_64/Oracle Corporation 1.8.0_102 (64-bit)/cpus=4,threads=1,free=184904088,total=217579520\n   [junit4]   2> NOTE: All tests run in this JVM: [ClassificationUpdateProcessorFactoryTest]\n   [junit4]   2> NOTE: reproduce with: ant test  -Dtestcase=ClassificationUpdateProcessorFactoryTest -Dtests.seed=27D2820C6C631FAD -Dtests.slow=true -Dtests.locale=es-CL -Dtests.timezone=Pacific/Samoa -Dtests.asserts=true -Dtests.file.encoding=ISO-8859-1\n   [junit4] ERROR   0.00s | ClassificationUpdateProcessorFactoryTest (suite) <<<\n   [junit4]    > Throwable #1: java.lang.AssertionError: ObjectTracker found 5 object(s) that were not released!!! [MockDirectoryWrapper, SolrIndexSearcher, MockDirectoryWrapper, SolrCore, MockDirectoryWrapper]\n   [junit4]    > org.apache.solr.common.util.ObjectReleaseTracker$ObjectTrackerException: org.apache.lucene.store.MockDirectoryWrapper\n   [junit4]    > \tat org.apache.solr.common.util.ObjectReleaseTracker.track(ObjectReleaseTracker.java:42)\n   [junit4]    > \tat org.apache.solr.core.CachingDirectoryFactory.get(CachingDirectoryFactory.java:347)\n   [junit4]    > \tat org.apache.solr.core.SolrCore.getNewIndexDir(SolrCore.java:361)\n   [junit4]    > \tat org.apache.solr.core.SolrCore.initIndex(SolrCore.java:721)\n   [junit4]    > \tat org.apache.solr.core.SolrCore.<init>(SolrCore.java:948)\n   [junit4]    > \tat org.apache.solr.core.SolrCore.<init>(SolrCore.java:855)\n   [junit4]    > \tat org.apache.solr.core.CoreContainer.create(CoreContainer.java:979)\n   [junit4]    > \tat org.apache.solr.core.CoreContainer.lambda$load$7(CoreContainer.java:611)\n   [junit4]    > \tat com.codahale.metrics.InstrumentedExecutorService$InstrumentedCallable.call(InstrumentedExecutorService.java:197)\n   [junit4]    > \tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\n   [junit4]    > \tat org.apache.solr.common.util.ExecutorUtil$MDCAwareThreadPoolExecutor.lambda$execute$0(ExecutorUtil.java:188)\n   [junit4]    > \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n   [junit4]    > \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n   [junit4]    > \tat java.lang.Thread.run(Thread.java:745)\n   [junit4]    > org.apache.solr.common.util.ObjectReleaseTracker$ObjectTrackerException: org.apache.solr.search.SolrIndexSearcher\n   [junit4]    > \tat org.apache.solr.common.util.ObjectReleaseTracker.track(ObjectReleaseTracker.java:42)\n   [junit4]    > \tat org.apache.solr.search.SolrIndexSearcher.<init>(SolrIndexSearcher.java:323)\n   [junit4]    > \tat org.apache.solr.core.SolrCore.openNewSearcher(SolrCore.java:2047)\n   [junit4]    > \tat org.apache.solr.core.SolrCore.getSearcher(SolrCore.java:2199)\n   [junit4]    > \tat org.apache.solr.core.SolrCore.initSearcher(SolrCore.java:1085)\n   [junit4]    > \tat org.apache.solr.core.SolrCore.<init>(SolrCore.java:974)\n   [junit4]    > \tat org.apache.solr.core.SolrCore.<init>(SolrCore.java:855)\n   [junit4]    > \tat org.apache.solr.core.CoreContainer.create(CoreContainer.java:979)\n   [junit4]    > \tat org.apache.solr.core.CoreContainer.lambda$load$7(CoreContainer.java:611)\n   [junit4]    > \tat com.codahale.metrics.InstrumentedExecutorService$InstrumentedCallable.call(InstrumentedExecutorService.java:197)\n   [junit4]    > \tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\n   [junit4]    > \tat org.apache.solr.common.util.ExecutorUtil$MDCAwareThreadPoolExecutor.lambda$execute$0(ExecutorUtil.java:188)\n   [junit4]    > \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n   [junit4]    > \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n   [junit4]    > \tat java.lang.Thread.run(Thread.java:745)\n   [junit4]    > org.apache.solr.common.util.ObjectReleaseTracker$ObjectTrackerException: org.apache.lucene.store.MockDirectoryWrapper\n   [junit4]    > \tat org.apache.solr.common.util.ObjectReleaseTracker.track(ObjectReleaseTracker.java:42)\n   [junit4]    > \tat org.apache.solr.core.CachingDirectoryFactory.get(CachingDirectoryFactory.java:347)\n   [junit4]    > \tat org.apache.solr.update.SolrIndexWriter.create(SolrIndexWriter.java:92)\n   [junit4]    > \tat org.apache.solr.core.SolrCore.initIndex(SolrCore.java:753)\n   [junit4]    > \tat org.apache.solr.core.SolrCore.<init>(SolrCore.java:948)\n   [junit4]    > \tat org.apache.solr.core.SolrCore.<init>(SolrCore.java:855)\n   [junit4]    > \tat org.apache.solr.core.CoreContainer.create(CoreContainer.java:979)\n   [junit4]    > \tat org.apache.solr.core.CoreContainer.lambda$load$7(CoreContainer.java:611)\n   [junit4]    > \tat com.codahale.metrics.InstrumentedExecutorService$InstrumentedCallable.call(InstrumentedExecutorService.java:197)\n   [junit4]    > \tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\n   [junit4]    > \tat org.apache.solr.common.util.ExecutorUtil$MDCAwareThreadPoolExecutor.lambda$execute$0(ExecutorUtil.java:188)\n   [junit4]    > \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n   [junit4]    > \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n   [junit4]    > \tat java.lang.Thread.run(Thread.java:745)\n   [junit4]    > org.apache.solr.common.util.ObjectReleaseTracker$ObjectTrackerException: org.apache.solr.core.SolrCore\n   [junit4]    > \tat org.apache.solr.common.util.ObjectReleaseTracker.track(ObjectReleaseTracker.java:42)\n   [junit4]    > \tat org.apache.solr.core.SolrCore.<init>(SolrCore.java:1033)\n   [junit4]    > \tat org.apache.solr.core.SolrCore.<init>(SolrCore.java:855)\n   [junit4]    > \tat org.apache.solr.core.CoreContainer.create(CoreContainer.java:979)\n   [junit4]    > \tat org.apache.solr.core.CoreContainer.lambda$load$7(CoreContainer.java:611)\n   [junit4]    > \tat com.codahale.metrics.InstrumentedExecutorService$InstrumentedCallable.call(InstrumentedExecutorService.java:197)\n   [junit4]    > \tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\n   [junit4]    > \tat org.apache.solr.common.util.ExecutorUtil$MDCAwareThreadPoolExecutor.lambda$execute$0(ExecutorUtil.java:188)\n   [junit4]    > \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n   [junit4]    > \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n   [junit4]    > \tat java.lang.Thread.run(Thread.java:745)\n   [junit4]    > org.apache.solr.common.util.ObjectReleaseTracker$ObjectTrackerException: org.apache.lucene.store.MockDirectoryWrapper\n   [junit4]    > \tat org.apache.solr.common.util.ObjectReleaseTracker.track(ObjectReleaseTracker.java:42)\n   [junit4]    > \tat org.apache.solr.core.CachingDirectoryFactory.get(CachingDirectoryFactory.java:347)\n   [junit4]    > \tat org.apache.solr.core.SolrCore.initSnapshotMetaDataManager(SolrCore.java:490)\n   [junit4]    > \tat org.apache.solr.core.SolrCore.<init>(SolrCore.java:942)\n   [junit4]    > \tat org.apache.solr.core.SolrCore.<init>(SolrCore.java:855)\n   [junit4]    > \tat org.apache.solr.core.CoreContainer.create(CoreContainer.java:979)\n   [junit4]    > \tat org.apache.solr.core.CoreContainer.lambda$load$7(CoreContainer.java:611)\n   [junit4]    > \tat com.codahale.metrics.InstrumentedExecutorService$InstrumentedCallable.call(InstrumentedExecutorService.java:197)\n   [junit4]    > \tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\n   [junit4]    > \tat org.apache.solr.common.util.ExecutorUtil$MDCAwareThreadPoolExecutor.lambda$execute$0(ExecutorUtil.java:188)\n   [junit4]    > \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n   [junit4]    > \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n   [junit4]    > \tat java.lang.Thread.run(Thread.java:745)\n   [junit4]    > \tat __randomizedtesting.SeedInfo.seed([27D2820C6C631FAD]:0)\n   [junit4]    > \tat org.apache.solr.SolrTestCaseJ4.teardownTestCases(SolrTestCaseJ4.java:295)\n   [junit4]    > \tat java.lang.Thread.run(Thread.java:745)\n   [junit4] Completed [1/1 (1!)] in 51.53s, 3 tests, 1 failure <<< FAILURES!\n   [junit4] \n   [junit4] \n   [junit4] Tests with failures [seed: 27D2820C6C631FAD]:\n   [junit4]   - org.apache.solr.update.processor.ClassificationUpdateProcessorFactoryTest (suite)\n   [junit4] \n   [junit4] \n   [junit4] JVM J0:    15.77 ..    63.40 =    47.63s\n   [junit4] Execution time total: 1 minute 3 seconds\n   [junit4] Tests summary: 1 suite, 3 tests, 1 suite-level error\n\n ",
            "author": "Amrit Sarkar",
            "id": "comment-16046599"
        }
    ]
}