{
    "id": "LUCENE-8345",
    "title": "Add wrapper class constructors to forbiddenapis",
    "details": {
        "components": [],
        "status": "Closed",
        "resolution": "Fixed",
        "fix_versions": [
            "7.5",
            "master (8.0)"
        ],
        "affect_versions": "None",
        "labels": "",
        "priority": "Minor",
        "type": "Improvement"
    },
    "description": "Wrapper classes for the Java primitives (Boolean, Byte, Short, Character, Integer, Long, Float, Double) have constructors which will always create new objects. These constructors are officially deprecated as of Java 9 and it is recommended to use the public static methods since these can reuse the same underlying objects. In 99% of cases we should be doing this, so these constructors should be added to forbiddenapis and code corrected to use autoboxing or call the static methods (.valueOf, .parse*) explicitly.",
    "attachments": {},
    "issue_links": {},
    "comments": [
        {
            "id": "comment-16499526",
            "author": "Uwe Schindler",
            "content": "+1 ",
            "date": "2018-06-03T19:22:09+0000"
        },
        {
            "id": "comment-16501859",
            "author": "Michael Braun",
            "content": "Uwe Schindler does this patch look sufficient?  ",
            "date": "2018-06-05T14:25:41+0000"
        },
        {
            "id": "comment-16501933",
            "author": "Uwe Schindler",
            "content": "Hi,\nlooks fine!\n\nI compared it with the autogenerated Java 9 deprecations already shipped with forbiddenapis:\n\n\thttps://github.com/policeman-tools/forbidden-apis/blob/master/src/main/resources/de/thetaphi/forbiddenapis/signatures/jdk-deprecated-9.txt#L185-L193\n\thttps://github.com/policeman-tools/forbidden-apis/blob/master/src/main/resources/de/thetaphi/forbiddenapis/signatures/jdk-deprecated-9.txt#L185-L193\n\thttps://github.com/policeman-tools/forbidden-apis/blob/master/src/main/resources/de/thetaphi/forbiddenapis/signatures/jdk-deprecated-9.txt#L214-L215\n\n\n\nYou also added the Character ctor, cool!\n\nI will take this issue, but I am on travel at the moment, so I will commit that tomorrow! ",
            "date": "2018-06-05T15:12:50+0000"
        },
        {
            "id": "comment-16501939",
            "author": "Uwe Schindler",
            "content": "Maybe we should also add new String(String), has same issue. There is only a legal use case for doing this if you need something that is not identical to an already interened string. But String interning is no longer a use-case in Lucene (since Lucene 4). ",
            "date": "2018-06-05T15:17:17+0000"
        },
        {
            "id": "comment-16502007",
            "author": "Michael Braun",
            "content": "Thanks for the feedback - will have an update in the next day! ",
            "date": "2018-06-05T15:58:42+0000"
        },
        {
            "id": "comment-16502610",
            "author": "Michael Braun",
            "content": "Uwe Schindler corrected the random T in the text. Should the String add be included as part of this ticket?  ",
            "date": "2018-06-05T22:47:26+0000"
        },
        {
            "id": "comment-16543373",
            "author": "Michael Braun",
            "content": "Uwe Schindler do you want me to update the patch for the latest trunk? Also should the String constructor be added? ",
            "date": "2018-07-13T15:56:48+0000"
        },
        {
            "id": "comment-16543758",
            "author": "Uwe Schindler",
            "content": "Oh sorry, I will commit this later. I was a bit busy!\n\nI'd like to add the new String(String) constructor, too. But we can also do this in a separate issue. ",
            "date": "2018-07-13T21:39:09+0000"
        },
        {
            "id": "comment-16544298",
            "author": "Michael Braun",
            "content": "Uwe Schindler updated the PR, there was an additional change needed for trunk to pass the new forbidden apis check. ",
            "date": "2018-07-14T18:17:40+0000"
        },
        {
            "id": "comment-16544357",
            "author": "Uwe Schindler",
            "content": "OK, thanks! ",
            "date": "2018-07-14T22:16:11+0000"
        },
        {
            "id": "comment-16545038",
            "author": "ASF subversion and git services",
            "content": "Commit fb6574100e493ed9162265133f2cbe967746c166 in lucene-solr's branch refs/heads/master from Michael Braun\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=fb65741 ]\n\nLUCENE-8345 - add wrapper class constructors to forbiddenapis ",
            "date": "2018-07-16T10:25:21+0000"
        },
        {
            "id": "comment-16545039",
            "author": "ASF subversion and git services",
            "content": "Commit c97f27b06c1d7c250e9596a9bc7bf5ca11ef6ad3 in lucene-solr's branch refs/heads/master from Uwe Schindler\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=c97f27b ]\n\nMerge branch 'remove-constructor-wrapper-classes' of https://github.com/michaelbraun/lucene-solr:\nLUCENE-8345, GitHub PR #392: Remove instantiation of redundant wrapper classes for primitives; add wrapper class constructors to forbiddenapis.\nThis closes #392 ",
            "date": "2018-07-16T10:25:23+0000"
        },
        {
            "id": "comment-16545041",
            "author": "Uwe Schindler",
            "content": "Hi, I merged your branch into master and closed the PR. I will let jenkins run for a few hours and then try to cherry-pick to branch_7x. If there are major problems (quite many files touches), I will contact you, Michael Braun. No need to take action now. ",
            "date": "2018-07-16T10:28:16+0000"
        },
        {
            "id": "comment-16545043",
            "author": "Uwe Schindler",
            "content": "The cherry-pick worked without any conflicts. I am now running forbiddenapis to find any additional violations in branch_7x. If there are none, I will push the changes ASAP. ",
            "date": "2018-07-16T10:34:39+0000"
        },
        {
            "id": "comment-16545049",
            "author": "ASF subversion and git services",
            "content": "Commit 8f209f66ff7494567c355900657aa883d653b9a8 in lucene-solr's branch refs/heads/branch_7x from Uwe Schindler\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=8f209f6 ]\n\nMerge branch 'remove-constructor-wrapper-classes' of https://github.com/michaelbraun/lucene-solr:\nLUCENE-8345, GitHub PR #392: Remove instantiation of redundant wrapper classes for primitives; add wrapper class constructors to forbiddenapis.\nThis closes #392 ",
            "date": "2018-07-16T10:42:05+0000"
        },
        {
            "id": "comment-16545050",
            "author": "Uwe Schindler",
            "content": "Hi, forbiddenapis was happy after the cherry-pick. I pushed the changes to 7.x, too. Thanks Michael Braun! ",
            "date": "2018-07-16T10:42:45+0000"
        }
    ]
}