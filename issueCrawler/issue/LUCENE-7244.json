{
    "id": "LUCENE-7244",
    "title": "Geo3d test failure",
    "details": {
        "resolution": "Fixed",
        "affect_versions": "6.0",
        "components": [
            "modules/spatial3d"
        ],
        "labels": "",
        "fix_versions": [
            "6.0"
        ],
        "priority": "Major",
        "status": "Resolved",
        "type": "Bug"
    },
    "description": "Reproduce with:\n\n\nant test  -Dtestcase=TestGeo3DPoint -Dtests.method=testRandomMedium -Dtests.seed=D108F235D165413A -Dtests.multiplier=3 -Dtests.slow=true -Dtests.locale=mk -Dtests.timezone=Europe/Luxembourg -Dtests.asserts=true -Dtests.file.encoding=ISO-8859-1",
    "attachments": {},
    "issue_links": {},
    "comments": [
        {
            "id": "comment-15253904",
            "author": "Karl Wright",
            "date": "2016-04-22T13:20:38+0000",
            "content": "Here's the failure data:\n\n\n   [junit4]    > Throwable #1: java.lang.AssertionError: FAIL: id=167 should have matched but did not\n   [junit4]    >   shape=GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=-0.968382981877905, lon=1.88264298370407([X=-0.17365007600075355, Y=0.5386755833709856, Z=-0.823011689190079])], [lat=-0.14640008142656333, lon=1.0628636937356133([X=0.4816728425146455, Y=0.8653101350248709, Z=-0.14603042094419239])], [lat=-0.016598996946752678, lon=-0.6304914777862578([X=0.8085294506690742, Y=-0.5901195714480694, Z=-0.016616790287426967])], [lat=-0.1736350583257355, lon=-2.1167523926018017([X=-0.5119485330215084, Y=-0.8426374806277258, Z=-0.17293978601294654])]], internalEdges={3}, holes=[GeoCompositeMembershipShape: {[GeoConcavePolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.7288769634071754, lon=-0.009506822127999772([X=0.7456099655228705, Y=-0.007088594875324767, Z=0.6657830681386451])], [lat=0.44451450938344544, lon=1.7474314154135409([X=-0.15872028708396585, Y=0.889212647786288, Z=0.43023274516015814])], [lat=0.5314707291427957, lon=0.6229021653839082([X=0.7003350794017289, Y=0.5030502785417557, Z=0.5069302215905835])]], internalEdges={}, holes=[]}]}]}, GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=-0.07304226537371082, lon=1.8123181679962383([X=-0.2388054305222759, Y=0.9694521808380255, Z=-0.07305767373180282])], [lat=-0.968382981877905, lon=1.88264298370407([X=-0.17365007600075355, Y=0.5386755833709856, Z=-0.823011689190079])], [lat=-0.1736350583257355, lon=-2.1167523926018017([X=-0.5119485330215084, Y=-0.8426374806277258, Z=-0.17293978601294654])]], internalEdges={1, 2}, holes=[GeoCompositeMembershipShape: {[GeoConcavePolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.7288769634071754, lon=-0.009506822127999772([X=0.7456099655228705, Y=-0.007088594875324767, Z=0.6657830681386451])], [lat=0.44451450938344544, lon=1.7474314154135409([X=-0.15872028708396585, Y=0.889212647786288, Z=0.43023274516015814])], [lat=0.5314707291427957, lon=0.6229021653839082([X=0.7003350794017289, Y=0.5030502785417557, Z=0.5069302215905835])]], internalEdges={}, holes=[]}]}]}, GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=-0.1736350583257355, lon=-2.1167523926018017([X=-0.5119485330215084, Y=-0.8426374806277258, Z=-0.17293978601294654])], [lat=-0.1115018153856919, lon=1.683391788285405([X=-0.11178024168174269, Y=0.9885608793328522, Z=-0.1113907636423256])], [lat=-0.1160003553604832, lon=0.6234813397089172([X=0.8072605034241411, Y=0.580563819306051, Z=-0.11586464511520306])]], internalEdges={2}, holes=[GeoCompositeMembershipShape: {[GeoConcavePolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.7288769634071754, lon=-0.009506822127999772([X=0.7456099655228705, Y=-0.007088594875324767, Z=0.6657830681386451])], [lat=0.44451450938344544, lon=1.7474314154135409([X=-0.15872028708396585, Y=0.889212647786288, Z=0.43023274516015814])], [lat=0.5314707291427957, lon=0.6229021653839082([X=0.7003350794017289, Y=0.5030502785417557, Z=0.5069302215905835])]], internalEdges={}, holes=[]}]}]}, GeoConcavePolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=-0.1736350583257355, lon=-2.1167523926018017([X=-0.5119485330215084, Y=-0.8426374806277258, Z=-0.17293978601294654])], [lat=-0.1160003553604832, lon=0.6234813397089172([X=0.8072605034241411, Y=0.580563819306051, Z=-0.11586464511520306])], [lat=-0.07304226537371082, lon=1.8123181679962383([X=-0.2388054305222759, Y=0.9694521808380255, Z=-0.07305767373180282])]], internalEdges={0, 2}, holes=[GeoCompositeMembershipShape: {[GeoConcavePolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.7288769634071754, lon=-0.009506822127999772([X=0.7456099655228705, Y=-0.007088594875324767, Z=0.6657830681386451])], [lat=0.44451450938344544, lon=1.7474314154135409([X=-0.15872028708396585, Y=0.889212647786288, Z=0.43023274516015814])], [lat=0.5314707291427957, lon=0.6229021653839082([X=0.7003350794017289, Y=0.5030502785417557, Z=0.5069302215905835])]], internalEdges={}, holes=[]}]}]}]}\n   [junit4]    >   bounds=XYZBounds: [xmin=-1.0011188544924792 xmax=1.0011188544924792 ymin=-1.0011188544924792 ymax=1.0011188544924792 zmin=-0.9977622925221051 zmax=0.9977622925221051]\n   [junit4]    >   world bounds=( minX=-1.0011188539924791 maxX=1.0011188539924791 minY=-1.0011188539924791 maxY=1.0011188539924791 minZ=-0.9977622920221051 maxZ=0.9977622920221051\n   [junit4]    >   quantized point=[X=0.7250556073144849, Y=0.3035362797350071, Z=0.617920496288387] within shape? true within bounds? true\n   [junit4]    >   unquantized point=[lat=0.6662265028420148, lon=0.3964701880885101([X=0.7250556072961346, Y=0.30353627990583987, Z=0.6179204961808562])] within shape? true within bounds? true\n   [junit4]    >   docID=154 deleted?=false\n   [junit4]    >   query=PointInGeo3DShapeQuery: field=point: Shape: GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=-0.968382981877905, lon=1.88264298370407([X=-0.17365007600075355, Y=0.5386755833709856, Z=-0.823011689190079])], [lat=-0.14640008142656333, lon=1.0628636937356133([X=0.4816728425146455, Y=0.8653101350248709, Z=-0.14603042094419239])], [lat=-0.016598996946752678, lon=-0.6304914777862578([X=0.8085294506690742, Y=-0.5901195714480694, Z=-0.016616790287426967])], [lat=-0.1736350583257355, lon=-2.1167523926018017([X=-0.5119485330215084, Y=-0.8426374806277258, Z=-0.17293978601294654])]], internalEdges={3}, holes=[GeoCompositeMembershipShape: {[GeoConcavePolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.7288769634071754, lon=-0.009506822127999772([X=0.7456099655228705, Y=-0.007088594875324767, Z=0.6657830681386451])], [lat=0.44451450938344544, lon=1.7474314154135409([X=-0.15872028708396585, Y=0.889212647786288, Z=0.43023274516015814])], [lat=0.5314707291427957, lon=0.6229021653839082([X=0.7003350794017289, Y=0.5030502785417557, Z=0.5069302215905835])]], internalEdges={}, holes=[]}]}]}, GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=-0.07304226537371082, lon=1.8123181679962383([X=-0.2388054305222759, Y=0.9694521808380255, Z=-0.07305767373180282])], [lat=-0.968382981877905, lon=1.88264298370407([X=-0.17365007600075355, Y=0.5386755833709856, Z=-0.823011689190079])], [lat=-0.1736350583257355, lon=-2.1167523926018017([X=-0.5119485330215084, Y=-0.8426374806277258, Z=-0.17293978601294654])]], internalEdges={1, 2}, holes=[GeoCompositeMembershipShape: {[GeoConcavePolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.7288769634071754, lon=-0.009506822127999772([X=0.7456099655228705, Y=-0.007088594875324767, Z=0.6657830681386451])], [lat=0.44451450938344544, lon=1.7474314154135409([X=-0.15872028708396585, Y=0.889212647786288, Z=0.43023274516015814])], [lat=0.5314707291427957, lon=0.6229021653839082([X=0.7003350794017289, Y=0.5030502785417557, Z=0.5069302215905835])]], internalEdges={}, holes=[]}]}]}, GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=-0.1736350583257355, lon=-2.1167523926018017([X=-0.5119485330215084, Y=-0.8426374806277258, Z=-0.17293978601294654])], [lat=-0.1115018153856919, lon=1.683391788285405([X=-0.11178024168174269, Y=0.9885608793328522, Z=-0.1113907636423256])], [lat=-0.1160003553604832, lon=0.6234813397089172([X=0.8072605034241411, Y=0.580563819306051, Z=-0.11586464511520306])]], internalEdges={2}, holes=[GeoCompositeMembershipShape: {[GeoConcavePolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.7288769634071754, lon=-0.009506822127999772([X=0.7456099655228705, Y=-0.007088594875324767, Z=0.6657830681386451])], [lat=0.44451450938344544, lon=1.7474314154135409([X=-0.15872028708396585, Y=0.889212647786288, Z=0.43023274516015814])], [lat=0.5314707291427957, lon=0.6229021653839082([X=0.7003350794017289, Y=0.5030502785417557, Z=0.5069302215905835])]], internalEdges={}, holes=[]}]}]}, GeoConcavePolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=-0.1736350583257355, lon=-2.1167523926018017([X=-0.5119485330215084, Y=-0.8426374806277258, Z=-0.17293978601294654])], [lat=-0.1160003553604832, lon=0.6234813397089172([X=0.8072605034241411, Y=0.580563819306051, Z=-0.11586464511520306])], [lat=-0.07304226537371082, lon=1.8123181679962383([X=-0.2388054305222759, Y=0.9694521808380255, Z=-0.07305767373180282])]], internalEdges={0, 2}, holes=[GeoCompositeMembershipShape: {[GeoConcavePolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.7288769634071754, lon=-0.009506822127999772([X=0.7456099655228705, Y=-0.007088594875324767, Z=0.6657830681386451])], [lat=0.44451450938344544, lon=1.7474314154135409([X=-0.15872028708396585, Y=0.889212647786288, Z=0.43023274516015814])], [lat=0.5314707291427957, lon=0.6229021653839082([X=0.7003350794017289, Y=0.5030502785417557, Z=0.5069302215905835])]], internalEdges={}, holes=[]}]}]}]}\n   [junit4]    >   explanation:\n   [junit4]    >     target is in leaf _1(6.1.0):c43864 of full reader StandardDirectoryReader(segments:5:nrt _1(6.1.0):c43864)\n   [junit4]    >     full BKD path to target doc:\n   [junit4]    >       Cell(x=-1.0011188539924791 TO 1.0011188539924791 y=-1.001118708077421 TO 1.001117672220363 z=-0.997762292058209 TO 0.9977622920582089); Shape relationship = WITHIN; Quantized point within cell = true; Unquantized point within cell = true\n   [junit4]    >       Cell(x=-1.0011188539924791 TO 1.0011188539924791 y=-1.001118708077421 TO 1.001117672220363 z=0.0 TO 0.9977622920582089); Shape relationship = DISJOINT; Quantized point within cell = true; Unquantized point within cell = true\n   [junit4]    >       Cell(x=0.0 TO 1.0011188539924791 y=-1.001118708077421 TO 1.001117672220363 z=0.0 TO 0.9977622920582089); Shape relationship = OVERLAPS; Quantized point within cell = true; Unquantized point within cell = true\n   [junit4]    >       Cell(x=0.0 TO 1.0011188539924791 y=0.0 TO 1.001117672220363 z=0.0 TO 0.9977622920582089); Shape relationship = OVERLAPS; Quantized point within cell = true; Unquantized point within cell = true\n   [junit4]    >       Cell(x=0.0 TO 1.0011188539924791 y=0.11516573924894519 TO 1.001117672220363 z=0.0 TO 0.9977622920582089); Shape relationship = OVERLAPS; Quantized point within cell = true; Unquantized point within cell = true\n   [junit4]    >       Cell(x=0.4512171060831897 TO 1.0011188539924791 y=0.11516573924894519 TO 1.001117672220363 z=0.0 TO 0.9977622920582089); Shape relationship = OVERLAPS; Quantized point within cell = true; Unquantized point within cell = true\n   [junit4]    >       Cell(x=0.4512171060831897 TO 1.0011188539924791 y=0.11516573924894519 TO 0.4681468680682605 z=0.0 TO 0.9977622920582089); Shape relationship = OVERLAPS; Quantized point within cell = true; Unquantized point within cell = true\n   [junit4]    >     on cell Cell(x=-1.0011188539924791 TO 1.0011188539924791 y=-1.001118708077421 TO 1.001117672220363 z=-0.997762292058209 TO 0.9977622920582089); Shape relationship = WITHIN; Quantized point within cell = true; Unquantized point within cell = true, wrapped visitor returned CELL_CROSSES_QUERY\n   [junit4]    >     on cell Cell(x=-1.0011188539924791 TO 1.0011188539924791 y=-1.001118708077421 TO 1.001117672220363 z=0.0 TO 0.9977622920582089); Shape relationship = DISJOINT; Quantized point within cell = true; Unquantized point within cell = true, wrapped visitor returned CELL_OUTSIDE_QUERY\n\n "
        },
        {
            "id": "comment-15254618",
            "author": "ASF subversion and git services",
            "date": "2016-04-22T20:36:31+0000",
            "content": "Commit 38c0915572333f1f77efb43028fe91927df8464d in lucene-solr's branch refs/heads/branch_6x from Karl Wright\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=38c0915 ]\n\nLUCENE-7244: Complain if the holes are outside the polygon. "
        },
        {
            "id": "comment-15254627",
            "author": "ASF subversion and git services",
            "date": "2016-04-22T20:38:51+0000",
            "content": "Commit 38ebd906e830e793d7df364163f0baab049ffa47 in lucene-solr's branch refs/heads/master from Karl Wright\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=38ebd90 ]\n\nLUCENE-7244: Complain if the holes are outside the polygon. "
        }
    ]
}