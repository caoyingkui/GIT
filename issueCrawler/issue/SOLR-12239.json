{
    "id": "SOLR-12239",
    "title": "Enabling index sorting causes \"segment not sorted with indexSort=null\"",
    "details": {
        "labels": "",
        "priority": "Major",
        "components": [],
        "type": "Improvement",
        "fix_versions": [],
        "affect_versions": "7.1",
        "resolution": "Unresolved",
        "status": "Open"
    },
    "description": "When index sorting is enabled on an existing collection/index (using SortingMergePolicy), the collection reload causes the following exception:\n\n\njava.util.concurrent.ExecutionException: org.apache.solr.common.SolrException: Unable to create core [mycoll_shard1_replica_n1]\n        at java.util.concurrent.FutureTask.report(FutureTask.java:122)\n        at java.util.concurrent.FutureTask.get(FutureTask.java:192)\n        at org.apache.solr.core.CoreContainer.lambda$load$14(CoreContainer.java:671)\n        at com.codahale.metrics.InstrumentedExecutorService$InstrumentedRunnable.run(InstrumentedExecutorService.java:176)\n        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\n        at java.util.concurrent.FutureTask.run(FutureTask.java:266)\n        at org.apache.solr.common.util.ExecutorUtil$MDCAwareThreadPoolExecutor.lambda$execute$0(ExecutorUtil.java:188)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n        at java.lang.Thread.run(Thread.java:748)\nCaused by: org.apache.solr.common.SolrException: Unable to create core [mycoll_shard1_replica_n1]\n        at org.apache.solr.core.CoreContainer.createFromDescriptor(CoreContainer.java:1045)\n        at org.apache.solr.core.CoreContainer.lambda$load$13(CoreContainer.java:642)\n        at com.codahale.metrics.InstrumentedExecutorService$InstrumentedCallable.call(InstrumentedExecutorService.java:197)\n        ... 5 more\nCaused by: org.apache.solr.common.SolrException: Error opening new searcher\n        at org.apache.solr.core.SolrCore.<init>(SolrCore.java:989)\n        at org.apache.solr.core.SolrCore.<init>(SolrCore.java:844)\n        at org.apache.solr.core.CoreContainer.createFromDescriptor(CoreContainer.java:1029)\n        ... 7 more\nCaused by: org.apache.solr.common.SolrException: Error opening new searcher\n        at org.apache.solr.core.SolrCore.openNewSearcher(SolrCore.java:2076)\n        at org.apache.solr.core.SolrCore.getSearcher(SolrCore.java:2196)\n        at org.apache.solr.core.SolrCore.initSearcher(SolrCore.java:1072)\n        at org.apache.solr.core.SolrCore.<init>(SolrCore.java:961)\n        ... 9 more\nCaused by: org.apache.lucene.index.CorruptIndexException: segment not sorted with indexSort=null (resource=_0(7.1.0):C1)\n        at org.apache.lucene.index.IndexWriter.validateIndexSort(IndexWriter.java:1185)\n        at org.apache.lucene.index.IndexWriter.<init>(IndexWriter.java:1108)\n        at org.apache.solr.update.SolrIndexWriter.<init>(SolrIndexWriter.java:119)\n        at org.apache.solr.update.SolrIndexWriter.create(SolrIndexWriter.java:94)\n        at org.apache.solr.update.DefaultSolrCoreState.createMainIndexWriter(DefaultSolrCoreState.java:257)\n        at org.apache.solr.update.DefaultSolrCoreState.getIndexWriter(DefaultSolrCoreState.java:131)\n        at org.apache.solr.core.SolrCore.openNewSearcher(SolrCore.java:2037)\n        ... 12 more\n\n\n\nThis means that the user actually needs to delete the index segments, reload the collection and then re-index. This is bad user experience.",
    "attachments": {},
    "issue_links": {},
    "comments": []
}