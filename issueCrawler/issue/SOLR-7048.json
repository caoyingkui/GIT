{
    "id": "SOLR-7048",
    "title": "warning:org.apache.hadoop.hdfs.security.token.block.InvalidBlockTokenException,this warn's problem take place when searching and indexing",
    "details": {
        "components": [
            "hdfs",
            "SolrCloud"
        ],
        "type": "Bug",
        "labels": "",
        "fix_versions": [],
        "affect_versions": "4.8.1",
        "status": "Closed",
        "resolution": "Cannot Reproduce",
        "priority": "Major"
    },
    "description": "indexing:\norg.apache.hadoop.hdfs.security.token.block.InvalidBlockTokenException: access control error while attempting to set up short-circuit access to /user/solr/sub_2014_s08/data/index/_1k1.fdtBlock token with block_token_identifier (expiryDate=1422394876052, keyId=-280715669, userId=solr, blockPoolId=BP-2117321730-132.121.94.119-1395990208332, blockId=1117922079, access modes=[READ]) is expired.\n\tat org.apache.hadoop.hdfs.BlockReaderFactory.newShortCircuitBlockReader(BlockReaderFactory.java:217)\n\tat org.apache.hadoop.hdfs.BlockReaderFactory.newBlockReader(BlockReaderFactory.java:99)\n\tat org.apache.hadoop.hdfs.DFSInputStream.getBlockReader(DFSInputStream.java:1064)\n\tat org.apache.hadoop.hdfs.DFSInputStream.fetchBlockByteRange(DFSInputStream.java:898)\n\tat org.apache.hadoop.hdfs.DFSInputStream.read(DFSInputStream.java:1154)\n\tat org.apache.hadoop.fs.FSInputStream.readFully(FSInputStream.java:76)\n\tat org.apache.hadoop.fs.FSDataInputStream.readFully(FSDataInputStream.java:95)\n\tat org.apache.solr.store.hdfs.HdfsDirectory$HdfsIndexInput.readInternal(HdfsDirectory.java:212)\n\tat org.apache.solr.store.blockcache.CustomBufferedIndexInput.refill(CustomBufferedIndexInput.java:191)\n\tat org.apache.solr.store.blockcache.CustomBufferedIndexInput.readBytes(CustomBufferedIndexInput.java:93)\n\tat org.apache.solr.store.blockcache.CustomBufferedIndexInput.readBytes(CustomBufferedIndexInput.java:67)\n\tat org.apache.solr.store.blockcache.BlockDirectory$CachedIndexInput.readIntoCacheAndResult(BlockDirectory.java:210)\n\tat org.apache.solr.store.blockcache.BlockDirectory$CachedIndexInput.fetchBlock(BlockDirectory.java:197)\n\tat org.apache.solr.store.blockcache.BlockDirectory$CachedIndexInput.readInternal(BlockDirectory.java:181)\n\tat org.apache.solr.store.blockcache.CustomBufferedIndexInput.refill(CustomBufferedIndexInput.java:191)\n\tat org.apache.solr.store.blockcache.CustomBufferedIndexInput.readBytes(CustomBufferedIndexInput.java:93)\n\tat org.apache.solr.store.blockcache.CustomBufferedIndexInput.readBytes(CustomBufferedIndexInput.java:67)\n\tat org.apache.lucene.store.BufferedChecksumIndexInput.readBytes(BufferedChecksumIndexInput.java:49)\n\tat org.apache.lucene.codecs.compressing.LZ4.decompress(LZ4.java:101)\n\tat org.apache.lucene.codecs.compressing.CompressionMode$4.decompress(CompressionMode.java:135)\n\tat org.apache.lucene.codecs.compressing.CompressingStoredFieldsReader$ChunkIterator.decompress(CompressingStoredFieldsReader.java:501)\n\tat org.apache.lucene.codecs.compressing.CompressingStoredFieldsWriter.merge(CompressingStoredFieldsWriter.java:387)\n\tat org.apache.lucene.index.SegmentMerger.mergeFields(SegmentMerger.java:322)\n\tat org.apache.lucene.index.SegmentMerger.merge(SegmentMerger.java:100)\n\tat org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4132)\n\tat org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3728)\n\tat org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeScheduler.java:405)\n\tat org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:482)\n\nsearching :\norg.apache.hadoop.hdfs.security.token.block.InvalidBlockTokenException: access control error while attempting to set up short-circuit access to /user/solr/data/index/_s5d_Lucene41_0.timBlock token with block_token_identifier (expiryDate=1422357860644, keyId=-280715670, userId=solr, blockPoolId=BP-2117321730-132.121.94.119-1395990208332, blockId=1086137313, access modes=[READ]) is expired.\n\tat org.apache.hadoop.hdfs.BlockReaderFactory.newShortCircuitBlockReader(BlockReaderFactory.java:217)\n\tat org.apache.hadoop.hdfs.BlockReaderFactory.newBlockReader(BlockReaderFactory.java:99)\n\tat org.apache.hadoop.hdfs.DFSInputStream.getBlockReader(DFSInputStream.java:1064)\n\tat org.apache.hadoop.hdfs.DFSInputStream.fetchBlockByteRange(DFSInputStream.java:898)\n\tat org.apache.hadoop.hdfs.DFSInputStream.read(DFSInputStream.java:1154)\n\tat org.apache.hadoop.fs.FSInputStream.readFully(FSInputStream.java:76)\n\tat org.apache.hadoop.fs.FSDataInputStream.readFully(FSDataInputStream.java:95)\n\tat org.apache.solr.store.hdfs.HdfsDirectory$HdfsIndexInput.readInternal(HdfsDirectory.java:212)\n\tat org.apache.solr.store.blockcache.CustomBufferedIndexInput.refill(CustomBufferedIndexInput.java:191)\n\tat org.apache.solr.store.blockcache.CustomBufferedIndexInput.readBytes(CustomBufferedIndexInput.java:93)\n\tat org.apache.solr.store.blockcache.CustomBufferedIndexInput.readBytes(CustomBufferedIndexInput.java:67)\n\tat org.apache.solr.store.blockcache.BlockDirectory$CachedIndexInput.readIntoCacheAndResult(BlockDirectory.java:210)\n\tat org.apache.solr.store.blockcache.BlockDirectory$CachedIndexInput.fetchBlock(BlockDirectory.java:197)\n\tat org.apache.solr.store.blockcache.BlockDirectory$CachedIndexInput.readInternal(BlockDirectory.java:181)\n\tat org.apache.solr.store.blockcache.CustomBufferedIndexInput.refill(CustomBufferedIndexInput.java:191)\n\tat org.apache.solr.store.blockcache.CustomBufferedIndexInput.readByte(CustomBufferedIndexInput.java:45)\n\tat org.apache.lucene.store.DataInput.readVInt(DataInput.java:120)\n\tat org.apache.solr.store.blockcache.CustomBufferedIndexInput.readVInt(CustomBufferedIndexInput.java:160)\n\tat org.apache.lucene.codecs.BlockTreeTermsReader$FieldReader$SegmentTermsEnum$Frame.loadBlock(BlockTreeTermsReader.java:2405)\n\tat org.apache.lucene.codecs.BlockTreeTermsReader$FieldReader$SegmentTermsEnum.seekExact(BlockTreeTermsReader.java:1734)\n\tat org.apache.lucene.index.TermContext.build(TermContext.java:95)\n\tat org.apache.lucene.search.TermQuery.createWeight(TermQuery.java:165)\n\tat org.apache.lucene.search.IndexSearcher.createNormalizedWeight(IndexSearcher.java:684)\n\tat org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:297)\n\tat org.apache.solr.search.SolrIndexSearcher.getDocSetNC(SolrIndexSearcher.java:1158)\n\tat org.apache.solr.search.SolrIndexSearcher.getPositiveDocSet(SolrIndexSearcher.java:846)\n\tat org.apache.solr.search.SolrIndexSearcher.getProcessedFilter(SolrIndexSearcher.java:1004)\n\tat org.apache.solr.search.SolrIndexSearcher.getDocListNC(SolrIndexSearcher.java:1517)\n\tat org.apache.solr.search.SolrIndexSearcher.getDocListC(SolrIndexSearcher.java:1397)\n\tat org.apache.solr.search.SolrIndexSearcher.search(SolrIndexSearcher.java:478)\n\tat org.apache.solr.handler.component.QueryComponent.process(QueryComponent.java:461)\n\tat org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:218)\n\tat org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:135)\n\tat org.apache.solr.core.SolrCore.execute(SolrCore.java:1952)\n\tat org.apache.solr.servlet.SolrDispatchFilter.execute(SolrDispatchFilter.java:774)\n\tat org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:418)\n\tat org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:207)\n\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1419)\n\tat org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:455)\n\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:137)\n\tat org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:557)\n\tat org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:231)\n\tat org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1075)\n\tat org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:384)\n\tat org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:193)\n\tat org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1009)\n\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:135)\n\tat org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:255)\n\tat org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:154)\n\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:116)\n\tat org.eclipse.jetty.server.Server.handle(Server.java:368)\n\tat org.eclipse.jetty.server.AbstractHttpConnection.handleRequest(AbstractHttpConnection.java:489)\n\tat org.eclipse.jetty.server.BlockingHttpConnection.handleRequest(BlockingHttpConnection.java:53)\n\tat org.eclipse.jetty.server.AbstractHttpConnection.content(AbstractHttpConnection.java:953)\n\tat org.eclipse.jetty.server.AbstractHttpConnection$RequestHandler.content(AbstractHttpConnection.java:1014)\n\tat org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:861)\n\tat org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:240)\n\tat org.eclipse.jetty.server.BlockingHttpConnection.handle(BlockingHttpConnection.java:72)\n\tat org.eclipse.jetty.server.bio.SocketConnector$ConnectorEndPoint.run(SocketConnector.java:264)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:608)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:543)\n\tat java.lang.Thread.run(Thread.java:744)",
    "attachments": {},
    "issue_links": {},
    "comments": [
        {
            "date": "2017-01-27T21:03:18+0000",
            "author": "Cassandra Targett",
            "content": "Closing as Cannot Reproduce since there isn't a lot to go on to try to reproduce; plus, some Googling indicates this is a HDFS problem. ",
            "id": "comment-15843492"
        }
    ]
}