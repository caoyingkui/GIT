{
    "id": "SOLR-5712",
    "title": "Nullpointer while using TermVectorComponent when all the defined 'termVectors' fields of a document are empty.",
    "details": {
        "affect_versions": "4.6",
        "status": "Open",
        "fix_versions": [],
        "components": [
            "SearchComponents - other"
        ],
        "type": "Bug",
        "priority": "Major",
        "labels": "",
        "resolution": "Unresolved"
    },
    "description": "I defined three fields in my schema:\n\n    <field name=\"l3_keywords\" type=\"text\" indexed=\"true\" stored=\"true\" multiValued=\"true\" termVectors=\"true\" termPositions=\"true\"\n termOffsets=\"true\" />\n    <field name=\"verified_keywords\" type=\"text\" indexed=\"true\" stored=\"true\" multiValued=\"true\" termVectors=\"true\" termPositions=\"true\"\n termOffsets=\"true\" />\n    <field name=\"type\" type=\"text\" indexed=\"true\" stored=\"true\" multiValued=\"true\" termVectors=\"true\" termPositions=\"true\"\n termOffsets=\"true\" />\n\nI indexed around 3000 documents. In one of the documents all the three fields above are empty. On index time there is no issue. But when I tried to access my vector component request handler I get an nullpointer exception. I removed the document, where all the three fields are empy, indexed again and the exception is gone.\n\nMy request handler:\n\n    <searchComponent name=\"tvComponent\" class=\"org.apache.solr.handler.component.TermVectorComponent\"/>\n    <requestHandler name=\"/tvrh\" class=\"solr.SearchHandler\">\n        <lst name=\"defaults\">\n            <bool name=\"tv\">true</bool>\n        </lst>\n        <arr name=\"last-components\">\n            <str>tvComponent</str>\n        </arr>\n    </requestHandler>\n\n\nhttp://localhost:8983/solr/tvrh?q=*:*\n\n257414 [qtp1106570297-16] ERROR org.apache.solr.servlet.SolrDispatchFilter  \u2013 null:java.lang.NullPointerException\n        at org.apache.solr.handler.component.TermVectorComponent.process(TermVectorComponent.java:322)\n        at org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:208)\n        at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:135)\n        at org.apache.solr.core.SolrCore.execute(SolrCore.java:1859)\n        at org.apache.solr.servlet.SolrDispatchFilter.execute(SolrDispatchFilter.java:710)\n        at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:413)\n        at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:197)\n        at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1419)\n        at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:455)\n        at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:137)\n        at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:557)\n        at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:231)\n        at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1075)\n        at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:384)\n        at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:193)\n        at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1009)\n        at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:135)\n        at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:255)\n        at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:154)\n        at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:116)\n        at org.eclipse.jetty.server.Server.handle(Server.java:368)\n        at org.eclipse.jetty.server.AbstractHttpConnection.handleRequest(AbstractHttpConnection.java:489)\n        at org.eclipse.jetty.server.BlockingHttpConnection.handleRequest(BlockingHttpConnection.java:53)\n        at org.eclipse.jetty.server.AbstractHttpConnection.headerComplete(AbstractHttpConnection.java:942)\n        at org.eclipse.jetty.server.AbstractHttpConnection$RequestHandler.headerComplete(AbstractHttpConnection.java:1004)\n        at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:640)\n        at org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:235)\n        at org.eclipse.jetty.server.BlockingHttpConnection.handle(BlockingHttpConnection.java:72)\n        at org.eclipse.jetty.server.bio.SocketConnector$ConnectorEndPoint.run(SocketConnector.java:264)\n        at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:608)\n        at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:543)\n        at java.lang.Thread.run(Thread.java:744)",
    "attachments": {},
    "issue_links": {},
    "comments": []
}