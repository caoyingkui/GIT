{
    "id": "LUCENE-7197",
    "title": "Geo3DPoint test failure",
    "details": {
        "resolution": "Fixed",
        "affect_versions": "6.0",
        "components": [
            "modules/spatial3d"
        ],
        "labels": "",
        "fix_versions": [
            "6.0"
        ],
        "priority": "Major",
        "status": "Resolved",
        "type": "Bug"
    },
    "description": "Here's the test failure:\n\n\n1 tests failed.\nFAILED:  org.apache.lucene.spatial3d.TestGeo3DPoint.testRandomMedium\n\nError Message:\nFAIL: id=174 should have matched but did not   shape=GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.022713796927720124, lon=-0.5815768716211268], [lat=-0.7946950025059678, lon=0.4282667468610472], [lat=0.1408596217595416, lon=-0.6098466679977738], [lat=0.7965414531411178, lon=-1.508912143762057]], internalEdges={3}, holes=[]}, GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.7965414531411178, lon=-1.508912143762057], [lat=-0.7033145536783815, lon=0.4464269851814595], [lat=1.0518471862927206, lon=-2.5948050766629582]], internalEdges={1, 2}, holes=[]}, GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.5472103826277904, lon=2.6487090531266837], [lat=1.0518471862927206, lon=-2.5948050766629582], [lat=0.7965414531411178, lon=-1.508912143762057]], internalEdges={1, 2}, holes=[]}, GeoConcavePolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.5472103826277904, lon=2.6487090531266837], [lat=0.7965414531411178, lon=-1.508912143762057], [lat=0.022713796927720124, lon=-0.5815768716211268], [lat=-0.5523784795034061, lon=-0.05097322618399754]], internalEdges={0, 1}, holes=[]}, GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=1.0518471862927206, lon=-2.5948050766629582], [lat=-0.7033145536783815, lon=0.4464269851814595], [lat=-0.32165871220450476, lon=-0.2306821921389016]], internalEdges={0}, holes=[]}]}   point=[X=0.026933631938481088, Y=-0.1374352774704889, Z=0.9879509190301249]   docID=164 deleted?=false   query=PointInGeo3DShapeQuery: field=point: Shape: GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.022713796927720124, lon=-0.5815768716211268], [lat=-0.7946950025059678, lon=0.4282667468610472], [lat=0.1408596217595416, lon=-0.6098466679977738], [lat=0.7965414531411178, lon=-1.508912143762057]], internalEdges={3}, holes=[]}, GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.7965414531411178, lon=-1.508912143762057], [lat=-0.7033145536783815, lon=0.4464269851814595], [lat=1.0518471862927206, lon=-2.5948050766629582]], internalEdges={1, 2}, holes=[]}, GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.5472103826277904, lon=2.6487090531266837], [lat=1.0518471862927206, lon=-2.5948050766629582], [lat=0.7965414531411178, lon=-1.508912143762057]], internalEdges={1, 2}, holes=[]}, GeoConcavePolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.5472103826277904, lon=2.6487090531266837], [lat=0.7965414531411178, lon=-1.508912143762057], [lat=0.022713796927720124, lon=-0.5815768716211268], [lat=-0.5523784795034061, lon=-0.05097322618399754]], internalEdges={0, 1}, holes=[]}, GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=1.0518471862927206, lon=-2.5948050766629582], [lat=-0.7033145536783815, lon=0.4464269851814595], [lat=-0.32165871220450476, lon=-0.2306821921389016]], internalEdges={0}, holes=[]}]}   explanation:     target is in leaf _w(6.1.0):C23769 of full reader StandardDirectoryReader(segments:70:nrt _w(6.1.0):C23769)     full BKD path to target doc:       Cell(x=-1.0011088352687925 TO -0.6552151159613697 y=-1.000763585323458 TO 2.587423617105566E-4 z=-0.997762292058209 TO -0.3456185524111195)       Cell(x=-1.0011088352687925 TO -0.6552151159613697 y=-1.000763585323458 TO 2.587423617105566E-4 z=-0.34561855287730175 TO -0.010034327274334781)       Cell(x=-0.6552151164275519 TO -0.49692303680890554 y=-1.000763585323458 TO 2.587423617105566E-4 z=-0.997762292058209 TO -0.010034327274334781)       Cell(x=-0.49692303727508774 TO -0.36821096452714464 y=-1.000763585323458 TO 2.587423617105566E-4 z=-0.997762292058209 TO -0.010034327274334781)       Cell(x=-0.36821096499332684 TO -0.25063435608431966 y=-1.000763585323458 TO 2.587423617105566E-4 z=-0.997762292058209 TO -0.010034327274334781)       Cell(x=-0.25063435655050187 TO -0.14842841329097298 y=-1.000763585323458 TO 2.587423617105566E-4 z=-0.997762292058209 TO -0.010034327274334781)       Cell(x=-0.14842841375715526 TO -0.0052465148368604775 y=-1.000763585323458 TO -0.2511880118919554 z=-0.997762292058209 TO -0.010034327274334781)       Cell(x=-0.14842841375715526 TO -0.0052465148368604775 y=-0.2511880123581376 TO 2.587423617105566E-4 z=-0.997762292058209 TO -0.010034327274334781)       Cell(x=-0.005246515303042771 TO 0.34833399434806217 y=-1.000763585323458 TO 2.587423617105566E-4 z=-0.997762292058209 TO -0.9797970594803297)       Cell(x=-0.005246515303042771 TO 0.34833399434806217 y=-1.000763585323458 TO 2.587423617105566E-4 z=-0.9797970599465119 TO -0.9292097400113875)       Cell(x=-0.005246515303042771 TO 0.34833399434806217 y=-1.000763585323458 TO 2.587423617105566E-4 z=-0.9292097404775697 TO -0.704145502815162)       Cell(x=-0.005246515303042771 TO 0.34833399434806217 y=-1.000763585323458 TO 2.587423617105566E-4 z=-0.7041455032813442 TO -0.010034327274334781)       Cell(x=0.34833399388187997 TO 0.4822898738799183 y=-1.000763585323458 TO 2.587423617105566E-4 z=-0.997762292058209 TO -0.010034327274334781)       Cell(x=0.482289873413736 TO 0.6315110483434547 y=-1.000763585323458 TO 2.587423617105566E-4 z=-0.997762292058209 TO -0.010034327274334781)       Cell(x=0.6315110478772725 TO 1.0008262509460042 y=-1.000763585323458 TO -0.32193657996922526 z=-0.997762292058209 TO -0.010034327274334781)       Cell(x=0.6315110478772725 TO 1.0008262509460042 y=-0.3219365804354075 TO 2.587423617105566E-4 z=-0.997762292058209 TO -0.010034327274334781)       Cell(x=-1.0011088352687925 TO 1.0008262509460042 y=2.587418955282624E-4 TO 0.07716599018562534 z=-0.997762292058209 TO -0.9888915968144845)       Cell(x=-1.0011088352687925 TO 1.0008262509460042 y=2.587418955282624E-4 TO 0.07716599018562534 z=-0.9888915972806667 TO -0.7165212166771406)       Cell(x=-1.0011088352687925 TO 1.0008262509460042 y=0.07716598971944306 TO 0.19417449769624348 z=-0.997762292058209 TO -0.9658060957606812)       Cell(x=-1.0011088352687925 TO 1.0008262509460042 y=0.07716598971944306 TO 0.19417449769624348 z=-0.9658060962268633 TO -0.7165212166771406)       Cell(x=-1.0011088352687925 TO -0.02794287022049838 y=0.1941744972300612 TO 1.0010422868139164 z=-0.997762292058209 TO -0.8569650638192191)       Cell(x=-1.0011088352687925 TO -0.02794287022049838 y=0.1941744972300612 TO 1.0010422868139164 z=-0.8569650642854013 TO -0.7165212166771406)       Cell(x=-0.027942870686680672 TO 1.0008262509460042 y=0.1941744972300612 TO 0.3629267830932693 z=-0.997762292058209 TO -0.7165212166771406)       Cell(x=-0.027942870686680672 TO 1.0008262509460042 y=0.3629267826270871 TO 1.0010422868139164 z=-0.997762292058209 TO -0.7165212166771406)       Cell(x=-1.0011088352687925 TO -0.8019803577195481 y=2.587418955282624E-4 TO 0.6389050445059218 z=-0.7165212171433228 TO -0.010034327274334781)       Cell(x=-0.8019803581857303 TO 0.02984857029480781 y=2.587418955282624E-4 TO 0.6389050445059218 z=-0.7165212171433228 TO -0.010034327274334781)       Cell(x=-1.0011088352687925 TO 0.02984857029480781 y=0.6389050440397396 TO 1.0010422868139164 z=-0.7165212171433228 TO -0.36905315967019553)       Cell(x=-1.0011088352687925 TO 0.02984857029480781 y=0.6389050440397396 TO 1.0010422868139164 z=-0.3690531601363778 TO -0.010034327274334781)       Cell(x=0.02984856982862552 TO 0.37555538733061816 y=2.587418955282624E-4 TO 1.0010422868139164 z=-0.7165212171433228 TO -0.010034327274334781)       Cell(x=0.3755553868644359 TO 0.6405450360564969 y=2.587418955282624E-4 TO 1.0010422868139164 z=-0.7165212171433228 TO -0.010034327274334781)       Cell(x=0.6405450355903147 TO 0.8112367367637204 y=2.587418955282624E-4 TO 1.0010422868139164 z=-0.7165212171433228 TO -0.010034327274334781)       Cell(x=0.8112367362975383 TO 1.0008262509460042 y=2.587418955282624E-4 TO 1.0010422868139164 z=-0.7165212171433228 TO -0.010034327274334781)       Cell(x=-1.0011088352687925 TO -0.6274488826783633 y=-1.000763585323458 TO -0.3408426765712907 z=-0.010034327740517076 TO 0.7111324724193833)       Cell(x=-1.0011088352687925 TO -0.6274488826783633 y=-0.34084267703747295 TO 0.02145294138136383 z=-0.010034327740517076 TO 0.7111324724193833)       Cell(x=-1.0011088352687925 TO -0.6274488826783633 y=0.02145294091518154 TO 0.38385795134028683 z=-0.010034327740517076 TO 0.7111324724193833)       Cell(x=-1.0011088352687925 TO -0.6274488826783633 y=0.38385795087410457 TO 1.0010422868139164 z=-0.010034327740517076 TO 0.7111324724193833)       Cell(x=-0.6274488831445454 TO 0.004684528817807952 y=-1.000763585323458 TO -0.7384245535555886 z=-0.010034327740517076 TO 0.4296107105436471)       Cell(x=-0.6274488831445454 TO 0.004684528817807952 y=-0.7384245540217707 TO 1.0010422868139164 z=-0.010034327740517076 TO 0.4296107105436471)       Cell(x=-0.6274488831445454 TO -0.34773771922271723 y=-1.000763585323458 TO 1.0010422868139164 z=0.4296107100774649 TO 0.7111324724193833)       Cell(x=-0.3477377196888995 TO 0.004684528817807952 y=-1.000763585323458 TO 1.0010422868139164 z=0.4296107100774649 TO 0.7111324724193833)       Cell(x=0.004684528351625658 TO 0.6132641927106783 y=-1.000763585323458 TO -0.823755793756097 z=-0.010034327740517076 TO 0.7111324724193833)       Cell(x=0.004684528351625658 TO 0.6132641927106783 y=-0.8237557942222792 TO -0.04095454670508251 z=-0.010034327740517076 TO 0.7111324724193833)       Cell(x=0.6132641922444961 TO 1.0008262509460042 y=-1.000763585323458 TO -0.04095454670508251 z=-0.010034327740517076 TO 0.33145283046862506)       Cell(x=0.6132641922444961 TO 1.0008262509460042 y=-1.000763585323458 TO -0.04095454670508251 z=0.3314528300024428 TO 0.7111324724193833)       Cell(x=0.004684528351625658 TO 0.6158775425898989 y=-0.040954547171264795 TO 1.0010422868139164 z=-0.010034327740517076 TO 0.4150281535674352)       Cell(x=0.004684528351625658 TO 0.6158775425898989 y=-0.040954547171264795 TO 1.0010422868139164 z=0.41502815310125296 TO 0.7111324724193833)       Cell(x=0.6158775421237168 TO 0.8139689412174194 y=-0.040954547171264795 TO 1.0010422868139164 z=-0.010034327740517076 TO 0.7111324724193833)       Cell(x=0.8139689407512372 TO 1.0008262509460042 y=-0.040954547171264795 TO 1.0010422868139164 z=-0.010034327740517076 TO 0.7111324724193833)       Cell(x=-1.0011088352687925 TO 0.001323584769971411 y=-1.000763585323458 TO 0.007099080851812687 z=0.7111324719532012 TO 0.835750462797638)       Cell(x=-1.0011088352687925 TO 0.001323584769971411 y=-1.000763585323458 TO 0.007099080851812687 z=0.8357504623314558 TO 0.9292240280325251)       Cell(x=0.0013235843037891167 TO 1.0008262509460042 y=-1.000763585323458 TO -0.3493023966927371 z=0.7111324719532012 TO 0.9292240280325251)       Cell(x=0.0013235843037891167 TO 1.0008262509460042 y=-0.34930239715891936 TO 0.007099080851812687 z=0.7111324719532012 TO 0.9292240280325251)       Cell(x=-1.0011088352687925 TO 1.0008262509460042 y=-1.000763585323458 TO -0.1753250445738468 z=0.9292240275663429 TO 0.9826918175044095)       Cell(x=-1.0011088352687925 TO 1.0008262509460042 y=-0.17532504504002905 TO 0.007099080851812687 z=0.9292240275663429 TO 0.9826918175044095)       Cell(x=-1.0011088352687925 TO 1.0008262509460042 y=-1.000763585323458 TO 0.007099080851812687 z=0.9826918170382273 TO 0.9944024015823575)\n\nStack Trace:\njava.lang.AssertionError: FAIL: id=174 should have matched but did not\n  shape=GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.022713796927720124, lon=-0.5815768716211268], [lat=-0.7946950025059678, lon=0.4282667468610472], [lat=0.1408596217595416, lon=-0.6098466679977738], [lat=0.7965414531411178, lon=-1.508912143762057]], internalEdges={3}, holes=[]}, GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.7965414531411178, lon=-1.508912143762057], [lat=-0.7033145536783815, lon=0.4464269851814595], [lat=1.0518471862927206, lon=-2.5948050766629582]], internalEdges={1, 2}, holes=[]}, GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.5472103826277904, lon=2.6487090531266837], [lat=1.0518471862927206, lon=-2.5948050766629582], [lat=0.7965414531411178, lon=-1.508912143762057]], internalEdges={1, 2}, holes=[]}, GeoConcavePolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.5472103826277904, lon=2.6487090531266837], [lat=0.7965414531411178, lon=-1.508912143762057], [lat=0.022713796927720124, lon=-0.5815768716211268], [lat=-0.5523784795034061, lon=-0.05097322618399754]], internalEdges={0, 1}, holes=[]}, GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=1.0518471862927206, lon=-2.5948050766629582], [lat=-0.7033145536783815, lon=0.4464269851814595], [lat=-0.32165871220450476, lon=-0.2306821921389016]], internalEdges={0}, holes=[]}]}\n  point=[X=0.026933631938481088, Y=-0.1374352774704889, Z=0.9879509190301249]\n  docID=164 deleted?=false\n  query=PointInGeo3DShapeQuery: field=point: Shape: GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.022713796927720124, lon=-0.5815768716211268], [lat=-0.7946950025059678, lon=0.4282667468610472], [lat=0.1408596217595416, lon=-0.6098466679977738], [lat=0.7965414531411178, lon=-1.508912143762057]], internalEdges={3}, holes=[]}, GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.7965414531411178, lon=-1.508912143762057], [lat=-0.7033145536783815, lon=0.4464269851814595], [lat=1.0518471862927206, lon=-2.5948050766629582]], internalEdges={1, 2}, holes=[]}, GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.5472103826277904, lon=2.6487090531266837], [lat=1.0518471862927206, lon=-2.5948050766629582], [lat=0.7965414531411178, lon=-1.508912143762057]], internalEdges={1, 2}, holes=[]}, GeoConcavePolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.5472103826277904, lon=2.6487090531266837], [lat=0.7965414531411178, lon=-1.508912143762057], [lat=0.022713796927720124, lon=-0.5815768716211268], [lat=-0.5523784795034061, lon=-0.05097322618399754]], internalEdges={0, 1}, holes=[]}, GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=1.0518471862927206, lon=-2.5948050766629582], [lat=-0.7033145536783815, lon=0.4464269851814595], [lat=-0.32165871220450476, lon=-0.2306821921389016]], internalEdges={0}, holes=[]}]}\n  explanation:\n    target is in leaf _w(6.1.0):C23769 of full reader StandardDirectoryReader(segments:70:nrt _w(6.1.0):C23769)\n    full BKD path to target doc:\n      Cell(x=-1.0011088352687925 TO -0.6552151159613697 y=-1.000763585323458 TO 2.587423617105566E-4 z=-0.997762292058209 TO -0.3456185524111195)\n      Cell(x=-1.0011088352687925 TO -0.6552151159613697 y=-1.000763585323458 TO 2.587423617105566E-4 z=-0.34561855287730175 TO -0.010034327274334781)\n      Cell(x=-0.6552151164275519 TO -0.49692303680890554 y=-1.000763585323458 TO 2.587423617105566E-4 z=-0.997762292058209 TO -0.010034327274334781)\n      Cell(x=-0.49692303727508774 TO -0.36821096452714464 y=-1.000763585323458 TO 2.587423617105566E-4 z=-0.997762292058209 TO -0.010034327274334781)\n      Cell(x=-0.36821096499332684 TO -0.25063435608431966 y=-1.000763585323458 TO 2.587423617105566E-4 z=-0.997762292058209 TO -0.010034327274334781)\n      Cell(x=-0.25063435655050187 TO -0.14842841329097298 y=-1.000763585323458 TO 2.587423617105566E-4 z=-0.997762292058209 TO -0.010034327274334781)\n      Cell(x=-0.14842841375715526 TO -0.0052465148368604775 y=-1.000763585323458 TO -0.2511880118919554 z=-0.997762292058209 TO -0.010034327274334781)\n      Cell(x=-0.14842841375715526 TO -0.0052465148368604775 y=-0.2511880123581376 TO 2.587423617105566E-4 z=-0.997762292058209 TO -0.010034327274334781)\n      Cell(x=-0.005246515303042771 TO 0.34833399434806217 y=-1.000763585323458 TO 2.587423617105566E-4 z=-0.997762292058209 TO -0.9797970594803297)\n      Cell(x=-0.005246515303042771 TO 0.34833399434806217 y=-1.000763585323458 TO 2.587423617105566E-4 z=-0.9797970599465119 TO -0.9292097400113875)\n      Cell(x=-0.005246515303042771 TO 0.34833399434806217 y=-1.000763585323458 TO 2.587423617105566E-4 z=-0.9292097404775697 TO -0.704145502815162)\n      Cell(x=-0.005246515303042771 TO 0.34833399434806217 y=-1.000763585323458 TO 2.587423617105566E-4 z=-0.7041455032813442 TO -0.010034327274334781)\n      Cell(x=0.34833399388187997 TO 0.4822898738799183 y=-1.000763585323458 TO 2.587423617105566E-4 z=-0.997762292058209 TO -0.010034327274334781)\n      Cell(x=0.482289873413736 TO 0.6315110483434547 y=-1.000763585323458 TO 2.587423617105566E-4 z=-0.997762292058209 TO -0.010034327274334781)\n      Cell(x=0.6315110478772725 TO 1.0008262509460042 y=-1.000763585323458 TO -0.32193657996922526 z=-0.997762292058209 TO -0.010034327274334781)\n      Cell(x=0.6315110478772725 TO 1.0008262509460042 y=-0.3219365804354075 TO 2.587423617105566E-4 z=-0.997762292058209 TO -0.010034327274334781)\n      Cell(x=-1.0011088352687925 TO 1.0008262509460042 y=2.587418955282624E-4 TO 0.07716599018562534 z=-0.997762292058209 TO -0.9888915968144845)\n      Cell(x=-1.0011088352687925 TO 1.0008262509460042 y=2.587418955282624E-4 TO 0.07716599018562534 z=-0.9888915972806667 TO -0.7165212166771406)\n      Cell(x=-1.0011088352687925 TO 1.0008262509460042 y=0.07716598971944306 TO 0.19417449769624348 z=-0.997762292058209 TO -0.9658060957606812)\n      Cell(x=-1.0011088352687925 TO 1.0008262509460042 y=0.07716598971944306 TO 0.19417449769624348 z=-0.9658060962268633 TO -0.7165212166771406)\n      Cell(x=-1.0011088352687925 TO -0.02794287022049838 y=0.1941744972300612 TO 1.0010422868139164 z=-0.997762292058209 TO -0.8569650638192191)\n      Cell(x=-1.0011088352687925 TO -0.02794287022049838 y=0.1941744972300612 TO 1.0010422868139164 z=-0.8569650642854013 TO -0.7165212166771406)\n      Cell(x=-0.027942870686680672 TO 1.0008262509460042 y=0.1941744972300612 TO 0.3629267830932693 z=-0.997762292058209 TO -0.7165212166771406)\n      Cell(x=-0.027942870686680672 TO 1.0008262509460042 y=0.3629267826270871 TO 1.0010422868139164 z=-0.997762292058209 TO -0.7165212166771406)\n      Cell(x=-1.0011088352687925 TO -0.8019803577195481 y=2.587418955282624E-4 TO 0.6389050445059218 z=-0.7165212171433228 TO -0.010034327274334781)\n      Cell(x=-0.8019803581857303 TO 0.02984857029480781 y=2.587418955282624E-4 TO 0.6389050445059218 z=-0.7165212171433228 TO -0.010034327274334781)\n      Cell(x=-1.0011088352687925 TO 0.02984857029480781 y=0.6389050440397396 TO 1.0010422868139164 z=-0.7165212171433228 TO -0.36905315967019553)\n      Cell(x=-1.0011088352687925 TO 0.02984857029480781 y=0.6389050440397396 TO 1.0010422868139164 z=-0.3690531601363778 TO -0.010034327274334781)\n      Cell(x=0.02984856982862552 TO 0.37555538733061816 y=2.587418955282624E-4 TO 1.0010422868139164 z=-0.7165212171433228 TO -0.010034327274334781)\n      Cell(x=0.3755553868644359 TO 0.6405450360564969 y=2.587418955282624E-4 TO 1.0010422868139164 z=-0.7165212171433228 TO -0.010034327274334781)\n      Cell(x=0.6405450355903147 TO 0.8112367367637204 y=2.587418955282624E-4 TO 1.0010422868139164 z=-0.7165212171433228 TO -0.010034327274334781)\n      Cell(x=0.8112367362975383 TO 1.0008262509460042 y=2.587418955282624E-4 TO 1.0010422868139164 z=-0.7165212171433228 TO -0.010034327274334781)\n      Cell(x=-1.0011088352687925 TO -0.6274488826783633 y=-1.000763585323458 TO -0.3408426765712907 z=-0.010034327740517076 TO 0.7111324724193833)\n      Cell(x=-1.0011088352687925 TO -0.6274488826783633 y=-0.34084267703747295 TO 0.02145294138136383 z=-0.010034327740517076 TO 0.7111324724193833)\n      Cell(x=-1.0011088352687925 TO -0.6274488826783633 y=0.02145294091518154 TO 0.38385795134028683 z=-0.010034327740517076 TO 0.7111324724193833)\n      Cell(x=-1.0011088352687925 TO -0.6274488826783633 y=0.38385795087410457 TO 1.0010422868139164 z=-0.010034327740517076 TO 0.7111324724193833)\n      Cell(x=-0.6274488831445454 TO 0.004684528817807952 y=-1.000763585323458 TO -0.7384245535555886 z=-0.010034327740517076 TO 0.4296107105436471)\n      Cell(x=-0.6274488831445454 TO 0.004684528817807952 y=-0.7384245540217707 TO 1.0010422868139164 z=-0.010034327740517076 TO 0.4296107105436471)\n      Cell(x=-0.6274488831445454 TO -0.34773771922271723 y=-1.000763585323458 TO 1.0010422868139164 z=0.4296107100774649 TO 0.7111324724193833)\n      Cell(x=-0.3477377196888995 TO 0.004684528817807952 y=-1.000763585323458 TO 1.0010422868139164 z=0.4296107100774649 TO 0.7111324724193833)\n      Cell(x=0.004684528351625658 TO 0.6132641927106783 y=-1.000763585323458 TO -0.823755793756097 z=-0.010034327740517076 TO 0.7111324724193833)\n      Cell(x=0.004684528351625658 TO 0.6132641927106783 y=-0.8237557942222792 TO -0.04095454670508251 z=-0.010034327740517076 TO 0.7111324724193833)\n      Cell(x=0.6132641922444961 TO 1.0008262509460042 y=-1.000763585323458 TO -0.04095454670508251 z=-0.010034327740517076 TO 0.33145283046862506)\n      Cell(x=0.6132641922444961 TO 1.0008262509460042 y=-1.000763585323458 TO -0.04095454670508251 z=0.3314528300024428 TO 0.7111324724193833)\n      Cell(x=0.004684528351625658 TO 0.6158775425898989 y=-0.040954547171264795 TO 1.0010422868139164 z=-0.010034327740517076 TO 0.4150281535674352)\n      Cell(x=0.004684528351625658 TO 0.6158775425898989 y=-0.040954547171264795 TO 1.0010422868139164 z=0.41502815310125296 TO 0.7111324724193833)\n      Cell(x=0.6158775421237168 TO 0.8139689412174194 y=-0.040954547171264795 TO 1.0010422868139164 z=-0.010034327740517076 TO 0.7111324724193833)\n      Cell(x=0.8139689407512372 TO 1.0008262509460042 y=-0.040954547171264795 TO 1.0010422868139164 z=-0.010034327740517076 TO 0.7111324724193833)\n      Cell(x=-1.0011088352687925 TO 0.001323584769971411 y=-1.000763585323458 TO 0.007099080851812687 z=0.7111324719532012 TO 0.835750462797638)\n      Cell(x=-1.0011088352687925 TO 0.001323584769971411 y=-1.000763585323458 TO 0.007099080851812687 z=0.8357504623314558 TO 0.9292240280325251)\n      Cell(x=0.0013235843037891167 TO 1.0008262509460042 y=-1.000763585323458 TO -0.3493023966927371 z=0.7111324719532012 TO 0.9292240280325251)\n      Cell(x=0.0013235843037891167 TO 1.0008262509460042 y=-0.34930239715891936 TO 0.007099080851812687 z=0.7111324719532012 TO 0.9292240280325251)\n      Cell(x=-1.0011088352687925 TO 1.0008262509460042 y=-1.000763585323458 TO -0.1753250445738468 z=0.9292240275663429 TO 0.9826918175044095)\n      Cell(x=-1.0011088352687925 TO 1.0008262509460042 y=-0.17532504504002905 TO 0.007099080851812687 z=0.9292240275663429 TO 0.9826918175044095)\n      Cell(x=-1.0011088352687925 TO 1.0008262509460042 y=-1.000763585323458 TO 0.007099080851812687 z=0.9826918170382273 TO 0.9944024015823575)\n\n        at __randomizedtesting.SeedInfo.seed([6FF46E709A772D73:D22A59D8DB124E15]:0)\n        at org.junit.Assert.fail(Assert.java:93)\n        at org.apache.lucene.spatial3d.TestGeo3DPoint.verify(TestGeo3DPoint.java:795)\n        at org.apache.lucene.spatial3d.TestGeo3DPoint.doTestRandom(TestGeo3DPoint.java:517)\n        at org.apache.lucene.spatial3d.TestGeo3DPoint.testRandomMedium(TestGeo3DPoint.java:444)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n        at java.lang.reflect.Method.invoke(Method.java:498)\n        at com.carrotsearch.randomizedtesting.RandomizedRunner.invoke(RandomizedRunner.java:1764)\n        at com.carrotsearch.randomizedtesting.RandomizedRunner$8.evaluate(RandomizedRunner.java:871)\n        at com.carrotsearch.randomizedtesting.RandomizedRunner$9.evaluate(RandomizedRunner.java:907)\n        at com.carrotsearch.randomizedtesting.RandomizedRunner$10.evaluate(RandomizedRunner.java:921)\n        at org.apache.lucene.util.TestRuleSetupTeardownChained$1.evaluate(TestRuleSetupTeardownChained.java:49)\n        at org.apache.lucene.util.AbstractBeforeAfterRule$1.evaluate(AbstractBeforeAfterRule.java:45)\n        at org.apache.lucene.util.TestRuleThreadAndTestName$1.evaluate(TestRuleThreadAndTestName.java:48)\n        at org.apache.lucene.util.TestRuleIgnoreAfterMaxFailures$1.evaluate(TestRuleIgnoreAfterMaxFailures.java:64)\n        at org.apache.lucene.util.TestRuleMarkFailure$1.evaluate(TestRuleMarkFailure.java:47)\n        at com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\n        at com.carrotsearch.randomizedtesting.ThreadLeakControl$StatementRunner.run(ThreadLeakControl.java:367)\n        at com.carrotsearch.randomizedtesting.ThreadLeakControl.forkTimeoutingTask(ThreadLeakControl.java:809)\n        at com.carrotsearch.randomizedtesting.ThreadLeakControl$3.evaluate(ThreadLeakControl.java:460)\n        at com.carrotsearch.randomizedtesting.RandomizedRunner.runSingleTest(RandomizedRunner.java:880)\n        at com.carrotsearch.randomizedtesting.RandomizedRunner$5.evaluate(RandomizedRunner.java:781)\n        at com.carrotsearch.randomizedtesting.RandomizedRunner$6.evaluate(RandomizedRunner.java:816)\n        at com.carrotsearch.randomizedtesting.RandomizedRunner$7.evaluate(RandomizedRunner.java:827)\n        at org.apache.lucene.util.AbstractBeforeAfterRule$1.evaluate(AbstractBeforeAfterRule.java:45)\n        at com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\n        at org.apache.lucene.util.TestRuleStoreClassName$1.evaluate(TestRuleStoreClassName.java:41)\n        at com.carrotsearch.randomizedtesting.rules.NoShadowingOrOverridesOnMethodsRule$1.evaluate(NoShadowingOrOverridesOnMethodsRule.java:40)\n        at com.carrotsearch.randomizedtesting.rules.NoShadowingOrOverridesOnMethodsRule$1.evaluate(NoShadowingOrOverridesOnMethodsRule.java:40)\n        at com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\n        at com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\n        at com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\n        at org.apache.lucene.util.TestRuleAssertionsRequired$1.evaluate(TestRuleAssertionsRequired.java:53)\n        at org.apache.lucene.util.TestRuleMarkFailure$1.evaluate(TestRuleMarkFailure.java:47)\n        at org.apache.lucene.util.TestRuleIgnoreAfterMaxFailures$1.evaluate(TestRuleIgnoreAfterMaxFailures.java:64)\n        at org.apache.lucene.util.TestRuleIgnoreTestSuites$1.evaluate(TestRuleIgnoreTestSuites.java:54)\n        at com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\n        at com.carrotsearch.randomizedtesting.ThreadLeakControl$StatementRunner.run(ThreadLeakControl.java:367)\n        at java.lang.Thread.run(Thread.java:745)\n\n\n\n\nBuild Log:\n[...truncated 9014 lines...]\n   [junit4] Suite: org.apache.lucene.spatial3d.TestGeo3DPoint\n   [junit4] IGNOR/A 0.01s J0 | TestGeo3DPoint.testRandomBig\n   [junit4]    > Assumption #1: 'nightly' test group is disabled (@Nightly())\n   [junit4]   2> NOTE: reproduce with: ant test  -Dtestcase=TestGeo3DPoint -Dtests.method=testRandomMedium -Dtests.seed=6FF46E709A772D73 -Dtests.multiplier=2 -Dtests.slow=true -Dtests.locale=ar-DZ -Dtests.timezone=Australia/Lindeman -Dtests.asserts=true -Dtests.file.encoding=UTF-8\n   [junit4] FAILURE 6.59s J0 | TestGeo3DPoint.testRandomMedium <<<\n   [junit4]    > Throwable #1: java.lang.AssertionError: FAIL: id=174 should have matched but did not\n   [junit4]    >   shape=GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.022713796927720124, lon=-0.5815768716211268], [lat=-0.7946950025059678, lon=0.4282667468610472], [lat=0.1408596217595416, lon=-0.6098466679977738], [lat=0.7965414531411178, lon=-1.508912143762057]], internalEdges={3}, holes=[]}, GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.7965414531411178, lon=-1.508912143762057], [lat=-0.7033145536783815, lon=0.4464269851814595], [lat=1.0518471862927206, lon=-2.5948050766629582]], internalEdges={1, 2}, holes=[]}, GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.5472103826277904, lon=2.6487090531266837], [lat=1.0518471862927206, lon=-2.5948050766629582], [lat=0.7965414531411178, lon=-1.508912143762057]], internalEdges={1, 2}, holes=[]}, GeoConcavePolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.5472103826277904, lon=2.6487090531266837], [lat=0.7965414531411178, lon=-1.508912143762057], [lat=0.022713796927720124, lon=-0.5815768716211268], [lat=-0.5523784795034061, lon=-0.05097322618399754]], internalEdges={0, 1}, holes=[]}, GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=1.0518471862927206, lon=-2.5948050766629582], [lat=-0.7033145536783815, lon=0.4464269851814595], [lat=-0.32165871220450476, lon=-0.2306821921389016]], internalEdges={0}, holes=[]}]}\n   [junit4]    >   point=[X=0.026933631938481088, Y=-0.1374352774704889, Z=0.9879509190301249]\n   [junit4]    >   docID=164 deleted?=false\n   [junit4]    >   query=PointInGeo3DShapeQuery: field=point: Shape: GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.022713796927720124, lon=-0.5815768716211268], [lat=-0.7946950025059678, lon=0.4282667468610472], [lat=0.1408596217595416, lon=-0.6098466679977738], [lat=0.7965414531411178, lon=-1.508912143762057]], internalEdges={3}, holes=[]}, GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.7965414531411178, lon=-1.508912143762057], [lat=-0.7033145536783815, lon=0.4464269851814595], [lat=1.0518471862927206, lon=-2.5948050766629582]], internalEdges={1, 2}, holes=[]}, GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.5472103826277904, lon=2.6487090531266837], [lat=1.0518471862927206, lon=-2.5948050766629582], [lat=0.7965414531411178, lon=-1.508912143762057]], internalEdges={1, 2}, holes=[]}, GeoConcavePolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.5472103826277904, lon=2.6487090531266837], [lat=0.7965414531411178, lon=-1.508912143762057], [lat=0.022713796927720124, lon=-0.5815768716211268], [lat=-0.5523784795034061, lon=-0.05097322618399754]], internalEdges={0, 1}, holes=[]}, GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=1.0518471862927206, lon=-2.5948050766629582], [lat=-0.7033145536783815, lon=0.4464269851814595], [lat=-0.32165871220450476, lon=-0.2306821921389016]], internalEdges={0}, holes=[]}]}\n   [junit4]    >   explanation:\n   [junit4]    >     target is in leaf _w(6.1.0):C23769 of full reader StandardDirectoryReader(segments:70:nrt _w(6.1.0):C23769)\n   [junit4]    >     full BKD path to target doc:\n   [junit4]    >       Cell(x=-1.0011088352687925 TO -0.6552151159613697 y=-1.000763585323458 TO 2.587423617105566E-4 z=-0.997762292058209 TO -0.3456185524111195)\n   [junit4]    >       Cell(x=-1.0011088352687925 TO -0.6552151159613697 y=-1.000763585323458 TO 2.587423617105566E-4 z=-0.34561855287730175 TO -0.010034327274334781)\n   [junit4]    >       Cell(x=-0.6552151164275519 TO -0.49692303680890554 y=-1.000763585323458 TO 2.587423617105566E-4 z=-0.997762292058209 TO -0.010034327274334781)\n   [junit4]    >       Cell(x=-0.49692303727508774 TO -0.36821096452714464 y=-1.000763585323458 TO 2.587423617105566E-4 z=-0.997762292058209 TO -0.010034327274334781)\n   [junit4]    >       Cell(x=-0.36821096499332684 TO -0.25063435608431966 y=-1.000763585323458 TO 2.587423617105566E-4 z=-0.997762292058209 TO -0.010034327274334781)\n   [junit4]    >       Cell(x=-0.25063435655050187 TO -0.14842841329097298 y=-1.000763585323458 TO 2.587423617105566E-4 z=-0.997762292058209 TO -0.010034327274334781)\n   [junit4]    >       Cell(x=-0.14842841375715526 TO -0.0052465148368604775 y=-1.000763585323458 TO -0.2511880118919554 z=-0.997762292058209 TO -0.010034327274334781)\n   [junit4]    >       Cell(x=-0.14842841375715526 TO -0.0052465148368604775 y=-0.2511880123581376 TO 2.587423617105566E-4 z=-0.997762292058209 TO -0.010034327274334781)\n   [junit4]    >       Cell(x=-0.005246515303042771 TO 0.34833399434806217 y=-1.000763585323458 TO 2.587423617105566E-4 z=-0.997762292058209 TO -0.9797970594803297)\n   [junit4]    >       Cell(x=-0.005246515303042771 TO 0.34833399434806217 y=-1.000763585323458 TO 2.587423617105566E-4 z=-0.9797970599465119 TO -0.9292097400113875)\n   [junit4]    >       Cell(x=-0.005246515303042771 TO 0.34833399434806217 y=-1.000763585323458 TO 2.587423617105566E-4 z=-0.9292097404775697 TO -0.704145502815162)\n   [junit4]    >       Cell(x=-0.005246515303042771 TO 0.34833399434806217 y=-1.000763585323458 TO 2.587423617105566E-4 z=-0.7041455032813442 TO -0.010034327274334781)\n   [junit4]    >       Cell(x=0.34833399388187997 TO 0.4822898738799183 y=-1.000763585323458 TO 2.587423617105566E-4 z=-0.997762292058209 TO -0.010034327274334781)\n   [junit4]    >       Cell(x=0.482289873413736 TO 0.6315110483434547 y=-1.000763585323458 TO 2.587423617105566E-4 z=-0.997762292058209 TO -0.010034327274334781)\n   [junit4]    >       Cell(x=0.6315110478772725 TO 1.0008262509460042 y=-1.000763585323458 TO -0.32193657996922526 z=-0.997762292058209 TO -0.010034327274334781)\n   [junit4]    >       Cell(x=0.6315110478772725 TO 1.0008262509460042 y=-0.3219365804354075 TO 2.587423617105566E-4 z=-0.997762292058209 TO -0.010034327274334781)\n   [junit4]    >       Cell(x=-1.0011088352687925 TO 1.0008262509460042 y=2.587418955282624E-4 TO 0.07716599018562534 z=-0.997762292058209 TO -0.9888915968144845)\n   [junit4]    >       Cell(x=-1.0011088352687925 TO 1.0008262509460042 y=2.587418955282624E-4 TO 0.07716599018562534 z=-0.9888915972806667 TO -0.7165212166771406)\n   [junit4]    >       Cell(x=-1.0011088352687925 TO 1.0008262509460042 y=0.07716598971944306 TO 0.19417449769624348 z=-0.997762292058209 TO -0.9658060957606812)\n   [junit4]    >       Cell(x=-1.0011088352687925 TO 1.0008262509460042 y=0.07716598971944306 TO 0.19417449769624348 z=-0.9658060962268633 TO -0.7165212166771406)\n   [junit4]    >       Cell(x=-1.0011088352687925 TO -0.02794287022049838 y=0.1941744972300612 TO 1.0010422868139164 z=-0.997762292058209 TO -0.8569650638192191)\n   [junit4]    >       Cell(x=-1.0011088352687925 TO -0.02794287022049838 y=0.1941744972300612 TO 1.0010422868139164 z=-0.8569650642854013 TO -0.7165212166771406)\n   [junit4]    >       Cell(x=-0.027942870686680672 TO 1.0008262509460042 y=0.1941744972300612 TO 0.3629267830932693 z=-0.997762292058209 TO -0.7165212166771406)\n   [junit4]    >       Cell(x=-0.027942870686680672 TO 1.0008262509460042 y=0.3629267826270871 TO 1.0010422868139164 z=-0.997762292058209 TO -0.7165212166771406)\n   [junit4]    >       Cell(x=-1.0011088352687925 TO -0.8019803577195481 y=2.587418955282624E-4 TO 0.6389050445059218 z=-0.7165212171433228 TO -0.010034327274334781)\n   [junit4]    >       Cell(x=-0.8019803581857303 TO 0.02984857029480781 y=2.587418955282624E-4 TO 0.6389050445059218 z=-0.7165212171433228 TO -0.010034327274334781)\n   [junit4]    >       Cell(x=-1.0011088352687925 TO 0.02984857029480781 y=0.6389050440397396 TO 1.0010422868139164 z=-0.7165212171433228 TO -0.36905315967019553)\n   [junit4]    >       Cell(x=-1.0011088352687925 TO 0.02984857029480781 y=0.6389050440397396 TO 1.0010422868139164 z=-0.3690531601363778 TO -0.010034327274334781)\n   [junit4]    >       Cell(x=0.02984856982862552 TO 0.37555538733061816 y=2.587418955282624E-4 TO 1.0010422868139164 z=-0.7165212171433228 TO -0.010034327274334781)\n   [junit4]    >       Cell(x=0.3755553868644359 TO 0.6405450360564969 y=2.587418955282624E-4 TO 1.0010422868139164 z=-0.7165212171433228 TO -0.010034327274334781)\n   [junit4]    >       Cell(x=0.6405450355903147 TO 0.8112367367637204 y=2.587418955282624E-4 TO 1.0010422868139164 z=-0.7165212171433228 TO -0.010034327274334781)\n   [junit4]    >       Cell(x=0.8112367362975383 TO 1.0008262509460042 y=2.587418955282624E-4 TO 1.0010422868139164 z=-0.7165212171433228 TO -0.010034327274334781)\n   [junit4]    >       Cell(x=-1.0011088352687925 TO -0.6274488826783633 y=-1.000763585323458 TO -0.3408426765712907 z=-0.010034327740517076 TO 0.7111324724193833)\n   [junit4]    >       Cell(x=-1.0011088352687925 TO -0.6274488826783633 y=-0.34084267703747295 TO 0.02145294138136383 z=-0.010034327740517076 TO 0.7111324724193833)\n   [junit4]    >       Cell(x=-1.0011088352687925 TO -0.6274488826783633 y=0.02145294091518154 TO 0.38385795134028683 z=-0.010034327740517076 TO 0.7111324724193833)\n   [junit4]    >       Cell(x=-1.0011088352687925 TO -0.6274488826783633 y=0.38385795087410457 TO 1.0010422868139164 z=-0.010034327740517076 TO 0.7111324724193833)\n   [junit4]    >       Cell(x=-0.6274488831445454 TO 0.004684528817807952 y=-1.000763585323458 TO -0.7384245535555886 z=-0.010034327740517076 TO 0.4296107105436471)\n   [junit4]    >       Cell(x=-0.6274488831445454 TO 0.004684528817807952 y=-0.7384245540217707 TO 1.0010422868139164 z=-0.010034327740517076 TO 0.4296107105436471)\n   [junit4]    >       Cell(x=-0.6274488831445454 TO -0.34773771922271723 y=-1.000763585323458 TO 1.0010422868139164 z=0.4296107100774649 TO 0.7111324724193833)\n   [junit4]    >       Cell(x=-0.3477377196888995 TO 0.004684528817807952 y=-1.000763585323458 TO 1.0010422868139164 z=0.4296107100774649 TO 0.7111324724193833)\n   [junit4]    >       Cell(x=0.004684528351625658 TO 0.6132641927106783 y=-1.000763585323458 TO -0.823755793756097 z=-0.010034327740517076 TO 0.7111324724193833)\n   [junit4]    >       Cell(x=0.004684528351625658 TO 0.6132641927106783 y=-0.8237557942222792 TO -0.04095454670508251 z=-0.010034327740517076 TO 0.7111324724193833)\n   [junit4]    >       Cell(x=0.6132641922444961 TO 1.0008262509460042 y=-1.000763585323458 TO -0.04095454670508251 z=-0.010034327740517076 TO 0.33145283046862506)\n   [junit4]    >       Cell(x=0.6132641922444961 TO 1.0008262509460042 y=-1.000763585323458 TO -0.04095454670508251 z=0.3314528300024428 TO 0.7111324724193833)\n   [junit4]    >       Cell(x=0.004684528351625658 TO 0.6158775425898989 y=-0.040954547171264795 TO 1.0010422868139164 z=-0.010034327740517076 TO 0.4150281535674352)\n   [junit4]    >       Cell(x=0.004684528351625658 TO 0.6158775425898989 y=-0.040954547171264795 TO 1.0010422868139164 z=0.41502815310125296 TO 0.7111324724193833)\n   [junit4]    >       Cell(x=0.6158775421237168 TO 0.8139689412174194 y=-0.040954547171264795 TO 1.0010422868139164 z=-0.010034327740517076 TO 0.7111324724193833)\n   [junit4]    >       Cell(x=0.8139689407512372 TO 1.0008262509460042 y=-0.040954547171264795 TO 1.0010422868139164 z=-0.010034327740517076 TO 0.7111324724193833)\n   [junit4]    >       Cell(x=-1.0011088352687925 TO 0.001323584769971411 y=-1.000763585323458 TO 0.007099080851812687 z=0.7111324719532012 TO 0.835750462797638)\n   [junit4]    >       Cell(x=-1.0011088352687925 TO 0.001323584769971411 y=-1.000763585323458 TO 0.007099080851812687 z=0.8357504623314558 TO 0.9292240280325251)\n   [junit4]    >       Cell(x=0.0013235843037891167 TO 1.0008262509460042 y=-1.000763585323458 TO -0.3493023966927371 z=0.7111324719532012 TO 0.9292240280325251)\n   [junit4]    >       Cell(x=0.0013235843037891167 TO 1.0008262509460042 y=-0.34930239715891936 TO 0.007099080851812687 z=0.7111324719532012 TO 0.9292240280325251)\n   [junit4]    >       Cell(x=-1.0011088352687925 TO 1.0008262509460042 y=-1.000763585323458 TO -0.1753250445738468 z=0.9292240275663429 TO 0.9826918175044095)\n   [junit4]    >       Cell(x=-1.0011088352687925 TO 1.0008262509460042 y=-0.17532504504002905 TO 0.007099080851812687 z=0.9292240275663429 TO 0.9826918175044095)\n   [junit4]    >       Cell(x=-1.0011088352687925 TO 1.0008262509460042 y=-1.000763585323458 TO 0.007099080851812687 z=0.9826918170382273 TO 0.9944024015823575)\n   [junit4]    >\n   [junit4]    >        at __randomizedtesting.SeedInfo.seed([6FF46E709A772D73:D22A59D8DB124E15]:0)\n   [junit4]    >        at org.apache.lucene.spatial3d.TestGeo3DPoint.verify(TestGeo3DPoint.java:795)\n   [junit4]    >        at org.apache.lucene.spatial3d.TestGeo3DPoint.doTestRandom(TestGeo3DPoint.java:517)\n   [junit4]    >        at org.apache.lucene.spatial3d.TestGeo3DPoint.testRandomMedium(TestGeo3DPoint.java:444)\n   [junit4]    >        at java.lang.Thread.run(Thread.java:745)\n   [junit4]   2> NOTE: test params are: codec=Asserting(Lucene60): {id=BlockTreeOrds(blocksize=128)}, docValues:{id=DocValuesFormat(name=Memory)}, maxPointsInLeafNode=688, maxMBSortInHeap=6.348776570959343, sim=RandomSimilarity(queryNorm=false,coord=no): {}, locale=ar-DZ, timezone=Australia/Lindeman\n   [junit4]   2> NOTE: Linux 3.13.0-52-generic amd64/Oracle Corporation 1.8.0_74 (64-bit)/cpus=4,threads=1,free=282813064,total=352321536\n   [junit4]   2> NOTE: All tests run in this JVM: [XYZSolidTest, TestGeo3DPoint]\n   [junit4] Completed [10/10 (1!)] on J0 in 26.54s, 13 tests, 1 failure, 1 skipped <<< FAILURES!",
    "attachments": {},
    "issue_links": {},
    "comments": [
        {
            "id": "comment-15233358",
            "author": "Karl Wright",
            "date": "2016-04-09T05:07:10+0000",
            "content": "I augmented Michael McCandless's explain output to include relationship information, which then leads to the following line in the forensics dump from this failure:\n\n\n   [junit4]    >       Cell(x=-1.0011088352687925 TO 1.0008262509460042 y=-1.000763585323458 TO 0.007099080851812687 z=0.9826918170382273 TO 0.9944024015823575); Shape relationship = DISJOINT; Point within cell = true; Point within shape = true\n\n\n\nFrom this it looked plausible that the cell is off the top of the world in z, and thus did not intersect with it for that reason.  But:\n\n\n   [junit4]    >   world bounds=( minX=-1.0011188539924791 maxX=1.0011188539924791 minY=-1.0011188539924791 maxY=1.0011188539924791 minZ=-0.9977622920221051 maxZ=0.9977622920221051\n\n\n\nSo I'll have to work a bit harder to see why no intersection is detected. "
        },
        {
            "id": "comment-15233437",
            "author": "Michael McCandless",
            "date": "2016-04-09T08:10:07+0000",
            "content": "Yay forensics! "
        },
        {
            "id": "comment-15233443",
            "author": "Michael McCandless",
            "date": "2016-04-09T08:41:43+0000",
            "content": "Another failure, on 6.x:\n\n\nSuite: org.apache.lucene.spatial3d.TestGeo3DPoint\n   [smoker]    [junit4] IGNOR/A 0.01s J2 | TestGeo3DPoint.testRandomBig\n   [smoker]    [junit4]    > Assumption #1: 'nightly' test group is disabled (@Nightly())\n   [smoker]    [junit4]   2> NOTE: reproduce with: ant test  -Dtestcase=TestGeo3DPoint -Dtests.method=testRandomMedium -Dtests.seed=AB1C87AA82F2EF89 -Dtests.multiplier=2 -Dtests.locale=es-VE -Dtests.timezone=Africa/Niamey -Dtests.asserts=true -Dtests.file.encoding=UTF-8\n   [smoker]    [junit4] FAILURE 2.55s J2 | TestGeo3DPoint.testRandomMedium <<<\n   [smoker]    [junit4]    > Throwable #1: java.lang.AssertionError: FAIL: id=8110 should have matched but did not\n   [smoker]    [junit4]    >   shape=GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=-0.8532322566987428, lon=-2.8534929144969876], [lat=0.7742755548509384, lon=1.4555370543705286], [lat=-0.8402448215271041, lon=-3.1033465832913087]], internalEdges={2}, holes=[GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=1.5066843301617248, lon=0.8615401840455207], [lat=1.0964870141435539, lon=2.5943881214521642], [lat=-0.8070142540769046, lon=-0.5601543821665136]], internalEdges={}, holes=[]}]}, GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=1.254943600040169, lon=-2.455701672749609], [lat=0.8399838756142208, lon=-0.6197091219150923], [lat=0.6595204508888761, lon=-0.0777586651449774]], internalEdges={}, holes=[]}]}, GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.9975360448095447, lon=-1.947231901773322], [lat=1.0804215040880678, lon=-2.120999400452007], [lat=0.8759401563733757, lon=-2.0560515158834556]], internalEdges={2}, holes=[]}, GeoConcavePolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.9975360448095447, lon=-1.947231901773322], [lat=0.8759401563733757, lon=-2.0560515158834556], [lat=1.0593274653908336, lon=-1.9878461917050225]], internalEdges={0}, holes=[]}]}]}, GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=-0.8402448215271041, lon=-3.1033465832913087], [lat=-0.27564487296038953, lon=2.5713811980617303], [lat=-0.8678809123816704, lon=1.4382377289499255]], internalEdges={2}, holes=[GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=1.5066843301617248, lon=0.8615401840455207], [lat=1.0964870141435539, lon=2.5943881214521642], [lat=-0.8070142540769046, lon=-0.5601543821665136]], internalEdges={}, holes=[]}]}, GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=1.254943600040169, lon=-2.455701672749609], [lat=0.8399838756142208, lon=-0.6197091219150923], [lat=0.6595204508888761, lon=-0.0777586651449774]], internalEdges={}, holes=[]}]}, GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.9975360448095447, lon=-1.947231901773322], [lat=1.0804215040880678, lon=-2.120999400452007], [lat=0.8759401563733757, lon=-2.0560515158834556]], internalEdges={2}, holes=[]}, GeoConcavePolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.9975360448095447, lon=-1.947231901773322], [lat=0.8759401563733757, lon=-2.0560515158834556], [lat=1.0593274653908336, lon=-1.9878461917050225]], internalEdges={0}, holes=[]}]}]}, GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.8467492502622816, lon=1.0798875031514328], [lat=-0.8711205032246575, lon=-2.816839332961], [lat=-0.14706304488488503, lon=2.5605745305340144]], internalEdges={2}, holes=[GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=1.5066843301617248, lon=0.8615401840455207], [lat=1.0964870141435539, lon=2.5943881214521642], [lat=-0.8070142540769046, lon=-0.5601543821665136]], internalEdges={}, holes=[]}]}, GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=1.254943600040169, lon=-2.455701672749609], [lat=0.8399838756142208, lon=-0.6197091219150923], [lat=0.6595204508888761, lon=-0.0777586651449774]], internalEdges={}, holes=[]}]}, GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.9975360448095447, lon=-1.947231901773322], [lat=1.0804215040880678, lon=-2.120999400452007], [lat=0.8759401563733757, lon=-2.0560515158834556]], internalEdges={2}, holes=[]}, GeoConcavePolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.9975360448095447, lon=-1.947231901773322], [lat=0.8759401563733757, lon=-2.0560515158834556], [lat=1.0593274653908336, lon=-1.9878461917050225]], internalEdges={0}, holes=[]}]}]}, GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=-0.8532322566987428, lon=-2.8534929144969876], [lat=-0.8402448215271041, lon=-3.1033465832913087], [lat=-0.8678809123816704, lon=1.4382377289499255], [lat=0.018587409980192347, lon=0.2620880396809507], [lat=-0.9594629553682933, lon=-2.2151935508754383]], internalEdges={0, 1, 4}, holes=[GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=1.5066843301617248, lon=0.8615401840455207], [lat=1.0964870141435539, lon=2.5943881214521642], [lat=-0.8070142540769046, lon=-0.5601543821665136]], internalEdges={}, holes=[]}]}, GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=1.254943600040169, lon=-2.455701672749609], [lat=0.8399838756142208, lon=-0.6197091219150923], [lat=0.6595204508888761, lon=-0.0777586651449774]], internalEdges={}, holes=[]}]}, GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.9975360448095447, lon=-1.947231901773322], [lat=1.0804215040880678, lon=-2.120999400452007], [lat=0.8759401563733757, lon=-2.0560515158834556]], internalEdges={2}, holes=[]}, GeoConcavePolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.9975360448095447, lon=-1.947231901773322], [lat=0.8759401563733757, lon=-2.0560515158834556], [lat=1.0593274653908336, lon=-1.9878461917050225]], internalEdges={0}, holes=[]}]}]}, GeoConcavePolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.8467492502622816, lon=1.0798875031514328], [lat=-0.14706304488488503, lon=2.5605745305340144], [lat=-0.8532322566987428, lon=-2.8534929144969876], [lat=-0.9594629553682933, lon=-2.2151935508754383]], internalEdges={0, 2}, holes=[GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=1.5066843301617248, lon=0.8615401840455207], [lat=1.0964870141435539, lon=2.5943881214521642], [lat=-0.8070142540769046, lon=-0.5601543821665136]], internalEdges={}, holes=[]}]}, GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=1.254943600040169, lon=-2.455701672749609], [lat=0.8399838756142208, lon=-0.6197091219150923], [lat=0.6595204508888761, lon=-0.0777586651449774]], internalEdges={}, holes=[]}]}, GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.9975360448095447, lon=-1.947231901773322], [lat=1.0804215040880678, lon=-2.120999400452007], [lat=0.8759401563733757, lon=-2.0560515158834556]], internalEdges={2}, holes=[]}, GeoConcavePolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.9975360448095447, lon=-1.947231901773322], [lat=0.8759401563733757, lon=-2.0560515158834556], [lat=1.0593274653908336, lon=-1.9878461917050225]], internalEdges={0}, holes=[]}]}]}]}\n   [smoker]    [junit4]    >   point=[X=-0.20200947969927532, Y=-0.4709330291599749, Z=0.8571474154523655]\n   [smoker]    [junit4]    >   docID=7962 deleted?=false\n   [smoker]    [junit4]    >   query=PointInGeo3DShapeQuery: field=point: Shape: GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=-0.8532322566987428, lon=-2.8534929144969876], [lat=0.7742755548509384, lon=1.4555370543705286], [lat=-0.8402448215271041, lon=-3.1033465832913087]], internalEdges={2}, holes=[GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=1.5066843301617248, lon=0.8615401840455207], [lat=1.0964870141435539, lon=2.5943881214521642], [lat=-0.8070142540769046, lon=-0.5601543821665136]], internalEdges={}, holes=[]}]}, GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=1.254943600040169, lon=-2.455701672749609], [lat=0.8399838756142208, lon=-0.6197091219150923], [lat=0.6595204508888761, lon=-0.0777586651449774]], internalEdges={}, holes=[]}]}, GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.9975360448095447, lon=-1.947231901773322], [lat=1.0804215040880678, lon=-2.120999400452007], [lat=0.8759401563733757, lon=-2.0560515158834556]], internalEdges={2}, holes=[]}, GeoConcavePolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.9975360448095447, lon=-1.947231901773322], [lat=0.8759401563733757, lon=-2.0560515158834556], [lat=1.0593274653908336, lon=-1.9878461917050225]], internalEdges={0}, holes=[]}]}]}, GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=-0.8402448215271041, lon=-3.1033465832913087], [lat=-0.27564487296038953, lon=2.5713811980617303], [lat=-0.8678809123816704, lon=1.4382377289499255]], internalEdges={2}, holes=[GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=1.5066843301617248, lon=0.8615401840455207], [lat=1.0964870141435539, lon=2.5943881214521642], [lat=-0.8070142540769046, lon=-0.5601543821665136]], internalEdges={}, holes=[]}]}, GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=1.254943600040169, lon=-2.455701672749609], [lat=0.8399838756142208, lon=-0.6197091219150923], [lat=0.6595204508888761, lon=-0.0777586651449774]], internalEdges={}, holes=[]}]}, GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.9975360448095447, lon=-1.947231901773322], [lat=1.0804215040880678, lon=-2.120999400452007], [lat=0.8759401563733757, lon=-2.0560515158834556]], internalEdges={2}, holes=[]}, GeoConcavePolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.9975360448095447, lon=-1.947231901773322], [lat=0.8759401563733757, lon=-2.0560515158834556], [lat=1.0593274653908336, lon=-1.9878461917050225]], internalEdges={0}, holes=[]}]}]}, GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.8467492502622816, lon=1.0798875031514328], [lat=-0.8711205032246575, lon=-2.816839332961], [lat=-0.14706304488488503, lon=2.5605745305340144]], internalEdges={2}, holes=[GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=1.5066843301617248, lon=0.8615401840455207], [lat=1.0964870141435539, lon=2.5943881214521642], [lat=-0.8070142540769046, lon=-0.5601543821665136]], internalEdges={}, holes=[]}]}, GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=1.254943600040169, lon=-2.455701672749609], [lat=0.8399838756142208, lon=-0.6197091219150923], [lat=0.6595204508888761, lon=-0.0777586651449774]], internalEdges={}, holes=[]}]}, GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.9975360448095447, lon=-1.947231901773322], [lat=1.0804215040880678, lon=-2.120999400452007], [lat=0.8759401563733757, lon=-2.0560515158834556]], internalEdges={2}, holes=[]}, GeoConcavePolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.9975360448095447, lon=-1.947231901773322], [lat=0.8759401563733757, lon=-2.0560515158834556], [lat=1.0593274653908336, lon=-1.9878461917050225]], internalEdges={0}, holes=[]}]}]}, GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=-0.8532322566987428, lon=-2.8534929144969876], [lat=-0.8402448215271041, lon=-3.1033465832913087], [lat=-0.8678809123816704, lon=1.4382377289499255], [lat=0.018587409980192347, lon=0.2620880396809507], [lat=-0.9594629553682933, lon=-2.2151935508754383]], internalEdges={0, 1, 4}, holes=[GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=1.5066843301617248, lon=0.8615401840455207], [lat=1.0964870141435539, lon=2.5943881214521642], [lat=-0.8070142540769046, lon=-0.5601543821665136]], internalEdges={}, holes=[]}]}, GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=1.254943600040169, lon=-2.455701672749609], [lat=0.8399838756142208, lon=-0.6197091219150923], [lat=0.6595204508888761, lon=-0.0777586651449774]], internalEdges={}, holes=[]}]}, GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.9975360448095447, lon=-1.947231901773322], [lat=1.0804215040880678, lon=-2.120999400452007], [lat=0.8759401563733757, lon=-2.0560515158834556]], internalEdges={2}, holes=[]}, GeoConcavePolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.9975360448095447, lon=-1.947231901773322], [lat=0.8759401563733757, lon=-2.0560515158834556], [lat=1.0593274653908336, lon=-1.9878461917050225]], internalEdges={0}, holes=[]}]}]}, GeoConcavePolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.8467492502622816, lon=1.0798875031514328], [lat=-0.14706304488488503, lon=2.5605745305340144], [lat=-0.8532322566987428, lon=-2.8534929144969876], [lat=-0.9594629553682933, lon=-2.2151935508754383]], internalEdges={0, 2}, holes=[GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=1.5066843301617248, lon=0.8615401840455207], [lat=1.0964870141435539, lon=2.5943881214521642], [lat=-0.8070142540769046, lon=-0.5601543821665136]], internalEdges={}, holes=[]}]}, GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=1.254943600040169, lon=-2.455701672749609], [lat=0.8399838756142208, lon=-0.6197091219150923], [lat=0.6595204508888761, lon=-0.0777586651449774]], internalEdges={}, holes=[]}]}, GeoCompositeMembershipShape: {[GeoConvexPolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.9975360448095447, lon=-1.947231901773322], [lat=1.0804215040880678, lon=-2.120999400452007], [lat=0.8759401563733757, lon=-2.0560515158834556]], internalEdges={2}, holes=[]}, GeoConcavePolygon: {planetmodel=PlanetModel.WGS84, points=[[lat=0.9975360448095447, lon=-1.947231901773322], [lat=0.8759401563733757, lon=-2.0560515158834556], [lat=1.0593274653908336, lon=-1.9878461917050225]], internalEdges={0}, holes=[]}]}]}]}\n   [smoker]    [junit4]    >   explanation:\n   [smoker]    [junit4]    >     target is in leaf _1(6.1.0):C20016 of full reader StandardDirectoryReader(segments:5:nrt _1(6.1.0):C20016)\n   [smoker]    [junit4]    >     full BKD path to target doc:\n   [smoker]    [junit4]    >       Cell(x=-1.0010902294672446 TO -0.7975667675246342 y=-1.0007728907882345 TO -0.0014295405465486804 z=-0.9977622808698339 TO -0.011972722577672528); Shape relationship = DISJOINT; Point within cell = false; Point within shape = true\n   [smoker]    [junit4]    >       Cell(x=-0.7975667679908164 TO -0.6330869556787622 y=-1.0007728907882345 TO -0.0014295405465486804 z=-0.9977622808698339 TO -0.011972722577672528); Shape relationship = OVERLAPS; Point within cell = false; Point within shape = true\n   [smoker]    [junit4]    >       Cell(x=-1.0010902294672446 TO -0.6330869556787622 y=-1.0007728907882345 TO -0.0014295405465486804 z=-0.01197272304385482 TO 0.35595394953475784); Shape relationship = DISJOINT; Point within cell = false; Point within shape = true\n   [smoker]    [junit4]    >       Cell(x=-1.0010902294672446 TO -0.6330869556787622 y=-1.0007728907882345 TO -0.0014295405465486804 z=0.3559539490685756 TO 0.9977622920582089); Shape relationship = DISJOINT; Point within cell = false; Point within shape = true\n   [smoker]    [junit4]    >       Cell(x=-0.6330869561449444 TO -0.3492819569300436 y=-1.0007728907882345 TO -0.0014295405465486804 z=-0.9977622808698339 TO -0.6956355809209895); Shape relationship = OVERLAPS; Point within cell = false; Point within shape = true\n   [smoker]    [junit4]    >       Cell(x=-0.6330869561449444 TO -0.3492819569300436 y=-1.0007728907882345 TO -0.0014295405465486804 z=-0.6956355813871717 TO 0.10900276736191666); Shape relationship = DISJOINT; Point within cell = false; Point within shape = true\n   [smoker]    [junit4]    >       Cell(x=-0.6330869561449444 TO -0.3492819569300436 y=-1.0007728907882345 TO -0.0014295405465486804 z=0.10900276689573439 TO 0.7189540192817846); Shape relationship = DISJOINT; Point within cell = false; Point within shape = true\n   [smoker]    [junit4]    >       Cell(x=-0.6330869561449444 TO -0.3492819569300436 y=-1.0007728907882345 TO -0.0014295405465486804 z=0.7189540188156024 TO 0.9977622920582089); Shape relationship = DISJOINT; Point within cell = false; Point within shape = true\n   [smoker]    [junit4]    >       Cell(x=-0.3492819573962258 TO 0.006012160982458459 y=-1.0007728907882345 TO -0.68605594687831 z=-0.9977622808698339 TO -0.0069162292381555225); Shape relationship = DISJOINT; Point within cell = false; Point within shape = true\n   [smoker]    [junit4]    >       Cell(x=-0.3492819573962258 TO 0.006012160982458459 y=-0.6860559473444922 TO -0.32059454789968617 z=-0.9977622808698339 TO -0.0069162292381555225); Shape relationship = OVERLAPS; Point within cell = false; Point within shape = true\n   [smoker]    [junit4]    >       Cell(x=-0.3492819573962258 TO 0.006012160982458459 y=-1.0007728907882345 TO -0.32059454789968617 z=-0.006916229704337817 TO 0.6718162758370178); Shape relationship = DISJOINT; Point within cell = false; Point within shape = true\n   [smoker]    [junit4]    >       Cell(x=-0.3492819573962258 TO 0.006012160982458459 y=-1.0007728907882345 TO -0.32059454789968617 z=0.6718162753708355 TO 0.9977622920582089); Shape relationship = DISJOINT; Point within cell = true; Point within shape = true\n   [smoker]    [junit4]    >     on cell Cell(x=-1.0010902294672446 TO -0.7975667675246342 y=-1.0007728907882345 TO -0.0014295405465486804 z=-0.9977622808698339 TO -0.011972722577672528); Shape relationship = DISJOINT; Point within cell = false; Point within shape = true, wrapped visitor returned CELL_OUTSIDE_QUERY  on cell Cell(x=-0.7975667679908164 TO -0.6330869556787622 y=-1.0007728907882345 TO -0.0014295405465486804 z=-0.9977622808698339 TO -0.011972722577672528); Shape relationship = OVERLAPS; Point within cell = false; Point within shape = true, wrapped visitor returned CELL_CROSSES_QUERY\n   [smoker]    [junit4]    > \tat __randomizedtesting.SeedInfo.seed([AB1C87AA82F2EF89:16C2B002C3978CEF]:0)\n   [smoker]    [junit4]    > \tat org.apache.lucene.spatial3d.TestGeo3DPoint.verify(TestGeo3DPoint.java:796)\n   [smoker]    [junit4]    > \tat org.apache.lucene.spatial3d.TestGeo3DPoint.doTestRandom(TestGeo3DPoint.java:518)\n   [smoker]    [junit4]    > \tat org.apache.lucene.spatial3d.TestGeo3DPoint.testRandomMedium(TestGeo3DPoint.java:445)\n   [smoker]    [junit4]    > \tat java.lang.Thread.run(Thread.java:745)\n   [smoker]    [junit4]   2> NOTE: test params are: codec=Asserting(Lucene60): {id=Lucene50(blocksize=128)}, docValues:{id=DocValuesFormat(name=Memory)}, maxPointsInLeafNode=421, maxMBSortInHeap=6.865543172299073, sim=ClassicSimilarity, locale=es-VE, timezone=Africa/Niamey\n   [smoker]    [junit4]   2> NOTE: Linux 3.13.0-52-generic amd64/Oracle Corporation 1.8.0_74 (64-bit)/cpus=4,threads=1,free=292169440,total=351797248\n   [smoker]    [junit4]   2> NOTE: All tests run in this JVM: [TestGeo3DPoint]\n\n "
        },
        {
            "id": "comment-15233500",
            "author": "Karl Wright",
            "date": "2016-04-09T11:08:08+0000",
            "content": "Looking at the first failure, I have a simple unit test that demonstrates it, with some forensics in place:\n\n\n   [junit4] Suite: org.apache.lucene.spatial3d.geom.GeoPolygonTest\n   [junit4]   2>  Edge point [X=0.17319681511746315, Y=0.007099080851812687, Z=0.9826918170382273] path.isWithin()? false\n   [junit4]   2>  Edge point [X=-0.17319681511746315, Y=0.007099080851812687, Z=0.9826918170382273] path.isWithin()? false\n   [junit4]   2>  Edge point [X=0.08178122448583161, Y=0.007099080851812687, Z=0.9944024015823575] path.isWithin()? false\n   [junit4]   2>  Edge point [X=-0.08178122448583161, Y=0.007099080851812687, Z=0.9944024015823575] path.isWithin()? false\n   [junit4]   2>  Edge point [X=-0.17334224446387358, Y=0.0, Z=0.9826918170382273] path.isWithin()? false\n   [junit4]   2>  Edge point [X=-0.08208876675491342, Y=0.0, Z=0.9944024015823575] path.isWithin()? false\n   [junit4]   2>  path edge point [lat=0.022713796927720124, lon=-0.5815768716211268] isWithin()? false minx=1.837423958880354 maxx=-0.16451112733444273 miny=0.4509495179589238 maxy=-0.5569131482163469 minz=-0.9599546014156208 maxz=-0.9716651859597512\n   [junit4] FAILURE 0.04s | GeoPolygonTest.testPolygonFactoryCase2 <<<\n   [junit4]    > Throwable #1: java.lang.AssertionError\n   [junit4]    > \tat org.apache.lucene.spatial3d.geom.GeoPolygonTest.testPolygonFactoryCase2(GeoPolygonTest.java:480)\n\n\n\nBasically what this means is that nothing seems to be inside anything else \u2013 and yet there are no edge intersections anywhere either.  I'm wondering if this is a result of granularity?  Theoretically, it is possible for a point that is not on the surface to be inside an XYZSolid and come up as inside the shape as well, even if there is no overlap between the solid and the surface shape, because the shape is described by planes that go through the center of the earth and are therefore not perpendicular to the XYZSolid's boundaries.\n\nIt does seem odd that all failures we've seen have been for very complex polygons, though.  I'll verify that all polygon edges that should be checked for intersection actually are being checked before resorting to that explanation. "
        },
        {
            "id": "comment-15233506",
            "author": "Karl Wright",
            "date": "2016-04-09T11:36:24+0000",
            "content": "I verified that the shape appears to be properly built, with the right internal edges, and that when looking for edge intersections it examines the correct number and type of edges.  The last thing to verify is whether the edge points for the XYZSolid are correct. "
        },
        {
            "id": "comment-15233521",
            "author": "Karl Wright",
            "date": "2016-04-09T12:12:18+0000",
            "content": "Some diagnostics from the XYZSolid:\n\n\n   [junit4]   2>  notableMinXPoints=[] notableMaxXPoints=[] notableMinYPoints=[] notableMaxYPoints=[[X=0.17319681511746315, Y=0.007099080851812687, Z=0.9826918170382273], [X=-0.17319681511746315, Y=0.007099080851812687, Z=0.9826918170382273], [X=0.08178122448583161, Y=0.007099080851812687, Z=0.9944024015823575], [X=-0.08178122448583161, Y=0.007099080851812687, Z=0.9944024015823575]] notableMinZPoints=[[X=0.17319681511746315, Y=0.007099080851812687, Z=0.9826918170382273], [X=-0.17319681511746315, Y=0.007099080851812687, Z=0.9826918170382273]] notableMaxZPoints=[[X=0.08178122448583161, Y=0.007099080851812687, Z=0.9944024015823575], [X=-0.08178122448583161, Y=0.007099080851812687, Z=0.9944024015823575]]\n   [junit4]   2> Outside world: minXminYminZ=true minXminYmaxZ=true minXmaxYminZ=true minXmaxYmaxZ=true maxXminYminZ=true maxXminYmaxZ=true maxXmaxYminZ=true maxXmaxYmaxZ=true\n   [junit4]   2>  minXEdges=[] maxXEdges=[] minYEdges=[] maxYEdges=[] minZEdges=[[X=-0.17334224446387358, Y=0.0, Z=0.9826918170382273]] maxZEdges=[[X=-0.08208876675491342, Y=0.0, Z=0.9944024015823575]]\n\n\n\nDigested:\n(1) All corners of the solid are outside the world.  This means we'll need to look at the secondary logic that handles this case, which is \"minXEdges...\" output above.\n(2) There are no direct intersections with the world for the minX, maxX, and minY planes.  The other planes have intersections, typically two, but the maxY intersection has four.\n(3) The XYZSolid is a thin horizontal slice, unbounded on all sides except maxY.\n\nAs before stated, it is possible that the point is in the shape AND in the xyzsolid BUT there is no intersection between the two.  Since this is a polygon, I can verify that setup by simply projecting the point onto the surface by scaling its x,y,z values.  If the point is then within the shape but NOT within the XYZSolid, then we've verified the scenario I've described.\n\n "
        },
        {
            "id": "comment-15233540",
            "author": "Karl Wright",
            "date": "2016-04-09T13:12:59+0000",
            "content": "Added more diagnostics to figure out if scaling the point to the surface would result in it leaving the cell.  Short answer: no:\n\n\n   [junit4]    >       Cell(x=-1.0011088352687925 TO 1.0008262509460042 y=-1.000763585323458 TO 0.007099080851812687 z=0.9826918170382273 TO 0.9944024015823575); Shape relationship = DISJOINT; Point within cell = true; Point within shape = true; Scaled point within cell = true; Scaled point within shape = true\n\n\n\nSo something is definitely wrong with the intersection logic, but I'm not yet clear what that is. "
        },
        {
            "id": "comment-15233620",
            "author": "Karl Wright",
            "date": "2016-04-09T16:27:50+0000",
            "content": "When trying to figure out which part of the five polygon tiles that the point was in, I discovered something odd about this poly:\n\n\n   [junit4]   2> Is point within p1 section? false\n   [junit4]   2> Is point within p2 section? true\n   [junit4]   2> Is point within p3 section? false\n   [junit4]   2> Is point within concave section? false\n   [junit4]   2> Is point within p5 section? true\n\n\n\nThe point is within TWO parts of the composite polygon.  This is, of course, nonsense unless the point happens to be on a shared edge between the two.  But these two don't even share an edge.\n\nI'm forced to conclude that the polygon itself is broken in some subtle way that is undetected at the time the poly is being constructed.  I'll look at that next. "
        },
        {
            "id": "comment-15233709",
            "author": "Karl Wright",
            "date": "2016-04-09T20:10:41+0000",
            "content": "Ok, found the problem.  Cut and paste error in complex polygon building.  Resolves the first problem, confirming the second. "
        },
        {
            "id": "comment-15233711",
            "author": "ASF subversion and git services",
            "date": "2016-04-09T20:12:59+0000",
            "content": "Commit d377e7fd34b4ace829ee6d4ba0486500aaef506b in lucene-solr's branch refs/heads/master from Karl Wright\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=d377e7f ]\n\nLUCENE-7197: Fix two test failures and add more forensics that helped resolve the issue. "
        },
        {
            "id": "comment-15233712",
            "author": "ASF subversion and git services",
            "date": "2016-04-09T20:17:05+0000",
            "content": "Commit 65a69b9757a6cd0a8e8be0ed08797643054634b1 in lucene-solr's branch refs/heads/branch_6x from Karl Wright\n[ https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=65a69b9 ]\n\nLUCENE-7197: Fix two test failures and add more forensics that helped resolve the issue. "
        }
    ]
}