{
    "id": "SOLR-2311",
    "title": "FileListEntityProcessor Fields Stored in SolrDocument do not Match Documentation",
    "details": {
        "affect_versions": "1.4.1",
        "status": "Open",
        "fix_versions": [],
        "components": [
            "contrib - DataImportHandler"
        ],
        "type": "Bug",
        "priority": "Minor",
        "labels": "",
        "resolution": "Unresolved"
    },
    "description": "The implicit fields generated by the FileListEntityProcessor do not match the documentation, which are listed in the following excerpt:\n\n The implicit fields generated by the FileListEntityProcessor are \nfileAbsolutePath, fileSize, fileLastModified, fileName and these are available \nfor use within the entity X as shown above. \n\nThe fileName field is not populated. The file's name is stored in the implicit field named file.\n\nThe hashmap that holds the metadata is (FileListEntityProcessor.java at line 255)\nstored the following using the associated constants:\n\n\n    details.put(DIR, dir.getAbsolutePath());\n    details.put(FILE, name);\n    details.put(ABSOLUTE_FILE, aFile.getAbsolutePath());\n    details.put(SIZE, sz);\n    details.put(LAST_MODIFIED, lastModified);\n\nwhere DIR = \"fileDir\", FILE = \"file\", ABSOLUTE_FILE = \"fileAbsolutePath\", SIZE = \"fileSize\", and LAST_MODIFIED = \"fileLastModified\".\n\nEither the documentation must be updated, or the constant storing the return value must be updated.",
    "attachments": {
        "SOLR-2311.patch": "https://issues.apache.org/jira/secure/attachment/12468096/SOLR-2311.patch"
    },
    "issue_links": {},
    "comments": [
        {
            "author": "Matt Parker",
            "id": "comment-12980471",
            "date": "2011-01-12T00:46:07+0000",
            "content": "Added fileDir to the list of implicit fields listed on the Wiki. "
        },
        {
            "author": "Matt Parker",
            "id": "comment-12980514",
            "date": "2011-01-12T02:23:05+0000",
            "content": "Changed attribute mapping in FileListEntityProcessor, and added JUnit test case. "
        },
        {
            "author": "Koji Sekiguchi",
            "id": "comment-12981271",
            "date": "2011-01-13T14:43:22+0000",
            "content": "Thank you for reporting this, Matt!\n\nFor back-compat reasons, your patch:\n\n\n@@ -254,7 +254,7 @@\n     if (newerThan != null && lastModified.before(newerThan))\n       return;\n     details.put(DIR, dir.getAbsolutePath());\n-    details.put(FILE, name);\n+    details.put(FILE_NAME, name);\n     details.put(ABSOLUTE_FILE, aFile.getAbsolutePath());\n     details.put(SIZE, sz);\n     details.put(LAST_MODIFIED, lastModified);\n\n\n\nshould be:\n\n\n@@ -254,7 +254,7 @@\n     if (newerThan != null && lastModified.before(newerThan))\n       return;\n     details.put(DIR, dir.getAbsolutePath());\n     details.put(FILE, name);\n+    details.put(FILE_NAME, name);\n     details.put(ABSOLUTE_FILE, aFile.getAbsolutePath());\n     details.put(SIZE, sz);\n     details.put(LAST_MODIFIED, lastModified);\n\n\n\nBut IMO updating documentation is enough in this case. "
        },
        {
            "author": "Matt Parker",
            "id": "comment-12981558",
            "date": "2011-01-13T23:43:46+0000",
            "content": "I'm not sure I agree. \n\nI thought the change would improve the code's clarity. File is actually a misnomer to what is captured in the field. Filename would be more appropriate. \n\nAlso, I thought the test case I wrote would have been of value and worth including.\n\nRegardless of whether it's accepted, the documentation needs to be changed to reflect whatever you decide to implement. "
        }
    ]
}