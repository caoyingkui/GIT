{
    "id": "SOLR-10820",
    "title": "Solr Replica is down with java.nio.file.NoSuchFileException Exception in the logs",
    "details": {
        "labels": "",
        "priority": "Major",
        "components": [],
        "type": "Bug",
        "fix_versions": [],
        "affect_versions": "None",
        "resolution": "Invalid",
        "status": "Resolved"
    },
    "description": "The whole Solr cluster is not responding, the Solr Admin UI is hung and the basic home page also does not show up.\n\nWe see the following exception in the Solr.log file\n\njava.nio.file.NoSuchFileException: /app/solrdata6/data/node-instances_shard1_replica1/data/index/segments_1\n        at sun.nio.fs.UnixException.translateToIOException(UnixException.java:86)\n        at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:102)\n        at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:107)\n        at sun.nio.fs.UnixFileAttributeViews$Basic.readAttributes(UnixFileAttributeViews.java:55)\n        at sun.nio.fs.UnixFileSystemProvider.readAttributes(UnixFileSystemProvider.java:144)\n        at sun.nio.fs.LinuxFileSystemProvider.readAttributes(LinuxFileSystemProvider.java:99)\n        at java.nio.file.Files.readAttributes(Files.java:1737)\n        at java.nio.file.Files.size(Files.java:2332)\n        at org.apache.lucene.store.FSDirectory.fileLength(FSDirectory.java:243)\n        at org.apache.lucene.store.NRTCachingDirectory.fileLength(NRTCachingDirectory.java:128)\n        at org.apache.solr.handler.admin.LukeRequestHandler.getFileLength(LukeRequestHandler.java:598)\n        at org.apache.solr.handler.admin.LukeRequestHandler.getIndexInfo(LukeRequestHandler.java:586)\n        at org.apache.solr.handler.admin.CoreAdminOperation.getCoreStatus(CoreAdminOperation.java:342)\n        at org.apache.solr.handler.admin.StatusOp.execute(StatusOp.java:48)\n        at org.apache.solr.handler.admin.CoreAdminOperation.execute(CoreAdminOperation.java:377)\n        at org.apache.solr.handler.admin.CoreAdminHandler$CallInfo.call(CoreAdminHandler.java:365)\n        at org.apache.solr.handler.admin.CoreAdminHandler.handleRequestBody(CoreAdminHandler.java:156)\n        at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:153)\n        at org.apache.solr.servlet.HttpSolrCall.handleAdminRequest(HttpSolrCall.java:660)\n        at org.apache.solr.servlet.HttpSolrCall.call(HttpSolrCall.java:441)\n        at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:303)\n        at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:254)\n        at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1668)\n        at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:581)\n        at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)\n        at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:548)\n        at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:226)\n        at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1160)\n        at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:511)\n        at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)\n        at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1092)\n        at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)\n        at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:213)\n        at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:119)\n        at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:134)\n        at org.eclipse.jetty.server.Server.handle(Server.java:518)\n        at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:308)\n        at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:244)\n        at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:273)\n        at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:95)\n        at org.eclipse.jetty.io.SelectChannelEndPoint$2.run(SelectChannelEndPoint.java:93)\n        at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.produceAndRun(ExecuteProduceConsume.java:246)\n        at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.run(ExecuteProduceConsume.java:156)\n        at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:654)\n        at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:572)\n        at java.lang.Thread.run(Thread.java:745)\n\nUPDATE1\n----------------------------------------------------------------------------------------\nThis happened after we deleted the collection and re-created the Collection in Solr.  We were not even able to get to the UI to be able to delete the collection. But some how we were able to delete the collection using the Collections REST API and repeatedly invoking it.\n\nNow after creating the new Collection we started seeing the above Error messages in the logs.",
    "attachments": {},
    "issue_links": {},
    "comments": [
        {
            "date": "2017-06-05T23:31:59+0000",
            "content": "This is not a support portal, please raise this question on the user's list at solr-user@lucene.apache.org, see: (http://lucene.apache.org/solr/community.html#mailing-lists-irc) there are a lot more people watching that list who may be able to help. \n\nIf it's determined that this is a code issue in Solr and not a configuration/usage problem, we can raise a JIRA. ",
            "author": "Erick Erickson",
            "id": "comment-16037839"
        }
    ]
}