{
    "id": "SOLR-6762",
    "title": "bin/solr create_collection not working due to not finding configName but the configSet exists",
    "details": {
        "components": [],
        "type": "Bug",
        "labels": "",
        "fix_versions": [
            "5.0"
        ],
        "affect_versions": "None",
        "status": "Closed",
        "resolution": "Fixed",
        "priority": "Major"
    },
    "description": "On trunk, when doing:\n\nbin/solr create_collection -n foo2 -c sample_techproducts_configs\n\nThe collection cannot be created because of:\n\nConnecting to ZooKeeper at localhost:9983\nUploading /Users/timpotter/dev/lw/projects/solr_trunk_co/solr/server/solr/configsets/sample_techproducts_configs/conf for config sample_techproducts_configs to ZooKeeper at localhost:9983\nCreating new collection 'foo2' using command:\n\nhttp://192.168.1.2:7574/solr/admin/collections?action=CREATE&name=foo2&numShards=1&replicationFactor=1&maxShardsPerNode=1&configSet=sample_techproducts_configs\n\n{\n  \"responseHeader\":\n{\n    \"status\":0,\n    \"QTime\":16121}\n,\n  \"failure\":{\"\":\"org.apache.solr.client.solrj.impl.HttpSolrServer$RemoteSolrException:Error CREATEing SolrCore 'foo2_shard1_replica1': Unable to create core [foo2_shard1_replica1] Caused by: Could not find configName for collection foo2 found:[data_driven_schema_configs, sample_techproducts_configs]\"}}\n\nThe bin/solr create_collection command uploads the sample_techproducts_configs configset but the create collection seems to require the configName instead.\n\nLogs:\n\nINFO  - 2014-11-19 16:14:38.001; org.apache.solr.cloud.OverseerCollectionProcessor; Overseer Collection Processor: Get the message id:/overseer/collection-queue-work/qn-0000000014 message:\n{\n  \"operation\":\"create\",\n  \"fromApi\":\"true\",\n  \"name\":\"foo2\",\n  \"replicationFactor\":\"1\",\n  \"numShards\":\"1\",\n  \"maxShardsPerNode\":\"1\"}\nWARN  - 2014-11-19 16:14:38.002; org.apache.solr.cloud.OverseerCollectionProcessor; OverseerCollectionProcessor.processMessage : create , \n{\n  \"operation\":\"create\",\n  \"fromApi\":\"true\",\n  \"name\":\"foo2\",\n  \"replicationFactor\":\"1\",\n  \"numShards\":\"1\",\n  \"maxShardsPerNode\":\"1\"}\nWARN  - 2014-11-19 16:14:38.002; org.apache.solr.cloud.OverseerCollectionProcessor; Could not obtain config name\nINFO  - 2014-11-19 16:14:38.003; org.apache.solr.cloud.DistributedQueue$LatchWatcher; NodeChildrenChanged fired on path /overseer/queue state SyncConnected\nINFO  - 2014-11-19 16:14:38.004; org.apache.solr.cloud.Overseer$ClusterStateUpdater; building a new collection: foo2\nINFO  - 2014-11-19 16:14:38.004; org.apache.solr.cloud.Overseer$ClusterStateUpdater; Create collection foo2 with shards [shard1]\nINFO  - 2014-11-19 16:14:38.004; org.apache.solr.cloud.Overseer$ClusterStateUpdater; state version foo2 1\nINFO  - 2014-11-19 16:14:38.006; org.apache.solr.common.cloud.ZkStateReader$2; A cluster state change: WatchedEvent state:SyncConnected type:NodeDataChanged path:/clusterstate.json, has occurred - updating... (live nodes size: 2)\nINFO  - 2014-11-19 16:14:38.103; org.apache.solr.cloud.OverseerCollectionProcessor; Creating SolrCores for new collection foo2, shardNames [shard1] , replicationFactor : 1\nINFO  - 2014-11-19 16:14:38.103; org.apache.solr.cloud.OverseerCollectionProcessor; Creating shard foo2_shard1_replica1 as part of slice shard1 of collection foo2 on 192.168.1.2:8983_solr\nINFO  - 2014-11-19 16:14:38.106; org.apache.solr.handler.admin.CoreAdminHandler; core create command numShards=1&shard=shard1&name=foo2_shard1_replica1&action=CREATE&collection=foo2&wt=javabin&qt=/admin/cores&version=2\nINFO  - 2014-11-19 16:14:38.107; org.apache.solr.cloud.ZkController; publishing core=foo2_shard1_replica1 state=down collection=foo2\nINFO  - 2014-11-19 16:14:38.108; org.apache.solr.cloud.ZkController; look for our core node name\nINFO  - 2014-11-19 16:14:38.108; org.apache.solr.cloud.DistributedQueue$LatchWatcher; NodeChildrenChanged fired on path /overseer/queue state SyncConnected\nINFO  - 2014-11-19 16:14:38.109; org.apache.solr.cloud.Overseer$ClusterStateUpdater; Update state numShards=1 message=\n{\n  \"operation\":\"state\",\n  \"numShards\":\"1\",\n  \"shard\":\"shard1\",\n  \"roles\":null,\n  \"state\":\"down\",\n  \"core\":\"foo2_shard1_replica1\",\n  \"collection\":\"foo2\",\n  \"node_name\":\"192.168.1.2:8983_solr\",\n  \"base_url\":\"http://192.168.1.2:8983/solr\"}\nINFO  - 2014-11-19 16:14:38.211; org.apache.solr.common.cloud.ZkStateReader$2; A cluster state change: WatchedEvent state:SyncConnected type:NodeDataChanged path:/clusterstate.json, has occurred - updating... (live nodes size: 2)\nINFO  - 2014-11-19 16:14:39.108; org.apache.solr.cloud.ZkController; waiting to find shard id in clusterstate for foo2_shard1_replica1\nINFO  - 2014-11-19 16:14:39.108; org.apache.solr.cloud.ZkController; Check for collection zkNode:foo2\nINFO  - 2014-11-19 16:14:39.109; org.apache.solr.cloud.ZkController; Creating collection in ZooKeeper:foo2\nINFO  - 2014-11-19 16:14:39.109; org.apache.solr.cloud.ZkController; Looking for collection configName\nINFO  - 2014-11-19 16:14:39.109; org.apache.solr.cloud.ZkController; Could not find collection configName - pausing for 3 seconds and trying again - try: 1\nINFO  - 2014-11-19 16:14:42.109; org.apache.solr.cloud.ZkController; Could not find collection configName - pausing for 3 seconds and trying again - try: 2\nINFO  - 2014-11-19 16:14:45.110; org.apache.solr.cloud.ZkController; Could not find collection configName - pausing for 3 seconds and trying again - try: 3\nINFO  - 2014-11-19 16:14:48.110; org.apache.solr.cloud.ZkController; Could not find collection configName - pausing for 3 seconds and trying again - try: 4\nINFO  - 2014-11-19 16:14:51.111; org.apache.solr.cloud.ZkController; Could not find collection configName - pausing for 3 seconds and trying again - try: 5\nERROR - 2014-11-19 16:14:54.111; org.apache.solr.cloud.ZkController; Could not find configName for collection foo2\nERROR - 2014-11-19 16:14:54.112; org.apache.solr.core.CoreContainer; Error creating core [foo2_shard1_replica1]: Could not find configName for collection foo2 found:[data_driven_schema_configs, sample_techproducts_configs]\norg.apache.solr.common.cloud.ZooKeeperException: Could not find configName for collection foo2 found:[data_driven_schema_configs, sample_techproducts_configs]\n        at org.apache.solr.cloud.ZkController.getConfName(ZkController.java:1380)\n        at org.apache.solr.cloud.ZkController.createCollectionZkNode(ZkController.java:1283)\n        at org.apache.solr.cloud.CloudConfigSetService.createCoreResourceLoader(CloudConfigSetService.java:36)\n        at org.apache.solr.core.ConfigSetService.getConfig(ConfigSetService.java:58)\n        at org.apache.solr.core.CoreContainer.create(CoreContainer.java:508)\n        at org.apache.solr.core.CoreContainer.create(CoreContainer.java:485)\n        at org.apache.solr.handler.admin.CoreAdminHandler.handleCreateAction(CoreAdminHandler.java:575)\n        at org.apache.solr.handler.admin.CoreAdminHandler.handleRequestInternal(CoreAdminHandler.java:199)\n        at org.apache.solr.handler.admin.CoreAdminHandler.handleRequestBody(CoreAdminHandler.java:188)\n        at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:136)\n        at org.apache.solr.servlet.SolrDispatchFilter.handleAdminRequest(SolrDispatchFilter.java:736)\n        at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:253)\n        at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:202)\n        at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1419)\n        at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:455)\n        at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:137)\n        at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:557)\n        at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:231)\n        at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1075)\n        at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:384)\n        at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:193)\n        at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1009)\n        at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:135)\n        at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:255)\n        at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:154)\n        at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:116)\n        at org.eclipse.jetty.server.Server.handle(Server.java:368)\n        at org.eclipse.jetty.server.AbstractHttpConnection.handleRequest(AbstractHttpConnection.java:489)\n        at org.eclipse.jetty.server.BlockingHttpConnection.handleRequest(BlockingHttpConnection.java:53)\n        at org.eclipse.jetty.server.AbstractHttpConnection.content(AbstractHttpConnection.java:953)\n        at org.eclipse.jetty.server.AbstractHttpConnection$RequestHandler.content(AbstractHttpConnection.java:1014)\n        at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:861)\n        at org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:240)\n        at org.eclipse.jetty.server.BlockingHttpConnection.handle(BlockingHttpConnection.java:72)\n        at org.eclipse.jetty.server.bio.SocketConnector$ConnectorEndPoint.run(SocketConnector.java:264)\n        at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:608)\n        at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:543)\n        at java.lang.Thread.run(Thread.java:745)\nINFO  - 2014-11-19 16:14:54.115; org.apache.solr.cloud.DistributedQueue$LatchWatcher; NodeChildrenChanged fired on path /overseer/queue state SyncConnected\nERROR - 2014-11-19 16:14:54.115; org.apache.solr.common.SolrException; org.apache.solr.common.SolrException: Error CREATEing SolrCore 'foo2_shard1_replica1': Unable to create core [foo2_shard1_replica1] Caused by: Could not find configName for collection foo2 found:[data_driven_schema_configs, sample_techproducts_configs]\n        at org.apache.solr.handler.admin.CoreAdminHandler.handleCreateAction(CoreAdminHandler.java:613)\n        at org.apache.solr.handler.admin.CoreAdminHandler.handleRequestInternal(CoreAdminHandler.java:199)\n        at org.apache.solr.handler.admin.CoreAdminHandler.handleRequestBody(CoreAdminHandler.java:188)\n        at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:136)\n        at org.apache.solr.servlet.SolrDispatchFilter.handleAdminRequest(SolrDispatchFilter.java:736)\n        at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:253)\n        at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:202)\n        at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1419)\n        at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:455)\n        at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:137)\n        at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:557)\n        at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:231)\n        at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1075)\n        at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:384)\n        at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:193)\n        at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1009)\n        at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:135)\n        at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:255)\n        at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:154)\n        at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:116)\n        at org.eclipse.jetty.server.Server.handle(Server.java:368)\n        at org.eclipse.jetty.server.AbstractHttpConnection.handleRequest(AbstractHttpConnection.java:489)\n        at org.eclipse.jetty.server.BlockingHttpConnection.handleRequest(BlockingHttpConnection.java:53)\n        at org.eclipse.jetty.server.AbstractHttpConnection.content(AbstractHttpConnection.java:953)\n        at org.eclipse.jetty.server.AbstractHttpConnection$RequestHandler.content(AbstractHttpConnection.java:1014)\n        at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:861)\n        at org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:240)\n        at org.eclipse.jetty.server.BlockingHttpConnection.handle(BlockingHttpConnection.java:72)\n        at org.eclipse.jetty.server.bio.SocketConnector$ConnectorEndPoint.run(SocketConnector.java:264)\n        at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:608)\n        at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:543)\n        at java.lang.Thread.run(Thread.java:745)\nCaused by: org.apache.solr.common.SolrException: Unable to create core [foo2_shard1_replica1]\n        at org.apache.solr.core.CoreContainer.create(CoreContainer.java:526)\n        at org.apache.solr.core.CoreContainer.create(CoreContainer.java:485)\n        at org.apache.solr.handler.admin.CoreAdminHandler.handleCreateAction(CoreAdminHandler.java:575)\n        ... 31 more\nCaused by: org.apache.solr.common.cloud.ZooKeeperException: Could not find configName for collection foo2 found:[data_driven_schema_configs, sample_techproducts_configs]",
    "attachments": {},
    "issue_links": {},
    "comments": [
        {
            "date": "2014-11-19T17:03:32+0000",
            "author": "ASF subversion and git services",
            "content": "Commit 1640598 from Timothy Potter in branch 'dev/trunk'\n[ https://svn.apache.org/r1640598 ]\n\nSOLR-6762: use collection.configName parameter instead of configSet when creating a collection ",
            "id": "comment-14218144"
        },
        {
            "date": "2014-11-19T17:10:08+0000",
            "author": "ASF subversion and git services",
            "content": "Commit 1640600 from Timothy Potter in branch 'dev/branches/branch_5x'\n[ https://svn.apache.org/r1640600 ]\n\nSOLR-6762: use collection.configName parameter instead of configSet when creating a collection ",
            "id": "comment-14218158"
        },
        {
            "date": "2015-02-23T05:02:31+0000",
            "author": "Anshum Gupta",
            "content": "Bulk close after 5.0 release. ",
            "id": "comment-14332900"
        }
    ]
}