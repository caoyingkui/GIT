{
    "id": "SOLR-12013",
    "title": "collections API CUSTERSTATUS command fails when collections have errors",
    "details": {
        "labels": "",
        "priority": "Major",
        "components": [
            "SolrCloud"
        ],
        "type": "Bug",
        "fix_versions": [],
        "affect_versions": "6.0,                                            7.0,                                            7.1,                                            7.2",
        "resolution": "Unresolved",
        "status": "Open"
    },
    "description": "CLUSTERSTATUS command can be given independent of a given collection.\n\nhttp://localhost:8983/solr/admin/collections?action=CLUSTERSTATUS\n\nI would expect that you can still inspect the status of a cluster even if a single collection has failed, or is missing its configuration.\n\nExpected behavior: all healthy collections status is returned, unhealthy collections are either reported with a stacktrace in the response, reported in a failure state, or are not present from the response.\n\nFor example, CLUSTERSTATUS fails when a collection config-set is missing from ZooKeeper with:\n\norg.apache.solr.common.cloud.ZooKeeperException: Specified config does not exist in ZooKeeper: config-set-name\n{{ at org.apache.solr.common.cloud.ZkStateReader.readConfigName(ZkStateReader.java:189)}}\n{{ at org.apache.solr.handler.admin.ClusterStatus.getClusterStatus(ClusterStatus.java:141)}}\n{{ at org.apache.solr.handler.admin.CollectionsHandler$CollectionOperation.lambda$static$19(CollectionsHandler.java:649)}}\n{{ at org.apache.solr.handler.admin.CollectionsHandler$CollectionOperation.execute(CollectionsHandler.java:888)}}\n{{ at org.apache.solr.handler.admin.CollectionsHandler.invokeAction(CollectionsHandler.java:226)}}\n{{ at org.apache.solr.handler.admin.CollectionsHandler.handleRequestBody(CollectionsHandler.java:213)}}\n{{ at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:173)}}\n{{ at org.apache.solr.servlet.HttpSolrCall.handleAdmin(HttpSolrCall.java:748)}}\n{{ at org.apache.solr.servlet.HttpSolrCall.handleAdminRequest(HttpSolrCall.java:729)}}\n{{ at org.apache.solr.servlet.HttpSolrCall.call(HttpSolrCall.java:510)}}\n{{ at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:347)}}\n{{ at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:298)}}\n{{ at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1691)}}\n{{ at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:582)}}\n{{ at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)}}\n{{ at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:548)}}\n{{ at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:226)}}\n{{ at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1180)}}\n{{ at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:512)}}\n{{ at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)}}\n{{ at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1112)}}\n{{ at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)}}\n{{ at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:213)}}\n{{ at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:119)}}\n{{ at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:134)}}\n{{ at org.eclipse.jetty.rewrite.handler.RewriteHandler.handle(RewriteHandler.java:335)}}\n{{ at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:134)}}\n{{ at org.eclipse.jetty.server.Server.handle(Server.java:534)}}\n{{ at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:320)}}\n{{ at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:251)}}\n{{ at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:273)}}\n{{ at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:95)}}\n{{ at org.eclipse.jetty.io.SelectChannelEndPoint$2.run(SelectChannelEndPoint.java:93)}}\n{{ at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.executeProduceConsume(ExecuteProduceConsume.java:303)}}\n{{ at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.produceConsume(ExecuteProduceConsume.java:148)}}\n{{ at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.run(ExecuteProduceConsume.java:136)}}\n{{ at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:671)}}\n{{ at org.eclipse.jetty.util.thread.QueuedThreadPool$2.run(QueuedThreadPool.java:589)}}\n{{ at java.lang.Thread.run(Thread.java:745)}}",
    "attachments": {},
    "issue_links": {},
    "comments": []
}